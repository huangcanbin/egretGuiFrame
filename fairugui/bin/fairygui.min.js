var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){var e=function(e){__extends(i,e);function i(){var n=e.call(this)||this;return n._x=0,n._y=0,n._alpha=1,n._rotation=0,n._visible=!0,n._touchable=!0,n._grayed=!1,n._draggable=!1,n._scaleX=1,n._scaleY=1,n._skewX=0,n._skewY=0,n._pivotX=0,n._pivotY=0,n._pivotAsAnchor=!1,n._pivotOffsetX=0,n._pivotOffsetY=0,n._sortingOrder=0,n._internalVisible=!0,n._handlingController=!1,n._focusable=!1,n._pixelSnapping=!1,n.sourceWidth=0,n.sourceHeight=0,n.initWidth=0,n.initHeight=0,n.minWidth=0,n.minHeight=0,n.maxWidth=0,n.maxHeight=0,n._width=0,n._height=0,n._rawWidth=0,n._rawHeight=0,n._yOffset=0,n._sizePercentInGroup=0,n._sizeImplType=0,n._id=""+i._gInstanceCounter++,n._name="",n.createDisplayObject(),n._relations=new t.Relations(n),n._gears=[],n}return Object.defineProperty(i.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){this.setXY(t,this._y)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){this.setXY(this._x,t)},enumerable:!0,configurable:!0}),i.prototype.setXY=function(e,n){if(this._x!=e||this._y!=n){var s=e-this._x,r=n-this._y;this._x=e,this._y=n,this.handleXYChanged(),this instanceof t.GGroup&&this.moveChildren(s,r),this.updateGear(1),!this._parent||this._parent instanceof t.GList||(this._parent.setBoundsChangedFlag(),null!=this._group&&this._group.setBoundsChangedFlag(),this.dispatchEventWith(i.XY_CHANGED)),i.draggingObject!=this||i.sUpdateInDragging||this.localToGlobalRect(0,0,this.width,this.height,i.sGlobalRect)}},Object.defineProperty(i.prototype,"pixelSnapping",{get:function(){return this._pixelSnapping},set:function(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handleXYChanged())},enumerable:!0,configurable:!0}),i.prototype.center=function(e){void 0===e&&(e=!1);var i;i=null!=this._parent?this.parent:this.root,this.setXY((i.width-this.width)/2,(i.height-this.height)/2),e&&(this.addRelation(i,t.RelationType.Center_Center),this.addRelation(i,t.RelationType.Middle_Middle))},Object.defineProperty(i.prototype,"width",{get:function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},set:function(t){this.setSize(t,this._rawHeight)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},set:function(t){this.setSize(this._rawWidth,t)},enumerable:!0,configurable:!0}),i.prototype.setSize=function(e,n,s){if(void 0===s&&(s=!1),this._rawWidth!=e||this._rawHeight!=n){this._rawWidth=e,this._rawHeight=n,e<this.minWidth&&(e=this.minWidth),n<this.minHeight&&(n=this.minHeight),this.maxWidth>0&&e>this.maxWidth&&(e=this.maxWidth),this.maxHeight>0&&n>this.maxHeight&&(n=this.maxHeight);var r=e-this._width,o=n-this._height;this._width=e,this._height=n,this.handleSizeChanged(),0==this._pivotX&&0==this._pivotY||(this._pivotAsAnchor?this.applyPivot():(s||this.setXY(this.x-this._pivotX*r,this.y-this._pivotY*o),this.updatePivotOffset())),this instanceof t.GGroup&&this.resizeChildren(r,o),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(r,o),this._parent.setBoundsChangedFlag(),null!=this._group&&this._group.setBoundsChangedFlag(!0)),this.dispatchEventWith(i.SIZE_CHANGED)}},i.prototype.ensureSizeCorrect=function(){},Object.defineProperty(i.prototype,"actualWidth",{get:function(){return this.width*Math.abs(this._scaleX)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualHeight",{get:function(){return this.height*Math.abs(this._scaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this.setScale(t,this._scaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this.setScale(this._scaleX,t)},enumerable:!0,configurable:!0}),i.prototype.setScale=function(t,e){this._scaleX==t&&this._scaleY==e||(this._scaleX=t,this._scaleY=e,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))},Object.defineProperty(i.prototype,"skewX",{get:function(){return this._skewX},set:function(t){this.setSkew(t,this._skewY)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skewY",{get:function(){return this._skewY},set:function(t){this.setSkew(this._skewX,t)},enumerable:!0,configurable:!0}),i.prototype.setSkew=function(t,e){this._skewX==t&&this._skewY==e||(this._skewX=t,this._skewY=e,null!=this._displayObject&&(this._displayObject.skewX=t,this._displayObject.skewY=e),this.applyPivot())},Object.defineProperty(i.prototype,"pivotX",{get:function(){return this._pivotX},set:function(t){this.setPivot(t,this._pivotY)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivotY",{get:function(){return this._pivotY},set:function(t){this.setPivot(this._pivotX,t)},enumerable:!0,configurable:!0}),i.prototype.setPivot=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),this._pivotX==t&&this._pivotY==e&&this._pivotAsAnchor==i||(this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this.updatePivotOffset(),this.handleXYChanged())},i.prototype.internalSetPivot=function(t,e,i){void 0===e&&(e=0),this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,i&&this.handleXYChanged()},i.prototype.updatePivotOffset=function(){if(null!=this._displayObject)if(0!=this._pivotX||0!=this._pivotY){var t,e;0==this._sizeImplType?(t=this._pivotX*this._width,e=this._pivotY*this._height):(t=this._pivotX*this.sourceWidth,e=this._pivotY*this.sourceHeight);var n=this._displayObject.matrix.transformPoint(t,e,i.sHelperPoint);this._pivotOffsetX=this._pivotX*this._width-(n.x-this._displayObject.x),this._pivotOffsetY=this._pivotY*this._height-(n.y-this._displayObject.y)}else this._pivotOffsetX=0,this._pivotOffsetY=0},i.prototype.applyPivot=function(){0==this._pivotX&&0==this._pivotY||(this.updatePivotOffset(),this.handleXYChanged())},Object.defineProperty(i.prototype,"touchable",{get:function(){return this._touchable},set:function(e){if(this._touchable!=e){if(this._touchable=e,this.updateGear(3),this instanceof t.GImage||this instanceof t.GMovieClip||this instanceof t.GTextField&&!(this instanceof t.GTextInput)&&!(this instanceof t.GRichTextField))return;null!=this._displayObject&&(this._displayObject.touchEnabled=this._touchable,this._displayObject instanceof egret.DisplayObjectContainer&&(this._displayObject.touchChildren=this._touchable))}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"grayed",{get:function(){return this._grayed},set:function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return!this._grayed&&this._touchable},set:function(t){this.grayed=!t,this.touchable=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!=t&&(this._rotation=t,this._displayObject&&(this._displayObject.rotation=this.normalizeRotation),this.applyPivot(),this.updateGear(3))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"normalizeRotation",{get:function(){var t=this._rotation%360;return t>180?t-=360:t<-180&&(t+=360),t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!=t&&(this._alpha=t,this.handleAlphaChanged(),this.updateGear(3))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this.handleVisibleChanged(),this._parent&&this._parent.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"internalVisible",{get:function(){return this._internalVisible&&(!this._group||this._group.internalVisible)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"internalVisible2",{get:function(){return this._visible&&(!this._group||this._group.internalVisible2)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortingOrder",{get:function(){return this._sortingOrder},set:function(t){if(t<0&&(t=0),this._sortingOrder!=t){var e=this._sortingOrder;this._sortingOrder=t,null!=this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"focusable",{get:function(){return this._focusable},set:function(t){this._focusable=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"focused",{get:function(){return this.root.focus==this},enumerable:!0,configurable:!0}),i.prototype.requestFocus=function(){for(var t=this;t&&!t._focusable;)t=t.parent;null!=t&&(this.root.focus=t)},Object.defineProperty(i.prototype,"tooltips",{get:function(){return this._tooltips},set:function(t){this._tooltips=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"blendMode",{get:function(){return this._displayObject.blendMode},set:function(t){this._displayObject.blendMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"filters",{get:function(){return this._displayObject.filters},set:function(t){this._displayObject.filters=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"inContainer",{get:function(){return null!=this._displayObject&&null!=this._displayObject.parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onStage",{get:function(){return null!=this._displayObject&&null!=this._displayObject.stage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"resourceURL",{get:function(){return null!=this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"group",{get:function(){return this._group},set:function(t){this._group!=t&&(null!=this._group&&this._group.setBoundsChangedFlag(!0),this._group=t,null!=this._group&&this._group.setBoundsChangedFlag(!0))},enumerable:!0,configurable:!0}),i.prototype.getGear=function(e){var i=this._gears[e];if(null==i){switch(e){case 0:i=new t.GearDisplay(this);break;case 1:i=new t.GearXY(this);break;case 2:i=new t.GearSize(this);break;case 3:i=new t.GearLook(this);break;case 4:i=new t.GearColor(this);break;case 5:i=new t.GearAnimation(this);break;case 6:i=new t.GearText(this);break;case 7:i=new t.GearIcon(this);break;default:throw"FairyGUI: invalid gear index!"}this._gears[e]=i}return i},i.prototype.updateGear=function(t){if(!this._underConstruct&&!this._gearLocked){var e=this._gears[t];null!=e&&null!=e.controller&&e.updateState()}},i.prototype.checkGearController=function(t,e){return null!=this._gears[t]&&this._gears[t].controller==e},i.prototype.updateGearFromRelations=function(t,e,i){null!=this._gears[t]&&this._gears[t].updateFromRelations(e,i)},i.prototype.addDisplayLock=function(){var t=this._gears[0];if(t&&t.controller){var e=t.addLock();return this.checkGearDisplay(),e}return 0},i.prototype.releaseDisplayLock=function(t){var e=this._gears[0];e&&e.controller&&(e.releaseLock(t),this.checkGearDisplay())},i.prototype.checkGearDisplay=function(){if(!this._handlingController){var t=null==this._gears[0]||this._gears[0].connected;t!=this._internalVisible&&(this._internalVisible=t,this._parent&&this._parent.childStateChanged(this))}},Object.defineProperty(i.prototype,"gearXY",{get:function(){return this.getGear(1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gearSize",{get:function(){return this.getGear(2)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gearLook",{get:function(){return this.getGear(3)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relations",{get:function(){return this._relations},enumerable:!0,configurable:!0}),i.prototype.addRelation=function(t,e,i){void 0===i&&(i=!1),this._relations.add(t,e,i)},i.prototype.removeRelation=function(t,e){void 0===e&&(e=0),this._relations.remove(t,e)},Object.defineProperty(i.prototype,"displayObject",{get:function(){return this._displayObject},enumerable:!0,configurable:!0}),i.prototype.setDisplayObject=function(t){this._displayObject=t},Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent=t},enumerable:!0,configurable:!0}),i.prototype.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},Object.defineProperty(i.prototype,"root",{get:function(){if(this instanceof t.GRoot)return this;for(var e=this._parent;e;){if(e instanceof t.GRoot)return e;e=e.parent}return t.GRoot.inst},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asCom",{get:function(){return this instanceof t.GComponent?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asButton",{get:function(){return this instanceof t.GButton?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asLabel",{get:function(){return this instanceof t.GLabel?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asProgress",{get:function(){return this instanceof t.GProgressBar?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asTextField",{get:function(){return this instanceof t.GTextField?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asRichTextField",{get:function(){return this instanceof t.GRichTextField?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asTextInput",{get:function(){return this instanceof t.GTextInput?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asLoader",{get:function(){return this instanceof t.GLoader?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asList",{get:function(){return this instanceof t.GList?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asGraph",{get:function(){return this instanceof t.GGraph?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asGroup",{get:function(){return this instanceof t.GGroup?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asSlider",{get:function(){return this instanceof t.GSlider?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asComboBox",{get:function(){return this instanceof t.GComboBox?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asImage",{get:function(){return this instanceof t.GImage?this:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"asMovieClip",{get:function(){return this instanceof t.GMovieClip?this:null},enumerable:!0,configurable:!0}),i.cast=function(t){return t.$owner},Object.defineProperty(i.prototype,"text",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.removeFromParent(),this._relations.dispose()},i.prototype.addClickListener=function(t,e){this.addEventListener(egret.TouchEvent.TOUCH_TAP,t,e)},i.prototype.removeClickListener=function(t,e){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,t,e)},i.prototype.hasClickListener=function(){return this.hasEventListener(egret.TouchEvent.TOUCH_TAP)},i.prototype.addEventListener=function(t,i,n){e.prototype.addEventListener.call(this,t,i,n),null!=this._displayObject&&this._displayObject.addEventListener(t,this._reDispatch,this)},i.prototype.removeEventListener=function(t,i,n){e.prototype.removeEventListener.call(this,t,i,n),null==this._displayObject||this.hasEventListener(t)||this._displayObject.removeEventListener(t,this._reDispatch,this)},i.prototype._reDispatch=function(t){this.dispatchEvent(t)},Object.defineProperty(i.prototype,"draggable",{get:function(){return this._draggable},set:function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dragBounds",{get:function(){return this._dragBounds},set:function(t){this._dragBounds=t},enumerable:!0,configurable:!0}),i.prototype.startDrag=function(t){void 0===t&&(t=-1),null!=this._displayObject.stage&&this.dragBegin(null)},i.prototype.stopDrag=function(){this.dragEnd()},Object.defineProperty(i.prototype,"dragging",{get:function(){return i.draggingObject==this},enumerable:!0,configurable:!0}),i.prototype.localToGlobal=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),this._pivotAsAnchor&&(t+=this._pivotX*this._width,e+=this._pivotY*this._height),this._displayObject.localToGlobal(t,e,i)},i.prototype.globalToLocal=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0);var n=this._displayObject.globalToLocal(t,e,i);return this._pivotAsAnchor&&(n.x-=this._pivotX*this._width,n.y-=this._pivotY*this._height),n},i.prototype.localToRoot=function(e,i,n){void 0===e&&(e=0),void 0===i&&(i=0);var s=this._displayObject.localToGlobal(e,i,n);return s.x/=t.GRoot.contentScaleFactor,s.y/=t.GRoot.contentScaleFactor,s},i.prototype.rootToLocal=function(e,i,n){return void 0===e&&(e=0),void 0===i&&(i=0),e*=t.GRoot.contentScaleFactor,i*=t.GRoot.contentScaleFactor,this._displayObject.globalToLocal(e,i,n)},i.prototype.localToGlobalRect=function(t,e,i,n,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),null==s&&(s=new egret.Rectangle);var r=this.localToGlobal(t,e);return s.x=r.x,s.y=r.y,r=this.localToGlobal(t+i,e+n),s.right=r.x,s.bottom=r.y,s},i.prototype.globalToLocalRect=function(t,e,i,n,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),null==s&&(s=new egret.Rectangle);var r=this.globalToLocal(t,e);return s.x=r.x,s.y=r.y,r=this.globalToLocal(t+i,e+n),s.right=r.x,s.bottom=r.y,s},i.prototype.handleControllerChanged=function(t){this._handlingController=!0;for(var e=0;e<8;e++){var i=this._gears[e];null!=i&&i.controller==t&&i.apply()}this._handlingController=!1,this.checkGearDisplay()},i.prototype.createDisplayObject=function(){},i.prototype.switchDisplayObject=function(t){if(t!=this._displayObject){var e=this._displayObject;if(null!=this._displayObject.parent){var i=this._displayObject.parent.getChildIndex(this._displayObject);this._displayObject.parent.addChildAt(t,i),this._displayObject.parent.removeChild(this._displayObject)}this._displayObject=t,this._displayObject.x=e.x,this._displayObject.y=e.y,this._displayObject.rotation=e.rotation,this._displayObject.alpha=e.alpha,this._displayObject.visible=e.visible,this._displayObject.touchEnabled=e.touchEnabled,this._displayObject.scaleX=e.scaleX,this._displayObject.scaleY=e.scaleY,this._displayObject instanceof egret.DisplayObjectContainer&&(this._displayObject.touchChildren=this._touchable)}},i.prototype.handleXYChanged=function(){if(this._displayObject){var t=this._x,e=this._y+this._yOffset;this._pivotAsAnchor&&(t-=this._pivotX*this._width,e-=this._pivotY*this._height),this._pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this._displayObject.x=t+this._pivotOffsetX,this._displayObject.y=e+this._pivotOffsetY}},i.prototype.handleSizeChanged=function(){null!=this._displayObject&&1==this._sizeImplType&&0!=this.sourceWidth&&0!=this.sourceHeight&&(this._displayObject.scaleX=this._width/this.sourceWidth*this._scaleX,this._displayObject.scaleY=this._height/this.sourceHeight*this._scaleY)},i.prototype.handleScaleChanged=function(){null!=this._displayObject&&(0==this._sizeImplType||0==this.sourceWidth||0==this.sourceHeight?(this._displayObject.scaleX=this._scaleX,this._displayObject.scaleY=this._scaleY):(this._displayObject.scaleX=this._width/this.sourceWidth*this._scaleX,this._displayObject.scaleY=this._height/this.sourceHeight*this._scaleY))},i.prototype.handleGrayedChanged=function(){if(this._displayObject)if(this._grayed){var t=new egret.ColorMatrixFilter(i.colorMatrix);this._displayObject.filters=[t]}else this._displayObject.filters=null},i.prototype.handleAlphaChanged=function(){this._displayObject&&(this._displayObject.alpha=this._alpha)},i.prototype.handleVisibleChanged=function(){this._displayObject&&(this._displayObject.visible=this.internalVisible2)},i.prototype.constructFromResource=function(){},i.prototype.setup_beforeAdd=function(e){var i,n;if(this._id=e.attributes.id,this._name=e.attributes.name,n=(i=e.attributes.xy).split(","),this.setXY(parseInt(n[0]),parseInt(n[1])),(i=e.attributes.size)&&(n=i.split(","),this.initWidth=parseInt(n[0]),this.initHeight=parseInt(n[1]),this.setSize(this.initWidth,this.initHeight,!0)),(i=e.attributes.restrictSize)&&(n=i.split(","),this.minWidth=parseInt(n[0]),this.maxWidth=parseInt(n[1]),this.minHeight=parseInt(n[2]),this.maxHeight=parseInt(n[3])),(i=e.attributes.scale)&&(n=i.split(","),this.setScale(parseFloat(n[0]),parseFloat(n[1]))),(i=e.attributes.rotation)&&(this.rotation=parseInt(i)),(i=e.attributes.skew)&&(n=i.split(","),this.setSkew(parseFloat(n[0]),parseFloat(n[1]))),(i=e.attributes.pivot)&&(n=i.split(","),i=e.attributes.anchor,this.setPivot(parseFloat(n[0]),parseFloat(n[1]),"true"==i)),(i=e.attributes.alpha)&&(this.alpha=parseFloat(i)),"false"==e.attributes.touchable&&(this.touchable=!1),"false"==e.attributes.visible&&(this.visible=!1),"true"==e.attributes.grayed&&(this.grayed=!0),this.tooltips=e.attributes.tooltips,(i=e.attributes.blend)&&(this.blendMode=i),i=e.attributes.filter)switch(i){case"color":n=(i=e.attributes.filterData).split(",");var s=new t.ColorMatrix;s.adjustBrightness(parseFloat(n[0])),s.adjustContrast(parseFloat(n[1])),s.adjustSaturation(parseFloat(n[2])),s.adjustHue(parseFloat(n[3]));var r=new egret.ColorMatrixFilter(s.matrix);this.filters=[r]}},i.prototype.setup_afterAdd=function(t){var e=t.attributes.group;e&&(this._group=this._parent.getChildById(e));var n=t.children;if(n)for(var s=n.length,r=0;r<s;r++){var o=n[r],a=i.GearXMLKeys[o.name];void 0!=a&&this.getGear(a).setup(o)}},i.prototype.initDrag=function(){this._draggable?this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__begin,this):this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__begin,this)},i.prototype.dragBegin=function(e){null!=i.draggingObject&&i.draggingObject.stopDrag(),null!=e?(i.sGlobalDragStart.x=e.stageX,i.sGlobalDragStart.y=e.stageY):(i.sGlobalDragStart.x=t.GRoot.mouseX,i.sGlobalDragStart.y=t.GRoot.mouseY),this.localToGlobalRect(0,0,this.width,this.height,i.sGlobalRect),i.draggingObject=this,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving2,this),t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__end2,this)},i.prototype.dragEnd=function(){i.draggingObject==this&&(t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving2,this),t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__end2,this),i.draggingObject=null)},i.prototype.reset=function(){t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},i.prototype.__begin=function(e){null==this._touchDownPoint&&(this._touchDownPoint=new egret.Point),this._touchDownPoint.x=e.stageX,this._touchDownPoint.y=e.stageY,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},i.prototype.__end=function(t){this.reset()},i.prototype.__moving=function(e){var i=t.UIConfig.touchDragSensitivity;if(!(null!=this._touchDownPoint&&Math.abs(this._touchDownPoint.x-e.stageX)<i&&Math.abs(this._touchDownPoint.y-e.stageY)<i)){this.reset();var n=new t.DragEvent(t.DragEvent.DRAG_START);n.stageX=e.stageX,n.stageY=e.stageY,n.touchPointID=e.touchPointID,this.dispatchEvent(n),n.isDefaultPrevented()||this.dragBegin(e)}},i.prototype.__moving2=function(e){var n=e.stageX-i.sGlobalDragStart.x+i.sGlobalRect.x,s=e.stageY-i.sGlobalDragStart.y+i.sGlobalRect.y;if(null!=this._dragBounds){var r=t.GRoot.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,i.sDragHelperRect);n<r.x?n=r.x:n+i.sGlobalRect.width>r.right&&(n=r.right-i.sGlobalRect.width)<r.x&&(n=r.x),s<r.y?s=r.y:s+i.sGlobalRect.height>r.bottom&&(s=r.bottom-i.sGlobalRect.height)<r.y&&(s=r.y)}i.sUpdateInDragging=!0;var o=this.parent.globalToLocal(n,s,i.sHelperPoint);this.setXY(Math.round(o.x),Math.round(o.y)),i.sUpdateInDragging=!1;var a=new t.DragEvent(t.DragEvent.DRAG_MOVING);a.stageX=e.stageX,a.stageY=e.stageY,a.touchPointID=e.touchPointID,this.dispatchEvent(a)},i.prototype.__end2=function(e){if(i.draggingObject==this){this.stopDrag();var n=new t.DragEvent(t.DragEvent.DRAG_END);n.stageX=e.stageX,n.stageY=e.stageY,n.touchPointID=e.touchPointID,this.dispatchEvent(n)}},i._gInstanceCounter=0,i.XY_CHANGED="__xyChanged",i.SIZE_CHANGED="__sizeChanged",i.SIZE_DELAY_CHANGE="__sizeDelayChange",i.GEAR_STOP="gearStop",i.colorMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i.GearXMLKeys={gearDisplay:0,gearXY:1,gearSize:2,gearLook:3,gearColor:4,gearAni:5,gearText:6,gearIcon:7},i.sGlobalDragStart=new egret.Point,i.sGlobalRect=new egret.Rectangle,i.sHelperPoint=new egret.Point,i.sDragHelperRect=new egret.Rectangle,i}(egret.EventDispatcher);t.GObject=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){this._readPos=0,this.smallFontSize=12,this.normalFontSize=14,this.largeFontSize=16,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}return t.prototype.onTag_URL=function(t,e,i){if(e)return"</a>";if(null!=i)return'<a href="'+i+'" target="_blank">';return'<a href="'+this.getTagText()+'" target="_blank">'},t.prototype.onTag_IMG=function(t,e,i){if(e)return null;var n=this.getTagText(!0);return n?this.defaultImgWidth?'<img src="'+n+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+n+'"/>':null},t.prototype.onTag_Simple=function(t,e,i){return e?"</"+t+">":"<"+t+">"},t.prototype.onTag_COLOR=function(t,e,i){return e?"</font>":'<font color="'+i+'">'},t.prototype.onTag_FONT=function(t,e,i){return e?"</font>":'<font face="'+i+'">'},t.prototype.onTag_SIZE=function(t,e,i){return e?"</font>":("normal"==i?i=""+this.normalFontSize:"small"==i?i=""+this.smallFontSize:"large"==i?i=""+this.largeFontSize:i.length&&"+"==i.charAt(0)?i=""+(this.smallFontSize+parseInt(i.substr(1))):i.length&&"-"==i.charAt(0)&&(i=""+(this.smallFontSize-parseInt(i.substr(1)))),'<font size="'+i+'">')},t.prototype.getTagText=function(t){void 0===t&&(t=!1);var e=this._text.indexOf("[",this._readPos);if(-1==e)return null;var i=this._text.substring(this._readPos,e);return t&&(this._readPos=e),i},t.prototype.parse=function(t){this._text=t;for(var e,i,n,s,r,o,a=0,h=0;-1!=(e=this._text.indexOf("[",a))&&(a=e,-1!=(e=this._text.indexOf("]",a)));)i="/"==this._text.charAt(a+1),n=this._text.substring(i?a+2:a+1,e),e++,this._readPos=e,s=null,r=null,-1!=(h=n.indexOf("="))&&(s=n.substring(h+1),n=n.substring(0,h)),n=n.toLowerCase(),null!=(o=this._handlers[n])?(null==(r=o.call(this,n,i,s))&&(r=""),this._text=this._text.substring(0,a)+r+this._text.substring(this._readPos)):a=e;return this._text},t.inst=new t,t}();t.UBBParser=e}(fairygui||(fairygui={}));!function(t){var e;(i=e=t.ButtonMode||(t.ButtonMode={}))[i.Common=0]="Common",i[i.Check=1]="Check",i[i.Radio=2]="Radio";var i,n;(s=n=t.AutoSizeType||(t.AutoSizeType={}))[s.None=0]="None",s[s.Both=1]="Both",s[s.Height=2]="Height";var s,r;(o=r=t.AlignType||(t.AlignType={}))[o.Left=0]="Left",o[o.Center=1]="Center",o[o.Right=2]="Right";var o,a;(h=a=t.VertAlignType||(t.VertAlignType={}))[h.Top=0]="Top",h[h.Middle=1]="Middle",h[h.Bottom=2]="Bottom";var h,l;(c=l=t.LoaderFillType||(t.LoaderFillType={}))[c.None=0]="None",c[c.Scale=1]="Scale",c[c.ScaleMatchHeight=2]="ScaleMatchHeight",c[c.ScaleMatchWidth=3]="ScaleMatchWidth",c[c.ScaleFree=4]="ScaleFree";var c,u;(_=u=t.ListLayoutType||(t.ListLayoutType={}))[_.SingleColumn=0]="SingleColumn",_[_.SingleRow=1]="SingleRow",_[_.FlowHorizontal=2]="FlowHorizontal",_[_.FlowVertical=3]="FlowVertical",_[_.Pagination=4]="Pagination";var _,p;(d=p=t.ListSelectionMode||(t.ListSelectionMode={}))[d.Single=0]="Single",d[d.Multiple=1]="Multiple",d[d.Multiple_SingleClick=2]="Multiple_SingleClick",d[d.None=3]="None";var d,g;(f=g=t.OverflowType||(t.OverflowType={}))[f.Visible=0]="Visible",f[f.Hidden=1]="Hidden",f[f.Scroll=2]="Scroll",f[f.Scale=3]="Scale",f[f.ScaleFree=4]="ScaleFree";var f,y;(b=y=t.PackageItemType||(t.PackageItemType={}))[b.Image=0]="Image",b[b.Swf=1]="Swf",b[b.MovieClip=2]="MovieClip",b[b.Sound=3]="Sound",b[b.Component=4]="Component",b[b.Misc=5]="Misc",b[b.Font=6]="Font",b[b.Atlas=7]="Atlas";var b,m;(v=m=t.ProgressTitleType||(t.ProgressTitleType={}))[v.Percent=0]="Percent",v[v.ValueAndMax=1]="ValueAndMax",v[v.Value=2]="Value",v[v.Max=3]="Max";var v,w;(C=w=t.ScrollBarDisplayType||(t.ScrollBarDisplayType={}))[C.Default=0]="Default",C[C.Visible=1]="Visible",C[C.Auto=2]="Auto",C[C.Hidden=3]="Hidden";var C,x;(O=x=t.ScrollType||(t.ScrollType={}))[O.Horizontal=0]="Horizontal",O[O.Vertical=1]="Vertical",O[O.Both=2]="Both";var O,I;(T=I=t.FlipType||(t.FlipType={}))[T.None=0]="None",T[T.Horizontal=1]="Horizontal",T[T.Vertical=2]="Vertical",T[T.Both=3]="Both";var T;(S=t.ChildrenRenderOrder||(t.ChildrenRenderOrder={}))[S.Ascent=0]="Ascent",S[S.Descent=1]="Descent",S[S.Arch=2]="Arch";var S,P;(j=P=t.GroupLayoutType||(t.GroupLayoutType={}))[j.None=0]="None",j[j.Horizontal=1]="Horizontal",j[j.Vertical=2]="Vertical";var j;(L=t.RelationType||(t.RelationType={}))[L.Left_Left=0]="Left_Left",L[L.Left_Center=1]="Left_Center",L[L.Left_Right=2]="Left_Right",L[L.Center_Center=3]="Center_Center",L[L.Right_Left=4]="Right_Left",L[L.Right_Center=5]="Right_Center",L[L.Right_Right=6]="Right_Right",L[L.Top_Top=7]="Top_Top",L[L.Top_Middle=8]="Top_Middle",L[L.Top_Bottom=9]="Top_Bottom",L[L.Middle_Middle=10]="Middle_Middle",L[L.Bottom_Top=11]="Bottom_Top",L[L.Bottom_Middle=12]="Bottom_Middle",L[L.Bottom_Bottom=13]="Bottom_Bottom",L[L.Width=14]="Width",L[L.Height=15]="Height",L[L.LeftExt_Left=16]="LeftExt_Left",L[L.LeftExt_Right=17]="LeftExt_Right",L[L.RightExt_Left=18]="RightExt_Left",L[L.RightExt_Right=19]="RightExt_Right",L[L.TopExt_Top=20]="TopExt_Top",L[L.TopExt_Bottom=21]="TopExt_Bottom",L[L.BottomExt_Top=22]="BottomExt_Top",L[L.BottomExt_Bottom=23]="BottomExt_Bottom",L[L.Size=24]="Size";var L;t.parseButtonMode=function(t){switch(t){case"Common":return e.Common;case"Check":return e.Check;case"Radio":return e.Radio;default:return e.Common}};t.parseAutoSizeType=function(t){switch(t){case"none":return n.None;case"both":return n.Both;case"height":return n.Height;default:return n.None}};t.parseAlignType=function(t){switch(t){case"left":return r.Left;case"center":return r.Center;case"right":return r.Right;default:return r.Left}};t.getAlignTypeString=function(t){return t==r.Left?egret.HorizontalAlign.LEFT:t==r.Center?egret.HorizontalAlign.CENTER:egret.HorizontalAlign.RIGHT};t.getVertAlignTypeString=function(t){return t==a.Top?egret.VerticalAlign.TOP:t==a.Middle?egret.VerticalAlign.MIDDLE:egret.VerticalAlign.BOTTOM};t.parseVertAlignType=function(t){switch(t){case"top":return a.Top;case"middle":return a.Middle;case"bottom":return a.Bottom;default:return a.Top}};t.parseLoaderFillType=function(t){switch(t){case"none":return l.None;case"scale":return l.Scale;case"scaleMatchHeight":return l.ScaleMatchHeight;case"scaleMatchWidth":return l.ScaleMatchWidth;case"scaleFree":return l.ScaleFree;default:return l.None}};t.parseListLayoutType=function(t){switch(t){case"column":return u.SingleColumn;case"row":return u.SingleRow;case"flow_hz":return u.FlowHorizontal;case"flow_vt":return u.FlowVertical;case"pagination":return u.Pagination;default:return u.SingleColumn}};t.parseListSelectionMode=function(t){switch(t){case"single":return p.Single;case"multiple":return p.Multiple;case"multipleSingleClick":return p.Multiple_SingleClick;case"none":return p.None;default:return p.Single}};t.parseOverflowType=function(t){switch(t){case"visible":return g.Visible;case"hidden":return g.Hidden;case"scroll":return g.Scroll;case"scale":return g.Scale;case"scaleFree":return g.ScaleFree;default:return g.Visible}};t.parsePackageItemType=function(t){switch(t){case"image":return y.Image;case"movieclip":return y.MovieClip;case"sound":return y.Sound;case"component":return y.Component;case"swf":return y.Swf;case"font":return y.Font;case"atlas":return y.Atlas;default:return y.Misc}};t.parseProgressTitleType=function(t){switch(t){case"percent":return m.Percent;case"valueAndmax":return m.ValueAndMax;case"value":return m.Value;case"max":return m.Max;default:return m.Percent}};t.parseScrollBarDisplayType=function(t){switch(t){case"default":return w.Default;case"visible":return w.Visible;case"auto":return w.Auto;case"hidden":return w.Hidden;default:return w.Default}};t.parseScrollType=function(t){switch(t){case"horizontal":return x.Horizontal;case"vertical":return x.Vertical;case"both":return x.Both;default:return x.Vertical}};t.parseFlipType=function(t){switch(t){case"hz":return I.Horizontal;case"vt":return I.Vertical;case"both":return I.Both;default:return I.None}};var E={Linear:egret.Ease.getPowIn(1),"Elastic.In":egret.Ease.elasticIn,"Elastic.Out":egret.Ease.elasticOut,"Elastic.InOut":egret.Ease.elasticInOut,"Quad.In":egret.Ease.quadIn,"Quad.Out":egret.Ease.quadOut,"Quad.InOut":egret.Ease.quadInOut,"Cube.In":egret.Ease.cubicIn,"Cube.Out":egret.Ease.cubicOut,"Cube.InOut":egret.Ease.cubicInOut,"Quart.In":egret.Ease.quartIn,"Quart.Out":egret.Ease.quartOut,"Quart.InOut":egret.Ease.quartInOut,"Quint.In":egret.Ease.quintIn,"Quint.Out":egret.Ease.quintOut,"Quint.InOut":egret.Ease.quintInOut,"Sine.In":egret.Ease.sineIn,"Sine.Out":egret.Ease.sineOut,"Sine.InOut":egret.Ease.sineInOut,"Bounce.In":egret.Ease.bounceIn,"Bounce.Out":egret.Ease.bounceOut,"Bounce.InOut":egret.Ease.bounceInOut,"Circ.In":egret.Ease.circIn,"Circ.Out":egret.Ease.circOut,"Circ.InOut":egret.Ease.circInOut,"Expo.In":egret.Ease.quartIn,"Expo.Out":egret.Ease.quartOut,"Expo.InOut":egret.Ease.quartInOut,"Back.In":egret.Ease.backIn,"Back.Out":egret.Ease.backOut,"Back.InOut":egret.Ease.backInOut};t.parseEaseType=function(t){var e=E[t];return e||(e=egret.Ease.quartOut),e};t.parseGroupLayoutType=function(t){switch(t){case"hz":return P.Horizontal;case"vt":return P.Vertical;default:return P.None}}}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._sortingChildCount=0,i._childrenRenderOrder=t.ChildrenRenderOrder.Ascent,i._apexIndex=0,i._children=new Array,i._controllers=new Array,i._transitions=new Array,i._margin=new t.Margin,i._alignOffset=new egret.Point,i}return i.prototype.createDisplayObject=function(){this._rootContainer=new t.UIContainer,this._rootContainer.$owner=this,this.setDisplayObject(this._rootContainer),this._container=this._rootContainer},i.prototype.dispose=function(){var t,i=this._transitions.length;for(t=0;t<i;++t){this._transitions[t].dispose()}for(t=this._children.length-1;t>=0;--t){var n=this._children[t];n.parent=null,n.dispose()}this._boundsChanged=!1,e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"displayListContainer",{get:function(){return this._container},enumerable:!0,configurable:!0}),i.prototype.addChild=function(t){return this.addChildAt(t,this._children.length),t},i.prototype.addChildAt=function(t,e){if(void 0===e&&(e=0),!t)throw"child is null";var i=this._children.length;if(e>=0&&e<=i){if(t.parent==this)this.setChildIndex(t,e);else{t.removeFromParent(),t.parent=this;var n=this._children.length;0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):this._sortingChildCount>0&&e>n-this._sortingChildCount&&(e=n-this._sortingChildCount),e==n?this._children.push(t):this._children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()}return t}throw"Invalid child index"},i.prototype.getInsertPosForSortingChild=function(t){var e=this._children.length,i=0;for(i=0;i<e;i++){var n=this._children[i];if(n!=t&&t.sortingOrder<n.sortingOrder)break}return i},i.prototype.removeChild=function(t,e){void 0===e&&(e=!1);var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t},i.prototype.removeChildAt=function(e,i){if(void 0===i&&(i=!1),e>=0&&e<this.numChildren){var n=this._children[e];return n.parent=null,0!=n.sortingOrder&&this._sortingChildCount--,this._children.splice(e,1),n.group=null,n.inContainer&&(this._container.removeChild(n.displayObject),this._childrenRenderOrder==t.ChildrenRenderOrder.Arch&&t.GTimers.inst.callLater(this.buildNativeDisplayList,this)),i&&n.dispose(),this.setBoundsChangedFlag(),n}throw"Invalid child index"},i.prototype.removeChildren=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=!1),(e<0||e>=this.numChildren)&&(e=this.numChildren-1);for(var n=t;n<=e;++n)this.removeChildAt(t,i)},i.prototype.getChildAt=function(t){if(void 0===t&&(t=0),t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},i.prototype.getChild=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null},i.prototype.getVisibleChild=function(t){for(var e=this._children.length,i=0;i<e;++i){var n=this._children[i];if(n.internalVisible&&n.internalVisible&&n.name==t)return n}return null},i.prototype.getChildInGroup=function(t,e){for(var i=this._children.length,n=0;n<i;++n){var s=this._children[n];if(s.group==e&&s.name==t)return s}return null},i.prototype.getChildById=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i]._id==t)return this._children[i];return null},i.prototype.getChildIndex=function(t){return this._children.indexOf(t)},i.prototype.setChildIndex=function(t,e){void 0===e&&(e=0);var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0==t.sortingOrder){var n=this._children.length;this._sortingChildCount>0&&e>n-this._sortingChildCount-1&&(e=n-this._sortingChildCount-1),this._setChildIndex(t,i,e)}},i.prototype.setChildIndexBefore=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0!=t.sortingOrder)return i;var n=this._children.length;return this._sortingChildCount>0&&e>n-this._sortingChildCount-1&&(e=n-this._sortingChildCount-1),i<e?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e)},i.prototype._setChildIndex=function(e,i,n){void 0===n&&(n=0);var s=this._children.length;if(n>s&&(n=s),i==n)return i;if(this._children.splice(i,1),this._children.splice(n,0,e),e.inContainer){var r,o=0;if(this._childrenRenderOrder==t.ChildrenRenderOrder.Ascent){for(r=0;r<n;r++)this._children[r].inContainer&&o++;o==this._container.numChildren&&o--,this._container.setChildIndex(e.displayObject,o)}else if(this._childrenRenderOrder==t.ChildrenRenderOrder.Descent){for(r=s-1;r>n;r--)this._children[r].inContainer&&o++;o==this._container.numChildren&&o--,this._container.setChildIndex(e.displayObject,o)}else t.GTimers.inst.callLater(this.buildNativeDisplayList,this);this.setBoundsChangedFlag()}return n},i.prototype.swapChildren=function(t,e){var i=this._children.indexOf(t),n=this._children.indexOf(e);if(-1==i||-1==n)throw"Not a child of this container";this.swapChildrenAt(i,n)},i.prototype.swapChildrenAt=function(t,e){void 0===e&&(e=0);var i=this._children[t],n=this._children[e];this.setChildIndex(i,e),this.setChildIndex(n,t)},Object.defineProperty(i.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),i.prototype.isAncestorOf=function(t){if(null==t)return!1;for(var e=t.parent;e;){if(e==this)return!0;e=e.parent}return!1},i.prototype.addController=function(t){this._controllers.push(t),t._parent=this,this.applyController(t)},i.prototype.getControllerAt=function(t){return this._controllers[t]},i.prototype.getController=function(t){for(var e=this._controllers.length,i=0;i<e;++i){var n=this._controllers[i];if(n.name==t)return n}return null},i.prototype.removeController=function(t){var e=this._controllers.indexOf(t);if(-1==e)throw"controller not exists";t._parent=null,this._controllers.splice(e,1);for(var i=this._children.length,n=0;n<i;n++){this._children[n].handleControllerChanged(t)}},Object.defineProperty(i.prototype,"controllers",{get:function(){return this._controllers},enumerable:!0,configurable:!0}),i.prototype.childStateChanged=function(e){if(!this._buildingDisplayList){var i,n,s=this._children.length;if(e instanceof t.GGroup)for(n=0;n<s;n++)(i=this._children[n]).group==e&&this.childStateChanged(i);else if(e.displayObject)if(e.internalVisible){if(!e.displayObject.parent){var r=0;if(this._childrenRenderOrder==t.ChildrenRenderOrder.Ascent){for(n=0;n<s&&(i=this._children[n])!=e;n++)null!=i.displayObject&&null!=i.displayObject.parent&&r++;this._container.addChildAt(e.displayObject,r)}else if(this._childrenRenderOrder==t.ChildrenRenderOrder.Descent){for(n=s-1;n>=0&&(i=this._children[n])!=e;n--)null!=i.displayObject&&null!=i.displayObject.parent&&r++;this._container.addChildAt(e.displayObject,r)}else this._container.addChild(e.displayObject),t.GTimers.inst.callLater(this.buildNativeDisplayList,this)}}else e.displayObject.parent&&this._container.removeChild(e.displayObject)}},i.prototype.buildNativeDisplayList=function(){var e=this._children.length;if(0!=e){var i,n;switch(this._childrenRenderOrder){case t.ChildrenRenderOrder.Ascent:for(i=0;i<e;i++)null!=(n=this._children[i]).displayObject&&n.internalVisible&&this._container.addChild(n.displayObject);break;case t.ChildrenRenderOrder.Descent:for(i=e-1;i>=0;i--)null!=(n=this._children[i]).displayObject&&n.internalVisible&&this._container.addChild(n.displayObject);break;case t.ChildrenRenderOrder.Arch:for(i=0;i<this._apexIndex;i++)null!=(n=this._children[i]).displayObject&&n.internalVisible&&this._container.addChild(n.displayObject);for(i=e-1;i>=this._apexIndex;i--)null!=(n=this._children[i]).displayObject&&n.internalVisible&&this._container.addChild(n.displayObject)}}},i.prototype.applyController=function(t){this._applyingController=t;for(var e=this._children.length,i=0;i<e;i++)this._children[i].handleControllerChanged(t);this._applyingController=null,t.runActions()},i.prototype.applyAllControllers=function(){for(var t=this._controllers.length,e=0;e<t;++e)this.applyController(this._controllers[e])},i.prototype.adjustRadioGroupDepth=function(e,i){var n,s,r=this._children.length,o=-1,a=-1;for(n=0;n<r;n++)(s=this._children[n])==e?o=n:s instanceof t.GButton&&s.relatedController==i&&n>a&&(a=n);o<a&&(null!=this._applyingController&&this._children[a].handleControllerChanged(this._applyingController),this.swapChildrenAt(o,a))},i.prototype.getTransitionAt=function(t){return this._transitions[t]},i.prototype.getTransition=function(t){for(var e=this._transitions.length,i=0;i<e;++i){var n=this._transitions[i];if(n.name==t)return n}return null},i.prototype.isChildInView=function(t){return null!=this._rootContainer.scrollRect?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:null==this._scrollPane||this._scrollPane.isChildInView(t)},i.prototype.getFirstChildInView=function(){for(var t=this._children.length,e=0;e<t;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1},Object.defineProperty(i.prototype,"scrollPane",{get:function(){return this._scrollPane},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"opaque",{get:function(){return this._opaque},set:function(t){this._opaque!=t&&(this._opaque=t,this._opaque?this.updateOpaque():this._rootContainer.hitArea=null)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"margin",{get:function(){return this._margin},set:function(t){this._margin.copy(t),null!=this._rootContainer.scrollRect&&(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y),this.handleSizeChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childrenRenderOrder",{get:function(){return this._childrenRenderOrder},set:function(t){this._childrenRenderOrder!=t&&(this._childrenRenderOrder=t,this.buildNativeDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"apexIndex",{get:function(){return this._apexIndex},set:function(e){this._apexIndex!=e&&(this._apexIndex=e,this._childrenRenderOrder==t.ChildrenRenderOrder.Arch&&this.buildNativeDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mask",{get:function(){return this._rootContainer.mask},set:function(t){this._rootContainer.mask=t},enumerable:!0,configurable:!0}),i.prototype.updateOpaque=function(){this._rootContainer.hitArea||(this._rootContainer.hitArea=new egret.Rectangle),this._rootContainer.hitArea.setTo(0,0,this.width,this.height)},i.prototype.updateScrollRect=function(){var t=this._rootContainer.scrollRect;null==t&&(t=new egret.Rectangle);var e=this.width-this._margin.right,i=this.height-this._margin.bottom;t.setTo(0,0,e,i),this._rootContainer.scrollRect=t},i.prototype.setupScroll=function(e,i,n,s,r,o){this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this._scrollPane=new t.ScrollPane(this,i,e,n,s,r,o),this.setBoundsChangedFlag()},i.prototype.setupOverflow=function(e){e==t.OverflowType.Hidden?(this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this.updateScrollRect(),this._container.x=this._margin.left,this._container.y=this._margin.top):0==this._margin.left&&0==this._margin.top||(this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this._container.x=this._margin.left,this._container.y=this._margin.top),this.setBoundsChangedFlag()},i.prototype.handleSizeChanged=function(){this._scrollPane?this._scrollPane.onOwnerSizeChanged():null!=this._rootContainer.scrollRect&&this.updateScrollRect(),this._opaque&&this.updateOpaque()},i.prototype.handleGrayedChanged=function(){var t=this.getController("grayed");if(null==t)for(var e=this.grayed,i=this._children.length,n=0;n<i;++n)this._children[n].grayed=e;else t.selectedIndex=this.grayed?1:0},i.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),null!=this._scrollPane&&this._scrollPane.handleControllerChanged(t)},i.prototype.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,egret.callLater(this.__render,this)))},i.prototype.__render=function(){if(this._boundsChanged){var t=this._children.length;if(t>0)for(var e=0;e<t;e++){this._children[e].ensureSizeCorrect()}this.updateBounds()}},i.prototype.ensureBoundsCorrect=function(){var t=this._children.length;if(t>0)for(var e=0;e<t;e++){this._children[e].ensureSizeCorrect()}this._boundsChanged&&this.updateBounds()},i.prototype.updateBounds=function(){var t=0,e=0,i=0,n=0,s=this._children.length;if(s>0){t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;var r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=0,h=0;for(h=0;h<s;h++){var l=this._children[h];(a=l.x)<t&&(t=a),(a=l.y)<e&&(e=a),(a=l.x+l.actualWidth)>r&&(r=a),(a=l.y+l.actualHeight)>o&&(o=a)}i=r-t,n=o-e}this.setBounds(t,e,i,n)},i.prototype.setBounds=function(t,e,i,n){void 0===n&&(n=0),this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+n))},Object.defineProperty(i.prototype,"viewWidth",{get:function(){return null!=this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},set:function(t){null!=this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewHeight",{get:function(){return null!=this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},set:function(t){null!=this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom},enumerable:!0,configurable:!0}),i.prototype.getSnappingPosition=function(t,e,i){i||(i=new egret.Point);var n=this._children.length;if(0==n)return i.x=0,i.y=0,i;this.ensureBoundsCorrect();var s=null,r=null,o=0;if(0!=e){for(;o<n;o++)if(e<(s=this._children[o]).y){if(0==o){e=0;break}e=e<(r=this._children[o-1]).y+r.actualHeight/2?r.y:s.y;break}o==n&&(e=s.y)}if(0!=t){for(o>0&&o--;o<n;o++)if(t<(s=this._children[o]).x){if(0==o){t=0;break}t=t<(r=this._children[o-1]).x+r.actualWidth/2?r.x:s.x;break}o==n&&(t=s.x)}return i.x=t,i.y=e,i},i.prototype.childSortingOrderChanged=function(t,e,i){if(void 0===i&&(i=0),0==i)this._sortingChildCount--,this.setChildIndex(t,this._children.length);else{0==e&&this._sortingChildCount++;var n=this._children.indexOf(t),s=this.getInsertPosForSortingChild(t);n<s?this._setChildIndex(t,n,s-1):this._setChildIndex(t,n,s)}},i.prototype.constructFromResource=function(){this.constructFromResource2(null,0)},i.prototype.constructFromResource2=function(e,i){var n=this.packageItem.owner.getItemAsset(this.packageItem);this._underConstruct=!0;var s,r;r=(s=n.attributes.size).split(","),this.sourceWidth=parseInt(r[0]),this.sourceHeight=parseInt(r[1]),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),(s=n.attributes.restrictSize)&&(r=s.split(","),this.minWidth=parseInt(r[0]),this.maxWidth=parseInt(r[1]),this.minHeight=parseInt(r[2]),this.maxHeight=parseInt(r[3])),(s=n.attributes.pivot)&&(r=s.split(","),s=n.attributes.anchor,this.internalSetPivot(parseFloat(r[0]),parseFloat(r[1]),"true"==s)),s=n.attributes.opaque,this.opaque="false"!=s;var o;if(o=(s=n.attributes.overflow)?t.parseOverflowType(s):t.OverflowType.Visible,(s=n.attributes.margin)&&this._margin.parse(s),o==t.OverflowType.Scroll){var a;a=(s=n.attributes.scroll)?t.parseScrollType(s):t.ScrollType.Vertical;var h;h=(s=n.attributes.scrollBar)?t.parseScrollBarDisplayType(s):t.ScrollBarDisplayType.Default;var l;l=(s=n.attributes.scrollBarFlags)?parseInt(s):0;var c=new t.Margin;(s=n.attributes.scrollBarMargin)&&c.parse(s);var u,_;(s=n.attributes.scrollBarRes)&&(u=(r=s.split(","))[0],_=r[1]),this.setupScroll(c,a,h,l,u,_)}else this.setupOverflow(o);this._buildingDisplayList=!0;var p=n.children,d=0;p&&(d=p.length);var g,f;for(g=0;g<d;g++){"controller"==(C=p[g]).name&&(f=new t.Controller,this._controllers.push(f),f._parent=this,f.setup(C))}var y,b=this.packageItem.displayList,m=b.length;for(g=0;g<m;g++){var v=b[g];null!=e?y=e[i+g]:v.packageItem?((y=t.UIObjectFactory.newObject(v.packageItem)).packageItem=v.packageItem,y.constructFromResource()):y=t.UIObjectFactory.newObject2(v.type),y._underConstruct=!0,y.setup_beforeAdd(v.desc),y.parent=this,this._children.push(y)}for(this.relations.setup(n),g=0;g<m;g++)this._children[g].relations.setup(b[g].desc);for(g=0;g<m;g++)(y=this._children[g]).setup_afterAdd(b[g].desc),y._underConstruct=!1;(s=n.attributes.mask)&&(this.mask=this.getChildById(s).displayObject);var w;for(g=0;g<d;g++){var C;"transition"==(C=p[g]).name&&(w=new t.Transition(this),this._transitions.push(w),w.setup(C))}this._transitions.length>0&&(this.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,this.___added,this),this.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.___removed,this)),this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,this.buildNativeDisplayList(),this.setBoundsChangedFlag(),this.constructFromXML(n)},i.prototype.constructFromXML=function(t){},i.prototype.setup_afterAdd=function(t){e.prototype.setup_afterAdd.call(this,t);var i;if(this.scrollPane&&(i=t.attributes.pageController)&&(this.scrollPane.pageController=this.parent.getController(i)),i=t.attributes.controller)for(var n=i.split(","),s=0;s<n.length;s+=2){var r=this.getController(n[s]);r&&(r.selectedPageId=n[s+1])}},i.prototype.___added=function(t){for(var e=this._transitions.length,i=0;i<e;++i){var n=this._transitions[i];n.autoPlay&&n.play(null,null,null,n.autoPlayRepeat,n.autoPlayDelay)}},i.prototype.___removed=function(t){for(var e=this._transitions.length,i=0;i<e;++i)this._transitions[i].OnOwnerRemovedFromStage()},i}(t.GObject);t.GComponent=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(t){this._owner=t,this._easeType=egret.Ease.quadOut,this._tweenTime=.3,this._tweenDelay=0,this._displayLockToken=0}return Object.defineProperty(e.prototype,"controller",{get:function(){return this._controller},set:function(t){t!=this._controller&&(this._controller=t,this._controller&&this.init())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tween",{get:function(){return this._tween},set:function(t){this._tween=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweenDelay",{get:function(){return this._tweenDelay},set:function(t){this._tweenDelay=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweenTime",{get:function(){return this._tweenTime},set:function(t){this._tweenTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"easeType",{get:function(){return this._easeType},set:function(t){this._easeType=t},enumerable:!0,configurable:!0}),e.prototype.setup=function(e){if(this._controller=this._owner.parent.getController(e.attributes.controller),null!=this._controller){this.init();var i;if((i=e.attributes.tween)&&(this._tween=!0),(i=e.attributes.ease)&&(this._easeType=t.parseEaseType(i)),(i=e.attributes.duration)&&(this._tweenTime=parseFloat(i)),(i=e.attributes.delay)&&(this._tweenDelay=parseFloat(i)),this instanceof t.GearDisplay)(i=e.attributes.pages)&&(this.pages=i.split(","));else{var n,s;if((i=e.attributes.pages)&&(n=i.split(",")),n){s=(i=e.attributes.values)?i.split("|"):[];for(var r=0;r<n.length;r++)null==(i=s[r])&&(i=""),this.addStatus(n[r],i)}(i=e.attributes.default)&&this.addStatus(null,i)}}},e.prototype.updateFromRelations=function(t,e){},e.prototype.addStatus=function(t,e){},e.prototype.init=function(){},e.prototype.apply=function(){},e.prototype.updateState=function(){},e.disableAllTweenEffect=!1,e}();t.GearBase=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){this._count=0,this._pool={}}return e.prototype.clear=function(){for(var t=this._pool.length,e=0;e<t;e++)for(var i=this._pool[e],n=i.length,s=0;s<n;s++)i[s].dispose();this._pool={},this._count=0},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.getObject=function(e){if(null==(e=t.UIPackage.normalizeURL(e)))return null;var i=this._pool[e];if(null!=i&&i.length)return this._count--,i.shift();return t.UIPackage.createObjectFromURL(e)},e.prototype.returnObject=function(t){var e=t.resourceURL;if(e){var i=this._pool[e];null==i&&(i=new Array,this._pool[e]=i),this._count++,i.push(t)}},e}();t.GObjectPool=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(n,e);function n(){var i=e.call(this)||this;return i._fontSize=0,i._leading=0,i._letterSpacing=0,i._textWidth=0,i._textHeight=0,i._fontSize=12,i._align=t.AlignType.Left,i._verticalAlign=t.VertAlignType.Top,i._text="",i._leading=3,i._color=0,i._autoSize=t.AutoSizeType.Both,i._widthAutoSize=!0,i._heightAutoSize=!0,i._bitmapPool=new Array,i}return n.prototype.createDisplayObject=function(){this._textField=new egret.TextField,this._textField.$owner=this,this._textField.touchEnabled=!1,this.setDisplayObject(this._textField)},n.prototype.switchBitmapMode=function(t){t&&this.displayObject==this._textField?(null==this._bitmapContainer&&(this._bitmapContainer=new egret.Sprite,this._bitmapContainer.$owner=this),this.switchDisplayObject(this._bitmapContainer)):t||this.displayObject!=this._bitmapContainer||this.switchDisplayObject(this._textField)},n.prototype.dispose=function(){e.prototype.dispose.call(this),this._bitmapFont=null},Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,null==this._text&&(this._text=""),this.updateGear(6),this.parent&&this.parent._underConstruct?this.renderNow():this.render()},enumerable:!0,configurable:!0}),n.prototype.updateTextFieldText=function(){this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._text))):this._textField.text=this._text},Object.defineProperty(n.prototype,"font",{get:function(){return this._font},set:function(t){this._font!=t&&(this._font=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){t<0||this._fontSize!=t&&(this._fontSize=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(e){this._align!=e&&(this._align=e,this._textField.textAlign=t.getAlignTypeString(this._align),this._bitmapFont&&!this._underConstruct&&this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(e){this._verticalAlign!=e&&(this._verticalAlign=e,this._textField.verticalAlign=t.getVertAlignTypeString(this._verticalAlign),this._bitmapFont&&!this._underConstruct&&this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!=t&&(this._leading=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!=t&&(this._letterSpacing=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"underline",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bold",{get:function(){return this._textField.bold},set:function(t){this._textField.bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"italic",{get:function(){return this._textField.italic},set:function(t){this._textField.italic=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"singleLine",{get:function(){return!this._textField.multiline},set:function(t){t=!t,this._textField.multiline!=t&&(this._textField.multiline=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this._textField.stroke},set:function(t){this._textField.stroke=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this._textField.strokeColor},set:function(t){this._textField.strokeColor=t,this.updateGear(4)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ubbEnabled",{get:function(){return this._ubbEnabled},set:function(t){this._ubbEnabled!=t&&(this._ubbEnabled=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"autoSize",{get:function(){return this._autoSize},set:function(e){this._autoSize!=e&&(this._autoSize=e,this._widthAutoSize=e==t.AutoSizeType.Both,this._heightAutoSize=e==t.AutoSizeType.Both||e==t.AutoSizeType.Height,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){return this._requireRender&&this.renderNow(),this._textWidth},enumerable:!0,configurable:!0}),n.prototype.ensureSizeCorrect=function(){this._sizeDirty&&this._requireRender&&this.renderNow()},n.prototype.updateTextFormat=function(){this._textField.size=this._fontSize,t.ToolSet.startsWith(this._font,"ui://")?this._bitmapFont=t.UIPackage.getBitmapFontByURL(this._font):(this._bitmapFont=null,this._font?this._textField.fontFamily=this._font:this._textField.fontFamily=t.UIConfig.defaultFont),this.grayed?this._textField.textColor=11184810:this._textField.textColor=this._color,this._textField.lineSpacing=this._leading,this._underConstruct||this.render()},n.prototype.render=function(){this._requireRender||(this._requireRender=!0,egret.callLater(this.__render,this)),this._sizeDirty||!this._widthAutoSize&&!this._heightAutoSize||(this._sizeDirty=!0,this.dispatchEventWith(t.GObject.SIZE_DELAY_CHANGE))},n.prototype.__render=function(){this._requireRender&&this.renderNow()},n.prototype.renderNow=function(t){if(void 0===t&&(t=!0),this._requireRender=!1,this._sizeDirty=!1,null==this._bitmapFont){this.switchBitmapMode(!1),this._textField.width=this._widthAutoSize?1e4:Math.ceil(this.width),this.updateTextFieldText(),this._textWidth=Math.ceil(this._textField.textWidth),this._textWidth>0&&(this._textWidth+=4),this._textHeight=Math.ceil(this._textField.textHeight),this._textHeight>0&&(this._textHeight+=4);var e,i=0;this._widthAutoSize?(e=this._textWidth,this._textField.width=e):e=this.width,this._heightAutoSize?(i=this._textHeight,this._textField.height!=this._textHeight&&(this._textField.height=this._textHeight)):(i=this.height,this._textHeight>i&&(this._textHeight=i)),t&&(this._updatingSize=!0,this.setSize(e,i),this._updatingSize=!1)}else this.renderWithBitmapFont(t)},n.prototype.renderWithBitmapFont=function(e){this.switchBitmapMode(!0);for(var s=this._bitmapContainer.numChildren,r=0;r<s;r++){var o=this._bitmapContainer.getChildAt(r);this._bitmapPool.push(o)}this._bitmapContainer.removeChildren(),this._lines?i.returnList(this._lines):this._lines=new Array;var a,h=this._letterSpacing,l=this._leading-1,c=this.width-2*n.GUTTER_X,u=0,_=0,p=0,d=0,g=0,f=0,y=0,b=0,m=0,v="",w=n.GUTTER_Y,C=!this._widthAutoSize&&this._textField.multiline,x=this._bitmapFont.resizable?this._fontSize/this._bitmapFont.size:1;this._textWidth=0,this._textHeight=0;for(var O=this._text.length,I=0;I<O;++I){var T=this._text.charAt(I),S=T.charCodeAt(0);if(10!=S){if(S>=65&&S<=90||S>=97&&S<=122?(0==f&&(y=u),f++):(f>0&&(b=u),f=0),32==S)d=Math.ceil(this._fontSize/2),g=this._fontSize;else{var P=this._bitmapFont.glyphs[T];P?(d=Math.ceil(P.advance*x),g=Math.ceil(P.lineHeight*x)):(d=0,g=0)}if(g>p&&(p=g),g>_&&(_=g),0!=u&&(u+=h),u+=d,!C||u<=c)v+=T;else{if((a=i.borrow()).height=_,a.textHeight=p,0==v.length)a.text=T;else if(f>0&&b>0){var j=(v+=T).length-f;a.text=t.ToolSet.trimRight(v.substr(0,j)),a.width=b,v=v.substr(j),u-=y}else a.text=v,a.width=u-(d+h),v=T,u=d,_=g,p=g;a.y=w,w+=a.height+l,a.width>this._textWidth&&(this._textWidth=a.width),f=0,y=0,b=0,this._lines.push(a)}}else v+=T,(a=i.borrow()).width=u,0==p&&(0==m&&(m=this._fontSize),0==_&&(_=m),p=_),a.height=_,m=_,a.textHeight=p,a.text=v,a.y=w,w+=a.height+l,a.width>this._textWidth&&(this._textWidth=a.width),this._lines.push(a),v="",u=0,_=0,p=0,f=0,y=0,b=0}v.length>0&&((a=i.borrow()).width=u,0==_&&(_=m),0==p&&(p=_),a.height=_,a.textHeight=p,a.text=v,a.y=w,a.width>this._textWidth&&(this._textWidth=a.width),this._lines.push(a)),this._textWidth>0&&(this._textWidth+=2*n.GUTTER_X);0==this._lines.length?this._textHeight=0:(a=this._lines[this._lines.length-1],this._textHeight=a.y+a.height+n.GUTTER_Y);var L,E=0;if(L=this._widthAutoSize?0==this._textWidth?0:this._textWidth:this.width,E=this._heightAutoSize?0==this._textHeight?0:this._textHeight:this.height,e&&(this._updatingSize=!0,this.setSize(L,E),this._updatingSize=!1,this.doAlign()),0!=L&&0!=E){var A=n.GUTTER_X,k=0,F=0;c=this.width-2*n.GUTTER_X;var R=this._lines.length;for(r=0;r<R;r++){a=this._lines[r],A=n.GUTTER_X,k=this._align==t.AlignType.Center?(c-a.width)/2:this._align==t.AlignType.Right?c-a.width:0,O=a.text.length;for(var B=0;B<O;B++)if(10!=(S=(T=a.text.charAt(B)).charCodeAt(0)))if(32!=S)if(null!=(P=this._bitmapFont.glyphs[T])){F=(a.height+a.textHeight)/2-Math.ceil(P.lineHeight*x);var G;this._bitmapPool.length?G=this._bitmapPool.pop():(G=new egret.Bitmap).smoothing=!0,G.x=A+k+Math.ceil(P.offsetX*x),G.y=a.y+F+Math.ceil(P.offsetY*x),G.texture=P.texture,G.scaleX=x,G.scaleY=x,this._bitmapContainer.addChild(G),A+=h+Math.ceil(P.advance*x)}else A+=h;else A+=h+Math.ceil(this._fontSize/2)}}},n.prototype.handleSizeChanged=function(){this._updatingSize||(null!=this._bitmapFont?this._widthAutoSize?this.doAlign():this.render():this._underConstruct?(this._textField.width=this.width,this._textField.height=this.height):this._widthAutoSize||(this._heightAutoSize?this._textField.width=this.width:(this._textField.width=this.width,this._textField.height=this.height)))},n.prototype.handleGrayedChanged=function(){e.prototype.handleGrayedChanged.call(this),this.updateTextFormat()},n.prototype.doAlign=function(){if(this._verticalAlign==t.VertAlignType.Top||0==this._textHeight)this._yOffset=n.GUTTER_Y;else{var e=this.height-this._textHeight;e<0&&(e=0),this._verticalAlign==t.VertAlignType.Middle?this._yOffset=Math.floor(e/2):this._yOffset=Math.floor(e)}this.displayObject.y=this.y+this._yOffset},n.prototype.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var n;(n=i.attributes.font)&&(this._font=n),(n=i.attributes.fontSize)&&(this._fontSize=parseInt(n)),(n=i.attributes.color)&&(this._color=t.ToolSet.convertFromHtmlColor(n)),(n=i.attributes.align)&&(this.align=t.parseAlignType(n)),(n=i.attributes.vAlign)&&(this.verticalAlign=t.parseVertAlignType(n)),n=i.attributes.leading,this._leading=n?parseInt(n):3,(n=i.attributes.letterSpacing)&&(this._letterSpacing=parseInt(n)),this._ubbEnabled="true"==i.attributes.ubb,(n=i.attributes.autoSize)&&(this._autoSize=t.parseAutoSizeType(n),this._widthAutoSize=this._autoSize==t.AutoSizeType.Both,this._heightAutoSize=this._autoSize==t.AutoSizeType.Both||this._autoSize==t.AutoSizeType.Height),this._textField.italic="true"==i.attributes.italic,this._textField.bold="true"==i.attributes.bold,this._textField.multiline="true"!=i.attributes.singleLine,(n=i.attributes.strokeColor)&&(this._textField.strokeColor=t.ToolSet.convertFromHtmlColor(n),n=i.attributes.strokeSize,this.stroke=n?parseInt(n)+1:2)},n.prototype.setup_afterAdd=function(t){e.prototype.setup_afterAdd.call(this,t),this.updateTextFormat();var i=t.attributes.text;null!=i&&i.length>0&&(this.text=i),this._sizeDirty=!1},n.GUTTER_X=2,n.GUTTER_Y=2,n}(t.GObject);t.GTextField=e;var i=function(){function t(){this.width=0,this.height=0,this.textHeight=0,this.y=0}return t.borrow=function(){if(t.pool.length){var e=t.pool.pop();return e.width=0,e.height=0,e.textHeight=0,e.text=null,e.y=0,e}return new t},t.returns=function(e){t.pool.push(e)},t.returnList=function(e){for(var i=e.length,n=0;n<i;n++){var s=e[n];t.pool.push(s)}e.length=0},t.pool=[],t}();t.LineInfo=i}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){}return e.createAction=function(e){switch(e){case"play_transition":return new t.PlayTransitionAction;case"change_page":return new t.ChangePageAction}return null},e.prototype.run=function(t,e,i){null!=this.fromPage&&0!=this.fromPage.length&&-1==this.fromPage.indexOf(e)||null!=this.toPage&&0!=this.toPage.length&&-1==this.toPage.indexOf(i)?this.leave(t):this.enter(t)},e.prototype.enter=function(t){},e.prototype.leave=function(t){},e.prototype.setup=function(t){var e;(e=t.attributes.fromPage)&&(this.fromPage=e.split(",")),(e=t.attributes.toPage)&&(this.toPage=e.split(","))},e}();t.ControllerAction=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e){return t.call(this,e)||this}return e.prototype.init=function(){this._default=new i(this._owner.playing,this._owner.frame),this._storage={}},e.prototype.addStatus=function(t,e){if("-"!=e&&0!=e.length){var n;null==t?n=this._default:(n=new i,this._storage[t]=n);var s=e.split(",");n.frame=parseInt(s[0]),n.playing="p"==s[1]}},e.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];t||(t=this._default),this._owner.frame=t.frame,this._owner.playing=t.playing,this._owner._gearLocked=!1},e.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.frame=this._owner.frame,t.playing=this._owner.playing},e}(t.GearBase);t.GearAnimation=e;var i=function(){return function(t,e){void 0===t&&(t=!0),void 0===e&&(e=0),this.playing=t,this.frame=e}}()}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){this._agent=new t.GLoader,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.align=t.AlignType.Center,this._agent.verticalAlign=t.VertAlignType.Middle,this._agent.sortingOrder=1e6,this._agent.addEventListener(t.DragEvent.DRAG_END,this.__dragEnd,this)}return Object.defineProperty(e,"inst",{get:function(){return null==e._inst&&(e._inst=new e),e._inst},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragAgent",{get:function(){return this._agent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragging",{get:function(){return null!=this._agent.parent},enumerable:!0,configurable:!0}),e.prototype.startDrag=function(e,i,n,s){if(void 0===s&&(s=-1),null==this._agent.parent){this._sourceData=n,this._agent.url=i,t.GRoot.inst.addChild(this._agent);var r=t.GRoot.inst.globalToLocal(t.GRoot.mouseX,t.GRoot.mouseY);this._agent.setXY(r.x,r.y),this._agent.startDrag(s)}},e.prototype.cancel=function(){null!=this._agent.parent&&(this._agent.stopDrag(),t.GRoot.inst.removeChild(this._agent),this._sourceData=null)},e.prototype.__dragEnd=function(e){if(null!=this._agent.parent){t.GRoot.inst.removeChild(this._agent);var i=this._sourceData;this._sourceData=null;for(var n=t.GRoot.inst.getObjectUnderPoint(e.stageX,e.stageY);null!=n;){if(n.hasEventListener(t.DropEvent.DROP)){var s=new t.DropEvent(t.DropEvent.DROP,i);return n.requestFocus(),void n.dispatchEvent(s)}n=n.parent}}},e}();t.DragDropManager=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(n,e);function n(t){return e.call(this,t)||this}return n.prototype.init=function(){void 0!=this._owner.strokeColor?this._default=new i(this._owner.color,this._owner.strokeColor):this._default=new i(this._owner.color),this._storage={}},n.prototype.addStatus=function(e,n){if("-"!=n&&0!=n.length){var s,r,o=n.indexOf(",");-1==o?(s=t.ToolSet.convertFromHtmlColor(n),r=NaN):(s=t.ToolSet.convertFromHtmlColor(n.substr(0,o)),r=t.ToolSet.convertFromHtmlColor(n.substr(o+1))),null==e?(this._default.color=s,this._default.strokeColor=r):this._storage[e]=new i(s,r)}},n.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];t||(t=this._default),this._owner.color=t.color,void 0==this._owner.strokeColor||isNaN(t.strokeColor)||(this._owner.strokeColor=t.strokeColor),this._owner._gearLocked=!1},n.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i(null,null),this._storage[this._controller.selectedPageId]=t),t.color=this._owner.color,void 0!=this._owner.strokeColor&&(t.strokeColor=this._owner.strokeColor)},n}(t.GearBase);t.GearColor=e;var i=function(){return function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.color=t,this.strokeColor=e}}()}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e){var i=t.call(this,e)||this;return i._displayLockToken=1,i._visible=0,i}return e.prototype.init=function(){this.pages=null},e.prototype.apply=function(){this._displayLockToken++,0==this._displayLockToken&&(this._displayLockToken=1),null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0},e.prototype.addLock=function(){return this._visible++,this._displayLockToken},e.prototype.releaseLock=function(t){t==this._displayLockToken&&this._visible--},Object.defineProperty(e.prototype,"connected",{get:function(){return null==this._controller||this._visible>0},enumerable:!0,configurable:!0}),e}(t.GearBase);t.GearDisplay=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e){return t.call(this,e)||this}return e.prototype.init=function(){this._default=this._owner.icon,this._storage={}},e.prototype.addStatus=function(t,e){null==t?this._default=e:this._storage[t]=e},e.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.icon=void 0!=t?t:this._default,this._owner._gearLocked=!1},e.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.icon},e}(t.GearBase);t.GearIcon=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(n,e);function n(t){return e.call(this,t)||this}return n.prototype.init=function(){this._default=new i(this._owner.alpha,this._owner.rotation,this._owner.grayed,this._owner.touchable),this._storage={}},n.prototype.addStatus=function(t,e){if("-"!=e&&0!=e.length){var n,s=e.split(",");null==t?n=this._default:(n=new i,this._storage[t]=n),n.alpha=parseFloat(s[0]),n.rotation=parseInt(s[1]),n.grayed="1"==s[2],s.length<4?n.touchable=this._owner.touchable:n.touchable="1"==s[3]}},n.prototype.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),!this._tween||t.UIPackage._constructing||t.GearBase.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.grayed=e.grayed,this._owner.touchable=e.touchable,this._owner.alpha=e.alpha,this._owner.rotation=e.rotation,this._owner._gearLocked=!1;else{if(this._owner._gearLocked=!0,this._owner.grayed=e.grayed,this._owner.touchable=e.touchable,this._owner._gearLocked=!1,null!=this.tweener){if(this._tweenTarget.alpha==e.alpha&&this._tweenTarget.rotation==e.rotation)return;this.tweener.tick?this.tweener.tick(1e8):this.tweener.$tick(1e8),this.tweener=null}var i=e.alpha!=this._owner.alpha,n=e.rotation!=this._owner.rotation;if(i||n){this._owner.checkGearController(0,this._controller)&&(this._displayLockToken=this._owner.addDisplayLock()),this._tweenTarget=e;var s={onChange:function(){this._owner._gearLocked=!0,i&&(this._owner.alpha=this._tweenValue.x),n&&(this._owner.rotation=this._tweenValue.y),this._owner._gearLocked=!1},onChangeObj:this};null==this._tweenValue&&(this._tweenValue=new egret.Point),this._tweenValue.x=this._owner.alpha,this._tweenValue.y=this._owner.rotation,this.tweener=egret.Tween.get(this._tweenValue,s).wait(1e3*this._tweenDelay).to({x:e.alpha,y:e.rotation},1e3*this._tweenTime,this._easeType).call(function(){0!=this._displayLockToken&&(this._owner.releaseDisplayLock(this._displayLockToken),this._displayLockToken=0),this._tweener=null,this._owner.dispatchEventWith(t.GObject.GEAR_STOP,!1)},this)}}},n.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed,t.touchable=this._owner.touchable},n}(t.GearBase);t.GearLook=e;var i=function(){return function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!1),void 0===n&&(n=!0),this.alpha=t,this.rotation=e,this.grayed=i,this.touchable=n}}()}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(n,e);function n(t){return e.call(this,t)||this}return n.prototype.init=function(){this._default=new i(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY),this._storage={}},n.prototype.addStatus=function(t,e){if("-"!=e&&0!=e.length){var n,s=e.split(",");null==t?n=this._default:(n=new i,this._storage[t]=n),n.width=parseInt(s[0]),n.height=parseInt(s[1]),s.length>2&&(n.scaleX=parseFloat(s[2]),n.scaleY=parseFloat(s[3]))}},n.prototype.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),!this._tween||t.UIPackage._constructing||t.GearBase.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setSize(e.width,e.height,this._owner.gearXY.controller==this._controller),this._owner.setScale(e.scaleX,e.scaleY),this._owner._gearLocked=!1;else{if(null!=this.tweener){if(this._tweenTarget.width==e.width&&this._tweenTarget.height==e.height&&this._tweenTarget.scaleX==e.scaleX&&this._tweenTarget.scaleY==e.scaleY)return;this.tweener.tick?this.tweener.tick(1e8):this.tweener.$tick(1e8),this.tweener=null}var n=e.width!=this._owner.width||e.height!=this._owner.height,s=e.scaleX!=this._owner.scaleX||e.scaleY!=this._owner.scaleY;if(n||s){this._owner.checkGearController(0,this._controller)&&(this._displayLockToken=this._owner.addDisplayLock()),this._tweenTarget=e;var r={onChange:function(){this._owner._gearLocked=!0,n&&this._owner.setSize(this._tweenValue.width,this._tweenValue.height,this._owner.gearXY.controller==this._controller),s&&this._owner.setScale(this._tweenValue.scaleX,this._tweenValue.scaleY),this._owner._gearLocked=!1},onChangeObj:this};null==this._tweenValue&&(this._tweenValue=new i),this._tweenValue.width=this._owner.width,this._tweenValue.height=this._owner.height,this._tweenValue.scaleX=this._owner.scaleX,this._tweenValue.scaleY=this._owner.scaleY,this.tweener=egret.Tween.get(this._tweenValue,r).wait(1e3*this._tweenDelay).to({width:e.width,height:e.height,scaleX:e.scaleX,scaleY:e.scaleY},1e3*this._tweenTime,this._easeType).call(function(){0!=this._displayLockToken&&(this._owner.releaseDisplayLock(this._displayLockToken),this._displayLockToken=0),this._tweener=null,this._owner.dispatchEventWith(t.GObject.GEAR_STOP,!1)},this)}}},n.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY},n.prototype.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var n=this._storage[i];n.width+=t,n.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()}},n}(t.GearBase);t.GearSize=e;var i=function(){return function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.width=t,this.height=e,this.scaleX=i,this.scaleY=n}}()}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e){return t.call(this,e)||this}return e.prototype.init=function(){this._default=this._owner.text,this._storage={}},e.prototype.addStatus=function(t,e){null==t?this._default=e:this._storage[t]=e},e.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.text=void 0!=t?t:this._default,this._owner._gearLocked=!1},e.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.text},e}(t.GearBase);t.GearText=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(t){return e.call(this,t)||this}return i.prototype.init=function(){this._default=new egret.Point(this._owner.x,this._owner.y),this._storage={}},i.prototype.addStatus=function(t,e){if("-"!=e&&0!=e.length){var i,n=e.split(",");null==t?i=this._default:(i=new egret.Point,this._storage[t]=i),i.x=parseInt(n[0]),i.y=parseInt(n[1])}},i.prototype.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),!this._tween||t.UIPackage._constructing||t.GearBase.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setXY(e.x,e.y),this._owner._gearLocked=!1;else{if(this.tweener){if(this._tweenTarget.x==e.x&&this._tweenTarget.y==e.y)return;this.tweener.tick?this.tweener.tick(1e8):this.tweener.$tick(1e8),this.tweener=null}if(this._owner.x!=e.x||this._owner.y!=e.y){this._owner.checkGearController(0,this._controller)&&(this._displayLockToken=this._owner.addDisplayLock()),this._tweenTarget=e;var i={onChange:function(){this._owner._gearLocked=!0,this._owner.setXY(this._tweenValue.x,this._tweenValue.y),this._owner._gearLocked=!1},onChangeObj:this};null==this._tweenValue&&(this._tweenValue=new egret.Point),this._tweenValue.x=this._owner.x,this._tweenValue.y=this._owner.y,this.tweener=egret.Tween.get(this._tweenValue,i).wait(1e3*this._tweenDelay).to({x:e.x,y:e.y},1e3*this._tweenTime,this._easeType).call(function(){0!=this._displayLockToken&&(this._owner.releaseDisplayLock(this._displayLockToken),this._displayLockToken=0),this._tweener=null,this._owner.dispatchEventWith(t.GObject.GEAR_STOP,!1)},this)}}},i.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new egret.Point,this._storage[this._controller.selectedPageId]=t),t.x=this._owner.x,t.y=this._owner.y},i.prototype.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var n=this._storage[i];n.x+=t,n.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()}},i}(t.GearBase);t.GearXY=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._type=0,t._lineSize=0,t._lineColor=0,t._fillColor=0,t._lineSize=1,t._lineAlpha=1,t._fillAlpha=1,t._fillColor=16777215,t}return Object.defineProperty(i.prototype,"graphics",{get:function(){return this._graphics?this._graphics:(this.delayCreateDisplayObject(),this._graphics=this.displayObject.graphics,this._graphics)},enumerable:!0,configurable:!0}),i.prototype.drawRect=function(t,e,i,n,s,r){void 0===r&&(r=null),this._type=1,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=n,this._fillAlpha=s,this._corner=r,this.drawCommon()},i.prototype.drawEllipse=function(t,e,i,n,s){this._type=2,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=n,this._fillAlpha=s,this._corner=null,this.drawCommon()},i.prototype.clearGraphics=function(){this._graphics&&(this._type=0,this._graphics.clear())},Object.defineProperty(i.prototype,"color",{get:function(){return this._fillColor},set:function(t){this._fillColor=t,0!=this._type&&this.drawCommon()},enumerable:!0,configurable:!0}),i.prototype.drawCommon=function(){this.graphics,this._graphics.clear();var t=this.width,e=this.height;0!=t&&0!=e&&(0==this._lineSize?this._graphics.lineStyle(0,0,0):this._graphics.lineStyle(this._lineSize,this._lineColor,this._lineAlpha),this._graphics.beginFill(this._fillColor,this._fillAlpha),1==this._type?this._corner?1==this._corner.length?this._graphics.drawRoundRect(0,0,t,e,this._corner[0],this._corner[0]):this._graphics.drawRoundRect(0,0,t,e,this._corner[0],this._corner[1]):this._graphics.drawRect(0,0,t,e):this._graphics.drawEllipse(0,0,t,e),this._graphics.endFill())},i.prototype.replaceMe=function(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)},i.prototype.addBeforeMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e)},i.prototype.addAfterMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);e++,this._parent.addChildAt(t,e)},i.prototype.setNativeObject=function(t){this.delayCreateDisplayObject(),this.displayObject.addChild(t)},i.prototype.delayCreateDisplayObject=function(){if(this.displayObject)this.displayObject.graphics.clear(),this.displayObject.removeChildren(),this._graphics=null;else{var e=new t.UISprite;e.$owner=this,this.setDisplayObject(e),this._parent&&this._parent.childStateChanged(this),this.handleXYChanged(),e.alpha=this.alpha,e.rotation=this.rotation,e.visible=this.visible,e.touchEnabled=this.touchable,e.touchChildren=this.touchable,e.hitArea=new egret.Rectangle(0,0,this.width,this.height)}},i.prototype.handleSizeChanged=function(){this._graphics&&0!=this._type&&this.drawCommon(),this.displayObject instanceof t.UISprite&&(null==this.displayObject.hitArea?this.displayObject.hitArea=new egret.Rectangle(0,0,this.width,this.height):(this.displayObject.hitArea.width=this.width,this.displayObject.hitArea.height=this.height))},i.prototype.setup_beforeAdd=function(i){var n,s=i.attributes.type;if(s&&"empty"!=s){var r=new t.UISprite;r.$owner=this,this.setDisplayObject(r)}if(e.prototype.setup_beforeAdd.call(this,i),null!=this.displayObject){if(this._graphics=this.displayObject.graphics,(n=i.attributes.lineSize)&&(this._lineSize=parseInt(n)),n=i.attributes.lineColor){var o=t.ToolSet.convertFromHtmlColor(n,!0);this._lineColor=16777215&o,this._lineAlpha=(o>>24&255)/255}(n=i.attributes.fillColor)&&(o=t.ToolSet.convertFromHtmlColor(n,!0),this._fillColor=16777215&o,this._fillAlpha=(o>>24&255)/255);var a;(n=i.attributes.corner)&&((a=n.split(",")).length>1?this._corner=[parseInt(a[0]),parseInt(a[1])]:this._corner=[parseInt(a[0])]),this._type="rect"==s?1:2,this.drawCommon()}},i}(t.GObject);t.GGraph=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._layout=0,t._lineGap=0,t._columnGap=0,t._percentReady=!1,t._boundsChanged=!1,t._updating=0,t}return Object.defineProperty(i.prototype,"layout",{get:function(){return this._layout},set:function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineGap",{get:function(){return this._lineGap},set:function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnGap",{get:function(){return this._columnGap},set:function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),i.prototype.setBoundsChangedFlag=function(e){void 0===e&&(e=!1),0==this._updating&&null!=this._parent&&(e&&(this._percentReady=!1),this._boundsChanged||(this._boundsChanged=!0,this._layout!=t.GroupLayoutType.None&&t.GTimers.inst.callLater(this.ensureBoundsCorrect,this)))},i.prototype.ensureBoundsCorrect=function(){this._boundsChanged&&this.updateBounds()},i.prototype.updateBounds=function(){if(t.GTimers.inst.remove(this.ensureBoundsCorrect,this),this._boundsChanged=!1,null!=this._parent){this.handleLayout();var e,i,n,s=this._parent.numChildren,r=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,l=!0;for(e=0;e<s;e++)(i=this._parent.getChildAt(e)).group==this&&((n=i.x)<r&&(r=n),(n=i.y)<o&&(o=n),(n=i.x+i.width)>a&&(a=n),(n=i.y+i.height)>h&&(h=n),l=!1);l?(this._updating=2,this.setSize(0,0)):(this._updating=1,this.setXY(r,o),this._updating=2,this.setSize(a-r,h-o)),this._updating=0}},i.prototype.handleLayout=function(){this._updating|=1;var e,i,n;if(this._layout==t.GroupLayoutType.Horizontal){var s=NaN;for(n=this._parent.numChildren,i=0;i<n;i++)(e=this._parent.getChildAt(i)).group==this&&(isNaN(s)?s=Math.floor(e.x):e.x=s,0!=e.width&&(s+=Math.floor(e.width+this._columnGap)));this._percentReady||this.updatePercent()}else if(this._layout==t.GroupLayoutType.Vertical){var r=NaN;for(n=this._parent.numChildren,i=0;i<n;i++)(e=this._parent.getChildAt(i)).group==this&&(isNaN(r)?r=Math.floor(e.y):e.y=r,0!=e.height&&(r+=Math.floor(e.height+this._lineGap)));this._percentReady||this.updatePercent()}this._updating&=2},i.prototype.updatePercent=function(){this._percentReady=!0;var e,i,n=this._parent.numChildren,s=0;if(this._layout==t.GroupLayoutType.Horizontal){for(e=0;e<n;e++)(i=this._parent.getChildAt(e)).group==this&&(s+=i.width);for(e=0;e<n;e++)(i=this._parent.getChildAt(e)).group==this&&(i._sizePercentInGroup=s>0?i.width/s:0)}else{for(e=0;e<n;e++)(i=this._parent.getChildAt(e)).group==this&&(s+=i.height);for(e=0;e<n;e++)(i=this._parent.getChildAt(e)).group==this&&(i._sizePercentInGroup=s>0?i.height/s:0)}},i.prototype.moveChildren=function(t,e){if(0==(1&this._updating)&&null!=this._parent){this._updating|=1;var i,n,s=this._parent.numChildren;for(i=0;i<s;i++)(n=this._parent.getChildAt(i)).group==this&&n.setXY(n.x+t,n.y+e);this._updating&=2}},i.prototype.resizeChildren=function(e,i){if(this._layout!=t.GroupLayoutType.None&&0==(2&this._updating)&&null!=this._parent){this._updating|=2,this._percentReady||this.updatePercent();var n,s,r,o=this._parent.numChildren,a=-1,h=0,l=0,c=0,u=!1;for(n=0;n<o;n++)(r=this._parent.getChildAt(n)).group==this&&(a=n,h++);if(this._layout==t.GroupLayoutType.Horizontal){c=l=this.width-(h-1)*this._columnGap;var _,p=NaN;for(n=0;n<o;n++)if((r=this._parent.getChildAt(n)).group==this)if(isNaN(p)?p=Math.floor(r.x):r.x=p,_=a==n?c:Math.round(r._sizePercentInGroup*l),r.setSize(_,r._rawHeight+i,!0),c-=r.width,a==n){if(c>=1)for(s=0;s<=n;s++)(r=this._parent.getChildAt(s)).group==this&&(u?r.x+=c:(_=r.width+c,(0==r.maxWidth||_<r.maxWidth)&&(0==r.minWidth||_>r.minWidth)&&(r.setSize(_,r.height,!0),u=!0)))}else p+=r.width+this._columnGap}else if(this._layout==t.GroupLayoutType.Vertical){c=l=this.height-(h-1)*this._lineGap;var d,g=NaN;for(n=0;n<o;n++)if((r=this._parent.getChildAt(n)).group==this)if(isNaN(g)?g=Math.floor(r.y):r.y=g,d=a==n?c:Math.round(r._sizePercentInGroup*l),r.setSize(r._rawWidth+e,d,!0),c-=r.height,a==n){if(c>=1)for(s=0;s<=n;s++)(r=this._parent.getChildAt(s)).group==this&&(u?r.y+=c:(d=r.height+c,(0==r.maxHeight||d<r.maxHeight)&&(0==r.minHeight||d>r.minHeight)&&(r.setSize(r.width,d,!0),u=!0)))}else g+=r.height+this._lineGap}this._updating&=1}},i.prototype.handleAlphaChanged=function(){if(!this._underConstruct)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&(i.alpha=this.alpha)}},i.prototype.handleVisibleChanged=function(){if(this._parent)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&i.handleVisibleChanged()}},i.prototype.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var n;null!=(n=i.attributes.layout)&&(this._layout=t.parseGroupLayoutType(n),(n=i.attributes.lineGap)&&(this._lineGap=parseInt(n)),(n=i.attributes.colGap)&&(this._columnGap=parseInt(n)))},i.prototype.setup_afterAdd=function(t){e.prototype.setup_afterAdd.call(this,t),this.visible||this.handleVisibleChanged()},i}(t.GObject);t.GGroup=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._color=16777215,t}return i.prototype.getColorMatrix=function(){if(this._matrix)return this._matrix;var t=this.filters;if(t)for(var e=0;e<t.length;e++)if(egret.is(t[e],"egret.ColorMatrixFilter"))return this._matrix=t[e],this._matrix;var i=new egret.ColorMatrixFilter;return this._matrix=i,(t=t||[]).push(i),this.filters=t,i},Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.applyColor())},enumerable:!0,configurable:!0}),i.prototype.applyColor=function(){var t=this.getColorMatrix(),e=t.matrix;e[0]=(this._color>>16&255)/255,e[6]=(this._color>>8&255)/255,e[12]=(255&this._color)/255,t.matrix=e},Object.defineProperty(i.prototype,"flip",{get:function(){return this._flip},set:function(e){this._flip!=e&&(this._flip=e,this._content.scaleX=this._content.scaleY=1,this._flip!=t.FlipType.Horizontal&&this._flip!=t.FlipType.Both||(this._content.scaleX=-1),this._flip!=t.FlipType.Vertical&&this._flip!=t.FlipType.Both||(this._content.scaleY=-1),this.handleXYChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this._content.texture},set:function(t){null!=t?(this.sourceWidth=t.textureWidth,this.sourceHeight=t.textureHeight):(this.sourceWidth=0,this.sourceHeight=0),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this._content.scale9Grid=null,this._content.fillMode=egret.BitmapFillMode.SCALE,this._content.texture=t},enumerable:!0,configurable:!0}),i.prototype.createDisplayObject=function(){this._content=new egret.Bitmap,this._content.$owner=this,this._content.touchEnabled=!1,this.setDisplayObject(this._content)},i.prototype.dispose=function(){e.prototype.dispose.call(this)},i.prototype.constructFromResource=function(){this.sourceWidth=this.packageItem.width,this.sourceHeight=this.packageItem.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this._content.scale9Grid=this.packageItem.scale9Grid,this._content.smoothing=this.packageItem.smoothing,this.packageItem.scaleByTile&&(this._content.fillMode=egret.BitmapFillMode.REPEAT),this.setSize(this.sourceWidth,this.sourceHeight),this.packageItem.load(),this._content.texture=this.packageItem.texture},i.prototype.handleXYChanged=function(){e.prototype.handleXYChanged.call(this),this._flip!=t.FlipType.None&&(-1==this._content.scaleX&&(this._content.x+=this.width),-1==this._content.scaleY&&(this._content.y+=this.height))},i.prototype.handleSizeChanged=function(){this._content.width=this.width,this._content.height=this.height},i.prototype.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var n;(n=i.attributes.color)&&(this.color=t.ToolSet.convertFromHtmlColor(n)),(n=i.attributes.flip)&&(this.flip=t.parseFlipType(n))},i}(t.GObject);t.GImage=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){return e.call(this)||this}return Object.defineProperty(i.prototype,"icon",{get:function(){if(null!=this._iconObject)return this._iconObject.icon},set:function(t){null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._titleObject?this._titleObject.text:null},set:function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.title},set:function(t){this.title=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{get:function(){return this._titleObject instanceof t.GTextField?this._titleObject.color:this._titleObject instanceof i?this._titleObject.titleColor:this._titleObject instanceof t.GButton?this._titleObject.titleColor:0},set:function(e){this._titleObject instanceof t.GTextField?this._titleObject.color=e:this._titleObject instanceof i?this._titleObject.titleColor=e:this._titleObject instanceof t.GButton&&(this._titleObject.titleColor=e),this.updateGear(4)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this.titleColor},set:function(t){this.titleColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleFontSize",{get:function(){return this._titleObject instanceof t.GTextField?this._titleObject.fontSize:this._titleObject instanceof i?this._titleObject.titleFontSize:this._titleObject instanceof t.GButton?this._titleObject.titleFontSize:0},set:function(e){this._titleObject instanceof t.GTextField?this._titleObject.fontSize=e:this._titleObject instanceof i?this._titleObject.titleFontSize=e:this._titleObject instanceof t.GButton&&(this._titleObject.titleFontSize=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editable",{get:function(){return!!(this._titleObject&&this._titleObject instanceof t.GTextInput)&&this._titleObject.asTextInput.editable},set:function(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)},enumerable:!0,configurable:!0}),i.prototype.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},i.prototype.setup_afterAdd=function(i){if(e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"Label")){var n;(n=i.attributes.title)&&(this.text=n),(n=i.attributes.icon)&&(this.icon=n),(n=i.attributes.titleColor)&&(this.titleColor=t.ToolSet.convertFromHtmlColor(n)),(n=i.attributes.titleFontSize)&&(this.titleFontSize=parseInt(n)),this._titleObject instanceof t.GTextInput&&((n=i.attributes.prompt)&&(this._titleObject.promptText=n),(n=i.attributes.maxLength)&&(this._titleObject.maxLength=parseInt(n)),(n=i.attributes.restrict)&&(this._titleObject.restrict=n),(n=i.attributes.password)&&(this._titleObject.password="true"==n))}},i}(t.GComponent);t.GLabel=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(n,e);function n(){var i=e.call(this)||this;return i.scrollItemToViewOnClick=!0,i.foldInvisibleItems=!1,i._lineCount=0,i._columnCount=0,i._lineGap=0,i._columnGap=0,i._lastSelectedIndex=0,i._numItems=0,i._realNumItems=0,i._firstIndex=0,i._curLineItemCount=0,i._curLineItemCount2=0,i._virtualListChanged=0,i._trackBounds=!0,i._pool=new t.GObjectPool,i._layout=t.ListLayoutType.SingleColumn,i._autoResizeItem=!0,i._lastSelectedIndex=-1,i._selectionMode=t.ListSelectionMode.Single,i.opaque=!0,i._align=t.AlignType.Left,i._verticalAlign=t.VertAlignType.Top,i._container=new egret.DisplayObjectContainer,i._rootContainer.addChild(i._container),i}return n.prototype.dispose=function(){this._pool.clear(),e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"layout",{get:function(){return this._layout},set:function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineCount",{get:function(){return this._lineCount},set:function(t){this._lineCount!=t&&(this._lineCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnCount",{get:function(){return this._columnCount},set:function(t){this._columnCount!=t&&(this._columnCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineGap",{get:function(){return this._lineGap},set:function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnGap",{get:function(){return this._columnGap},set:function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"virtualItemSize",{get:function(){return this._itemSize},set:function(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new egret.Point),this._itemSize.copyFrom(t),this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"defaultItem",{get:function(){return this._defaultItem},set:function(t){this._defaultItem=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"autoResizeItem",{get:function(){return this._autoResizeItem},set:function(t){this._autoResizeItem!=t&&(this._autoResizeItem=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionMode",{get:function(){return this._selectionMode},set:function(t){this._selectionMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionController",{get:function(){return this._selectionController},set:function(t){this._selectionController=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"itemPool",{get:function(){return this._pool},enumerable:!0,configurable:!0}),n.prototype.getFromPool=function(t){void 0===t&&(t=null),t||(t=this._defaultItem);var e=this._pool.getObject(t);return null!=e&&(e.visible=!0),e},n.prototype.returnToPool=function(t){t.displayObject.cacheAsBitmap=!1,this._pool.returnObject(t)},n.prototype.addChildAt=function(i,n){if(void 0===n&&(n=0),e.prototype.addChildAt.call(this,i,n),i instanceof t.GButton){var s=i;s.selected=!1,s.changeStateOnClick=!1}return i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__clickItem,this),i},n.prototype.addItem=function(e){return void 0===e&&(e=null),e||(e=this._defaultItem),this.addChild(t.UIPackage.createObjectFromURL(e))},n.prototype.addItemFromPool=function(t){return void 0===t&&(t=null),this.addChild(this.getFromPool(t))},n.prototype.removeChildAt=function(t,i){void 0===i&&(i=!1);var n=e.prototype.removeChildAt.call(this,t,i);return n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__clickItem,this),n},n.prototype.removeChildToPoolAt=function(t){void 0===t&&(t=0);var i=e.prototype.removeChildAt.call(this,t);this.returnToPool(i)},n.prototype.removeChildToPool=function(t){e.prototype.removeChild.call(this,t),this.returnToPool(t)},n.prototype.removeChildrenToPool=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),(e<0||e>=this._children.length)&&(e=this._children.length-1);for(var i=t;i<=e;++i)this.removeChildToPoolAt(t)},Object.defineProperty(n.prototype,"selectedIndex",{get:function(){var e;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];if(i.obj instanceof t.GButton&&i.obj.selected||null==i.obj&&i.selected)return this._loop?e%this._numItems:e}else{var n=this._children.length;for(e=0;e<n;e++){var s=this._children[e].asButton;if(null!=s&&s.selected)return e}}return-1},set:function(e){e>=0&&e<this.numItems?(this._selectionMode!=t.ListSelectionMode.Single&&this.clearSelection(),this.addSelection(e)):this.clearSelection()},enumerable:!0,configurable:!0}),n.prototype.getSelection=function(){var e,i=new Array;if(this._virtual)for(e=0;e<this._realNumItems;e++){var n=this._virtualItems[e];if(n.obj instanceof t.GButton&&n.obj.selected||null==n.obj&&n.selected){if(this._loop&&(e%=this._numItems,-1!=i.indexOf(e)))continue;i.push(e)}}else{var s=this._children.length;for(e=0;e<s;e++){var r=this._children[e].asButton;null!=r&&r.selected&&i.push(e)}}return i},n.prototype.addSelection=function(e,i){if(void 0===i&&(i=!1),this._selectionMode!=t.ListSelectionMode.None){this.checkVirtualList(),this._selectionMode==t.ListSelectionMode.Single&&this.clearSelection(),i&&this.scrollToView(e),this._lastSelectedIndex=e;var n=null;if(this._virtual){var s=this._virtualItems[e];null!=s.obj&&(n=s.obj.asButton),s.selected=!0}else n=this.getChildAt(e).asButton;null==n||n.selected||(n.selected=!0,this.updateSelectionController(e))}},n.prototype.removeSelection=function(e){if(this._selectionMode!=t.ListSelectionMode.None){var i=null;if(this._virtual){var n=this._virtualItems[e];null!=n.obj&&(i=n.obj.asButton),n.selected=!1}else i=this.getChildAt(e).asButton;null!=i&&(i.selected=!1)}},n.prototype.clearSelection=function(){var e;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];i.obj instanceof t.GButton&&(i.obj.selected=!1),i.selected=!1}else{var n=this._children.length;for(e=0;e<n;e++){var s=this._children[e].asButton;null!=s&&(s.selected=!1)}}},n.prototype.clearSelectionExcept=function(e){var i;if(this._virtual)for(i=0;i<this._realNumItems;i++){var n=this._virtualItems[i];n.obj!=e&&(n.obj instanceof t.GButton&&(n.obj.selected=!1),n.selected=!1)}else{var s=this._children.length;for(i=0;i<s;i++){var r=this._children[i].asButton;null!=r&&r!=e&&(r.selected=!1)}}},n.prototype.selectAll=function(){this.checkVirtualList();var e,i=-1;if(this._virtual)for(e=0;e<this._realNumItems;e++){var n=this._virtualItems[e];n.obj instanceof t.GButton&&!n.obj.selected&&(n.obj.selected=!0,i=e),n.selected=!0}else{var s=this._children.length;for(e=0;e<s;e++){var r=this._children[e].asButton;null==r||r.selected||(r.selected=!0,i=e)}}-1!=i&&this.updateSelectionController(i)},n.prototype.selectNone=function(){this.clearSelection()},n.prototype.selectReverse=function(){this.checkVirtualList();var e,i=-1;if(this._virtual)for(e=0;e<this._realNumItems;e++){var n=this._virtualItems[e];n.obj instanceof t.GButton&&(n.obj.selected=!n.obj.selected,n.obj.selected&&(i=e)),n.selected=!n.selected}else{var s=this._children.length;for(e=0;e<s;e++){var r=this._children[e].asButton;null!=r&&(r.selected=!r.selected,r.selected&&(i=e))}}-1!=i&&this.updateSelectionController(i)},n.prototype.handleArrowKey=function(e){void 0===e&&(e=0);var i=this.selectedIndex;if(-1!=i)switch(e){case 1:if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowVertical)--i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination){for(var n=this._children[i],s=0,r=i-1;r>=0;r--){var o=this._children[r];if(o.y!=n.y){n=o;break}s++}for(;r>=0;r--)if((o=this._children[r]).y!=n.y){this.clearSelection(),this.addSelection(r+s+1,!0);break}}break;case 3:if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination)++i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowVertical){n=this._children[i],s=0;var a=this._children.length;for(r=i+1;r<a;r++){if((o=this._children[r]).x!=n.x){n=o;break}s++}for(;r<a;r++)if((o=this._children[r]).x!=n.x){this.clearSelection(),this.addSelection(r-s-1,!0);break}}break;case 5:if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowVertical)++i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination){for(n=this._children[i],s=0,a=this._children.length,r=i+1;r<a;r++){if((o=this._children[r]).y!=n.y){n=o;break}s++}for(;r<a;r++)if((o=this._children[r]).y!=n.y){this.clearSelection(),this.addSelection(r-s-1,!0);break}}break;case 7:if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination)--i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowVertical){for(n=this._children[i],s=0,r=i-1;r>=0;r--){if((o=this._children[r]).x!=n.x){n=o;break}s++}for(;r>=0;r--)if((o=this._children[r]).x!=n.x){this.clearSelection(),this.addSelection(r+s+1,!0);break}}}},n.prototype.__clickItem=function(e){if(null==this._scrollPane||!this._scrollPane.isDragged){var i=e.currentTarget;this.setSelectionOnEvent(i),this._scrollPane&&this.scrollItemToViewOnClick&&this._scrollPane.scrollToView(i,!0);var n=new t.ItemEvent(t.ItemEvent.CLICK,i);n.stageX=e.stageX,n.stageY=e.stageY,this.dispatchEvent(n)}},n.prototype.setSelectionOnEvent=function(e){if(e instanceof t.GButton&&this._selectionMode!=t.ListSelectionMode.None){var i=!1,n=e,s=this.childIndexToItemIndex(this.getChildIndex(e));if(this._selectionMode==t.ListSelectionMode.Single)n.selected||(this.clearSelectionExcept(n),n.selected=!0);else if(t.GRoot.shiftKeyDown){if(!n.selected)if(-1!=this._lastSelectedIndex){var r=Math.min(this._lastSelectedIndex,s),o=Math.max(this._lastSelectedIndex,s);o=Math.min(o,this.numItems-1);var a;if(this._virtual)for(a=r;a<=o;a++){var h=this._virtualItems[a];h.obj instanceof t.GButton&&(h.obj.selected=!0),h.selected=!0}else for(a=r;a<=o;a++){var l=this.getChildAt(a).asButton;null!=l&&(l.selected=!0)}i=!0}else n.selected=!0}else t.GRoot.ctrlKeyDown||this._selectionMode==t.ListSelectionMode.Multiple_SingleClick?n.selected=!n.selected:n.selected?this.clearSelectionExcept(n):(this.clearSelectionExcept(n),n.selected=!0);i||(this._lastSelectedIndex=s),n.selected&&this.updateSelectionController(s)}},n.prototype.resizeToFit=function(e,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===i&&(i=0),this.ensureBoundsCorrect();var n=this.numItems;if(e>n&&(e=n),this._virtual){var s=Math.ceil(e/this._curLineItemCount);this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=s*this._itemSize.y+Math.max(0,s-1)*this._lineGap:this.viewWidth=s*this._itemSize.x+Math.max(0,s-1)*this._columnGap}else if(0==e)this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=i:this.viewWidth=i;else{for(var r=e-1,o=null;r>=0&&(o=this.getChildAt(r),this.foldInvisibleItems&&!o.visible);)r--;if(r<0)this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=i:this.viewWidth=i;else{var a=0;this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?((a=o.y+o.height)<i&&(a=i),this.viewHeight=a):((a=o.x+o.width)<i&&(a=i),this.viewWidth=a)}}},n.prototype.getMaxItemWidth=function(){for(var t=this._children.length,e=0,i=0;i<t;i++){var n=this.getChildAt(i);n.width>e&&(e=n.width)}return e},n.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)},n.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)},n.prototype.updateSelectionController=function(t){if(null!=this._selectionController&&!this._selectionController.changing&&t<this._selectionController.pageCount){var e=this._selectionController;this._selectionController=null,e.selectedIndex=t,this._selectionController=e}},n.prototype.getSnappingPosition=function(i,s,r){if(this._virtual){r||(r=new egret.Point);var o,a;return this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(o=s,n.pos_param=s,a=this.getIndexOnPos1(!1),s=n.pos_param,a<this._virtualItems.length&&o-s>this._virtualItems[a].height/2&&a<this._realNumItems&&(s+=this._virtualItems[a].height+this._lineGap)):this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical?(o=i,n.pos_param=i,a=this.getIndexOnPos2(!1),i=n.pos_param,a<this._virtualItems.length&&o-i>this._virtualItems[a].width/2&&a<this._realNumItems&&(i+=this._virtualItems[a].width+this._columnGap)):(o=i,n.pos_param=i,a=this.getIndexOnPos3(!1),i=n.pos_param,a<this._virtualItems.length&&o-i>this._virtualItems[a].width/2&&a<this._realNumItems&&(i+=this._virtualItems[a].width+this._columnGap)),r.x=i,r.y=s,r}return e.prototype.getSnappingPosition.call(this,i,s,r)},n.prototype.scrollToView=function(e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),this._virtual){if(0==this._numItems)return;if(this.checkVirtualList(),e>=this._virtualItems.length)throw"Invalid child index: "+e+">"+this._virtualItems.length;this._loop&&(e=Math.floor(this._firstIndex/this._numItems)*this._numItems+e);var s,r,o=this._virtualItems[e],a=0;if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(r=0;r<e;r+=this._curLineItemCount)a+=this._virtualItems[r].height+this._lineGap;s=new egret.Rectangle(0,a,this._itemSize.x,o.height)}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(r=0;r<e;r+=this._curLineItemCount)a+=this._virtualItems[r].width+this._columnGap;s=new egret.Rectangle(a,0,o.width,this._itemSize.y)}else{var h=e/(this._curLineItemCount*this._curLineItemCount2);s=new egret.Rectangle(h*this.viewWidth+e%this._curLineItemCount*(o.width+this._columnGap),e/this._curLineItemCount%this._curLineItemCount2*(o.height+this._lineGap),o.width,o.height)}n=!0,null!=this._scrollPane&&this._scrollPane.scrollToView(s,i,n)}else{var l=this.getChildAt(e);null!=l&&(null!=this._scrollPane?this._scrollPane.scrollToView(l,i,n):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(l,i,n))}},n.prototype.getFirstChildInView=function(){return this.childIndexToItemIndex(e.prototype.getFirstChildInView.call(this))},n.prototype.childIndexToItemIndex=function(e){if(!this._virtual)return e;if(this._layout==t.ListLayoutType.Pagination){for(var i=this._firstIndex;i<this._realNumItems;i++)if(null!=this._virtualItems[i].obj&&--e<0)return i;return e}return e+=this._firstIndex,this._loop&&this._numItems>0&&(e%=this._numItems),e},n.prototype.itemIndexToChildIndex=function(e){if(!this._virtual)return e;if(this._layout==t.ListLayoutType.Pagination)return this.getChildIndex(this._virtualItems[e].obj);if(this._loop&&this._numItems>0){var i=this._firstIndex%this._numItems;e=e>=i?this._firstIndex+(e-i):this._firstIndex+this._numItems+(i-e)}else e-=this._firstIndex;return e},n.prototype.setVirtual=function(){this._setVirtual(!1)},n.prototype.setVirtualAndLoop=function(){this._setVirtual(!0)},n.prototype._setVirtual=function(e){if(!this._virtual){if(null==this._scrollPane)throw"Virtual list must be scrollable!";if(e){if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.FlowVertical)throw"Loop list is not supported for FlowHorizontal or FlowVertical layout!";this._scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=e,this._virtualItems=new Array,this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new egret.Point;var i=this.getFromPool(null);if(null==i)throw"Virtual List must have a default list item resource.";this._itemSize.x=i.width,this._itemSize.y=i.height,this.returnToPool(i)}this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this._scrollPane.scrollSpeed=this._itemSize.y:this._scrollPane.scrollSpeed=this._itemSize.x,this._scrollPane.addEventListener(t.ScrollPane.SCROLL,this.__scrolled,this),this.setVirtualListChangedFlag(!0)}},Object.defineProperty(n.prototype,"numItems",{get:function(){return this._virtual?this._numItems:this._children.length},set:function(e){if(this._virtual){if(null==this.itemRenderer)throw"Set itemRenderer first!";this._numItems=e,this._loop?this._realNumItems=5*this._numItems:this._realNumItems=this._numItems;var n=this._virtualItems.length;if(this._realNumItems>n)for(o=n;o<this._realNumItems;o++){var s=new i;s.width=this._itemSize.x,s.height=this._itemSize.y,this._virtualItems.push(s)}else for(o=this._realNumItems;o<n;o++)this._virtualItems[o].selected=!1;0!=this._virtualListChanged&&t.GTimers.inst.remove(this._refreshVirtualList,this),this._refreshVirtualList()}else{var r=this._children.length;if(e>r)for(var o=r;o<e;o++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.call(this.callbackThisObj,o));else this.removeChildrenToPool(e,r);if(null!=this.itemRenderer)for(o=0;o<e;o++)this.itemRenderer.call(this.callbackThisObj,o,this.getChildAt(o))}},enumerable:!0,configurable:!0}),n.prototype.refreshVirtualList=function(){this.setVirtualListChangedFlag(!1)},n.prototype.checkVirtualList=function(){0!=this._virtualListChanged&&(this._refreshVirtualList(),t.GTimers.inst.remove(this._refreshVirtualList,this))},n.prototype.setVirtualListChangedFlag=function(e){void 0===e&&(e=!1),e?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),t.GTimers.inst.callLater(this._refreshVirtualList,this)},n.prototype._refreshVirtualList=function(){var e=2==this._virtualListChanged;this._virtualListChanged=0,this._eventLocked=!0,e&&(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.SingleRow?this._curLineItemCount=1:this._layout==t.ListLayoutType.FlowHorizontal?this._columnCount>0?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):this._layout==t.ListLayoutType.FlowVertical?this._lineCount>0?this._curLineItemCount=this._lineCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(this._columnCount>0?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),this._lineCount>0?this._curLineItemCount2=this._lineCount:(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1))));var i=0,n=0;if(this._realNumItems>0){var s,r=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount,o=Math.min(this._curLineItemCount,this._realNumItems);if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(s=0;s<r;s+=this._curLineItemCount)i+=this._virtualItems[s].height+this._lineGap;if(i>0&&(i-=this._lineGap),this._autoResizeItem)n=this._scrollPane.viewWidth;else{for(s=0;s<o;s++)n+=this._virtualItems[s].width+this._columnGap;n>0&&(n-=this._columnGap)}}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(s=0;s<r;s+=this._curLineItemCount)n+=this._virtualItems[s].width+this._columnGap;if(n>0&&(n-=this._columnGap),this._autoResizeItem)i=this.scrollPane.viewHeight;else{for(s=0;s<o;s++)i+=this._virtualItems[s].height+this._lineGap;i>0&&(i-=this._lineGap)}}else{n=Math.ceil(r/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,i=this.viewHeight}}this.handleAlign(n,i),this._scrollPane.setContentSize(n,i),this._eventLocked=!1,this.handleScroll(!0)},n.prototype.__scrolled=function(t){this.handleScroll(!1)},n.prototype.getIndexOnPos1=function(t){if(this._realNumItems<this._curLineItemCount)return n.pos_param=0,0;var e,i,s;if(this.numChildren>0&&!t){if((i=this.getChildAt(0).y)>n.pos_param){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if((i-=this._virtualItems[e].height+this._lineGap)<=n.pos_param)return n.pos_param=i,e;return n.pos_param=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if((s=i+this._virtualItems[e].height+this._lineGap)>n.pos_param)return n.pos_param=i,e;i=s}return n.pos_param=i,this._realNumItems-this._curLineItemCount}for(i=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if((s=i+this._virtualItems[e].height+this._lineGap)>n.pos_param)return n.pos_param=i,e;i=s}return n.pos_param=i,this._realNumItems-this._curLineItemCount},n.prototype.getIndexOnPos2=function(t){if(this._realNumItems<this._curLineItemCount)return n.pos_param=0,0;var e,i,s;if(this.numChildren>0&&!t){if((i=this.getChildAt(0).x)>n.pos_param){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if((i-=this._virtualItems[e].width+this._columnGap)<=n.pos_param)return n.pos_param=i,e;return n.pos_param=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if((s=i+this._virtualItems[e].width+this._columnGap)>n.pos_param)return n.pos_param=i,e;i=s}return n.pos_param=i,this._realNumItems-this._curLineItemCount}for(i=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if((s=i+this._virtualItems[e].width+this._columnGap)>n.pos_param)return n.pos_param=i,e;i=s}return n.pos_param=i,this._realNumItems-this._curLineItemCount},n.prototype.getIndexOnPos3=function(t){if(this._realNumItems<this._curLineItemCount)return n.pos_param=0,0;var e,i,s=this.viewWidth,r=Math.floor(n.pos_param/s),o=r*(this._curLineItemCount*this._curLineItemCount2),a=r*s;for(e=0;e<this._curLineItemCount;e++){if((i=a+this._virtualItems[o+e].width+this._columnGap)>n.pos_param)return n.pos_param=a,o+e;a=i}return n.pos_param=a,o+this._curLineItemCount-1},n.prototype.handleScroll=function(e){if(!this._eventLocked){var i,n;this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(this._loop&&(i=this._scrollPane.scrollingPosY,n=this._numItems*(this._itemSize.y+this._lineGap),0==i?this._scrollPane.posY=n:i==this._scrollPane.contentHeight-this._scrollPane.viewHeight&&(this._scrollPane.posY=this._scrollPane.contentHeight-n-this.viewHeight)),this.handleScroll1(e)):this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical?(this._loop&&(i=this._scrollPane.scrollingPosX,n=this._numItems*(this._itemSize.x+this._columnGap),0==i?this._scrollPane.posX=n:i==this._scrollPane.contentWidth-this._scrollPane.viewWidth&&(this._scrollPane.posX=this._scrollPane.contentWidth-n-this.viewWidth)),this.handleScroll2(e)):(this._loop&&(i=this._scrollPane.scrollingPosX,n=Math.floor(this._numItems/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,0==i?this._scrollPane.posX=n:i==this._scrollPane.contentWidth-this._scrollPane.viewWidth&&(this._scrollPane.posX=this._scrollPane.contentWidth-n-this.viewWidth)),this.handleScroll3(e)),this._boundsChanged=!1}},n.prototype.handleScroll1=function(e){if(!(++n.enterCounter>3)){var i=this._scrollPane.scrollingPosY,s=i+this._scrollPane.viewHeight,r=s==this._scrollPane.contentHeight;n.pos_param=i;var o=this.getIndexOnPos1(e);if(i=n.pos_param,o!=this._firstIndex||e){var a=this._firstIndex;this._firstIndex=o;var h,l,c,u,_,p=o,d=a>o,g=this.numChildren,f=a+g-1,y=d?f:a,b=0,m=i,v=0,w=0,C=this.defaultItem,x=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount;for(n.itemInfoVer++;p<this._realNumItems&&(r||m<s);){if((null==(l=this._virtualItems[p]).obj||e)&&(null!=this.itemProvider&&(null==(C=this.itemProvider.call(this.callbackThisObj,p%this._numItems))&&(C=this._defaultItem),C=t.UIPackage.normalizeURL(C)),null!=l.obj&&l.obj.resourceURL!=C&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null)),null==l.obj){if(d){for(_=y;_>=a;_--)if(null!=(c=this._virtualItems[_]).obj&&c.updateFlag!=n.itemInfoVer&&c.obj.resourceURL==C){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,_==y&&y--;break}}else for(_=y;_<=f;_++)if(null!=(c=this._virtualItems[_]).obj&&c.updateFlag!=n.itemInfoVer&&c.obj.resourceURL==C){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,_==y&&y++;break}null!=l.obj?this.setChildIndex(l.obj,d?p-o:this.numChildren):(l.obj=this._pool.getObject(C),d?this.addChildAt(l.obj,p-o):this.addChild(l.obj)),l.obj instanceof t.GButton&&(l.obj.selected=l.selected),h=!0}else h=e;h&&(this._autoResizeItem&&(this._layout==t.ListLayoutType.SingleColumn||this._columnCount>0)&&l.obj.setSize(x,l.obj.height,!0),this.itemRenderer.call(this.callbackThisObj,p%this._numItems,l.obj),p%this._curLineItemCount==0&&(v+=Math.ceil(l.obj.height)-l.height,p==o&&a>o&&(w=Math.ceil(l.obj.height)-l.height)),l.width=Math.ceil(l.obj.width),l.height=Math.ceil(l.obj.height)),l.updateFlag=n.itemInfoVer,l.obj.setXY(b,m),p==o&&(s+=l.height),b+=l.width+this._columnGap,p%this._curLineItemCount==this._curLineItemCount-1&&(b=0,m+=l.height+this._lineGap),p++}for(u=0;u<g;u++)(l=this._virtualItems[a+u]).updateFlag!=n.itemInfoVer&&null!=l.obj&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null);0==v&&0==w||this._scrollPane.changeContentSizeOnScrolling(0,v,0,w),p>0&&this.numChildren>0&&this._container.y<0&&this.getChildAt(0).y>-this._container.y&&this.handleScroll1(!1),n.enterCounter--}else n.enterCounter--}},n.prototype.handleScroll2=function(e){if(!(++n.enterCounter>3)){var i=this._scrollPane.scrollingPosX,s=i+this._scrollPane.viewWidth,r=i==this._scrollPane.contentWidth;n.pos_param=i;var o=this.getIndexOnPos2(e);if(i=n.pos_param,o!=this._firstIndex||e){var a=this._firstIndex;this._firstIndex=o;var h,l,c,u,_,p=o,d=a>o,g=this.numChildren,f=a+g-1,y=d?f:a,b=i,m=0,v=0,w=0,C=this.defaultItem,x=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount-1))/this._curLineItemCount;for(n.itemInfoVer++;p<this._realNumItems&&(r||b<s);){if((null==(l=this._virtualItems[p]).obj||e)&&(null!=this.itemProvider&&(null==(C=this.itemProvider.call(this.callbackThisObj,p%this._numItems))&&(C=this._defaultItem),C=t.UIPackage.normalizeURL(C)),null!=l.obj&&l.obj.resourceURL!=C&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null)),null==l.obj){if(d){for(_=y;_>=a;_--)if(null!=(c=this._virtualItems[_]).obj&&c.updateFlag!=n.itemInfoVer&&c.obj.resourceURL==C){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,_==y&&y--;break}}else for(_=y;_<=f;_++)if(null!=(c=this._virtualItems[_]).obj&&c.updateFlag!=n.itemInfoVer&&c.obj.resourceURL==C){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,_==y&&y++;break}null!=l.obj?this.setChildIndex(l.obj,d?p-o:this.numChildren):(l.obj=this._pool.getObject(C),d?this.addChildAt(l.obj,p-o):this.addChild(l.obj)),l.obj instanceof t.GButton&&(l.obj.selected=l.selected),h=!0}else h=e;h&&(this._autoResizeItem&&(this._layout==t.ListLayoutType.SingleRow||this._lineCount>0)&&l.obj.setSize(l.obj.width,x,!0),this.itemRenderer.call(this.callbackThisObj,p%this._numItems,l.obj),p%this._curLineItemCount==0&&(v+=Math.ceil(l.obj.width)-l.width,p==o&&a>o&&(w=Math.ceil(l.obj.width)-l.width)),l.width=Math.ceil(l.obj.width),l.height=Math.ceil(l.obj.height)),l.updateFlag=n.itemInfoVer,l.obj.setXY(b,m),p==o&&(s+=l.width),m+=l.height+this._lineGap,p%this._curLineItemCount==this._curLineItemCount-1&&(m=0,b+=l.width+this._columnGap),p++}for(u=0;u<g;u++)(l=this._virtualItems[a+u]).updateFlag!=n.itemInfoVer&&null!=l.obj&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null);0==v&&0==w||this._scrollPane.changeContentSizeOnScrolling(v,0,w,0),p>0&&this.numChildren>0&&this._container.x<0&&this.getChildAt(0).x>-this._container.x&&this.handleScroll2(!1),n.enterCounter--}else n.enterCounter--}},n.prototype.handleScroll3=function(e){var i=this._scrollPane.scrollingPosX;n.pos_param=i;var s=this.getIndexOnPos3(e);if(i=n.pos_param,s!=this._firstIndex||e){var r=this._firstIndex;this._firstIndex=s;var o,a,h,l,c,u=r,_=this._virtualItems.length,p=this._curLineItemCount*this._curLineItemCount2,d=s%this._curLineItemCount,g=this.viewWidth,f=Math.floor(s/p)*p,y=f+2*p,b=this._defaultItem,m=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount,v=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount2-1))/this._curLineItemCount2;for(n.itemInfoVer++,a=f;a<y;a++)if(!(a>=this._realNumItems)){if(c=a%this._curLineItemCount,a-f<p){if(c<d)continue}else if(c>d)continue;(h=this._virtualItems[a]).updateFlag=n.itemInfoVer}var w=null,C=0;for(a=f;a<y;a++)if(!(a>=this._realNumItems)&&(h=this._virtualItems[a]).updateFlag==n.itemInfoVer){if(null==h.obj){for(;u<_;){if(null!=(l=this._virtualItems[u]).obj&&l.updateFlag!=n.itemInfoVer){l.obj instanceof t.GButton&&(l.selected=l.obj.selected),h.obj=l.obj,l.obj=null;break}u++}-1==C&&(C=this.getChildIndex(w)+1),null==h.obj?(null!=this.itemProvider&&(null==(b=this.itemProvider(a%this._numItems))&&(b=this._defaultItem),b=t.UIPackage.normalizeURL(b)),h.obj=this._pool.getObject(b),this.addChildAt(h.obj,C)):C=this.setChildIndexBefore(h.obj,C),C++,h.obj instanceof t.GButton&&(h.obj.selected=h.selected),o=!0}else o=e,C=-1,w=h.obj;o&&(this._autoResizeItem&&(this._curLineItemCount==this._columnCount&&this._curLineItemCount2==this._lineCount?h.obj.setSize(m,v,!0):this._curLineItemCount==this._columnCount?h.obj.setSize(m,h.obj.height,!0):this._curLineItemCount2==this._lineCount&&h.obj.setSize(h.obj.width,v,!0)),this.itemRenderer.call(this.callbackThisObj,a%this._numItems,h.obj),h.width=Math.ceil(h.obj.width),h.height=Math.ceil(h.obj.height))}var x=f/p*g,O=x,I=0,T=0;for(a=f;a<y;a++)a>=this._realNumItems||((h=this._virtualItems[a]).updateFlag==n.itemInfoVer&&h.obj.setXY(O,I),h.height>T&&(T=h.height),a%this._curLineItemCount==this._curLineItemCount-1?(O=x,I+=T+this._lineGap,T=0,a==f+p-1&&(O=x+=g,I=0)):O+=h.width+this._columnGap);for(a=u;a<_;a++)(h=this._virtualItems[a]).updateFlag!=n.itemInfoVer&&null!=h.obj&&(h.obj instanceof t.GButton&&(h.selected=h.obj.selected),this.removeChildToPool(h.obj),h.obj=null)}},n.prototype.handleAlign=function(e,i){var n=0,s=0;i<this.viewHeight&&(this._verticalAlign==t.VertAlignType.Middle?s=Math.floor((this.viewHeight-i)/2):this._verticalAlign==t.VertAlignType.Bottom&&(s=this.viewHeight-i)),e<this.viewWidth&&(this._align==t.AlignType.Center?n=Math.floor((this.viewWidth-e)/2):this._align==t.AlignType.Right&&(n=this.viewWidth-e)),n==this._alignOffset.x&&s==this._alignOffset.y||(this._alignOffset.setTo(n,s),null!=this._scrollPane?this._scrollPane.adjustMaskContainer():(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y))},n.prototype.updateBounds=function(){if(!this._virtual){var e,i,n=0,s=0,r=0,o=0,a=0,h=0,l=0,c=0,u=0,_=this._children.length,p=this.viewWidth,d=this.viewHeight,g=0,f=0,y=0;if(this._layout==t.ListLayoutType.SingleColumn){for(e=0;e<_;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=s&&(s+=this._lineGap),i.y=s,this._autoResizeItem&&i.setSize(p,i.height,!0),s+=Math.ceil(i.height),i.width>r&&(r=i.width));a=Math.ceil(r),h=s}else if(this._layout==t.ListLayoutType.SingleRow){for(e=0;e<_;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=n&&(n+=this._columnGap),i.x=n,this._autoResizeItem&&i.setSize(i.width,d,!0),n+=Math.ceil(i.width),i.height>o&&(o=i.height));a=n,h=Math.ceil(o)}else if(this._layout==t.ListLayoutType.FlowHorizontal)if(this._autoResizeItem&&this._columnCount>0){for(e=0;e<_;e++)if(i=this.getChildAt(e),(!this.foldInvisibleItems||i.visible)&&(g+=i.sourceWidth,++l==this._columnCount||e==_-1)){for(y=(p-g-(l-1)*this._columnGap)/g,n=0,l=f;l<=e;l++)i=this.getChildAt(l),this.foldInvisibleItems&&!i.visible||(i.setXY(n,s),l<e?(i.setSize(i.sourceWidth+Math.round(i.sourceWidth*y),i.height,!0),n+=Math.ceil(i.width)+this._columnGap):i.setSize(p-n,i.height,!0),i.height>o&&(o=i.height));s+=Math.ceil(o)+this._lineGap,o=0,l=0,f=e+1,g=0}h=s+Math.ceil(o),a=p}else{for(e=0;e<_;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=n&&(n+=this._columnGap),(0!=this._columnCount&&l>=this._columnCount||0==this._columnCount&&n+i.width>p&&0!=o)&&(n=0,s+=Math.ceil(o)+this._lineGap,o=0,l=0),i.setXY(n,s),(n+=Math.ceil(i.width))>r&&(r=n),i.height>o&&(o=i.height),l++);h=s+Math.ceil(o),a=Math.ceil(r)}else if(this._layout==t.ListLayoutType.FlowVertical)if(this._autoResizeItem&&this._lineCount>0){for(e=0;e<_;e++)if(i=this.getChildAt(e),(!this.foldInvisibleItems||i.visible)&&(g+=i.sourceHeight,++l==this._lineCount||e==_-1)){for(y=(d-g-(l-1)*this._lineGap)/g,s=0,l=f;l<=e;l++)i=this.getChildAt(l),this.foldInvisibleItems&&!i.visible||(i.setXY(n,s),l<e?(i.setSize(i.width,i.sourceHeight+Math.round(i.sourceHeight*y),!0),s+=Math.ceil(i.height)+this._lineGap):i.setSize(i.width,d-s,!0),i.width>r&&(r=i.width));n+=Math.ceil(r)+this._columnGap,r=0,l=0,f=e+1,g=0}a=n+Math.ceil(r),h=d}else{for(e=0;e<_;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=s&&(s+=this._lineGap),(0!=this._lineCount&&l>=this._lineCount||0==this._lineCount&&s+i.height>d&&0!=r)&&(s=0,n+=Math.ceil(r)+this._columnGap,r=0,l=0),i.setXY(n,s),(s+=Math.ceil(i.height))>o&&(o=s),i.width>r&&(r=i.width),l++);a=n+Math.ceil(r),h=Math.ceil(o)}else{var b;if(this._autoResizeItem&&this._lineCount>0&&(b=Math.floor((d-(this._lineCount-1)*this._lineGap)/this._lineCount)),this._autoResizeItem&&this._columnCount>0){for(e=0;e<_;e++)if(i=this.getChildAt(e),(!this.foldInvisibleItems||i.visible)&&(g+=i.sourceWidth,++l==this._columnCount||e==_-1)){for(y=(p-g-(l-1)*this._columnGap)/g,n=0,l=f;l<=e;l++)i=this.getChildAt(l),this.foldInvisibleItems&&!i.visible||(i.setXY(c*p+n,s),l<e?(i.setSize(i.sourceWidth+Math.round(i.sourceWidth*y),this._lineCount>0?b:i.height,!0),n+=Math.ceil(i.width)+this._columnGap):i.setSize(p-n,this._lineCount>0?b:i.height,!0),i.height>o&&(o=i.height));s+=Math.ceil(o)+this._lineGap,o=0,l=0,f=e+1,g=0,u++,(0!=this._lineCount&&u>=this._lineCount||0==this._lineCount&&s+i.height>d)&&(c++,s=0,u=0)}}else for(e=0;e<_;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=n&&(n+=this._columnGap),this._autoResizeItem&&this._lineCount>0&&i.setSize(i.width,b,!0),(0!=this._columnCount&&l>=this._columnCount||0==this._columnCount&&n+i.width>p&&0!=o)&&(n=0,s+=Math.ceil(o)+this._lineGap,o=0,l=0,u++,(0!=this._lineCount&&u>=this._lineCount||0==this._lineCount&&s+i.height>d&&0!=r)&&(c++,s=0,u=0)),i.setXY(c*p+n,s),(n+=Math.ceil(i.width))>r&&(r=n),i.height>o&&(o=i.height),l++);h=c>0?d:s+Math.ceil(o),a=(c+1)*p}this.handleAlign(a,h),this.setBounds(0,0,a,h)}},n.prototype.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var n,s;(n=i.attributes.layout)&&(this._layout=t.parseListLayoutType(n));var r;if(r=(n=i.attributes.overflow)?t.parseOverflowType(n):t.OverflowType.Visible,(n=i.attributes.margin)&&this._margin.parse(n),(n=i.attributes.align)&&(this._align=t.parseAlignType(n)),(n=i.attributes.vAlign)&&(this._verticalAlign=t.parseVertAlignType(n)),r==t.OverflowType.Scroll){var o;o=(n=i.attributes.scroll)?t.parseScrollType(n):t.ScrollType.Vertical;var a;a=(n=i.attributes.scrollBar)?t.parseScrollBarDisplayType(n):t.ScrollBarDisplayType.Default;var h;h=(n=i.attributes.scrollBarFlags)?parseInt(n):0;var l=new t.Margin;(n=i.attributes.scrollBarMargin)&&l.parse(n);var c,u;(n=i.attributes.scrollBarRes)&&(c=(s=n.split(","))[0],u=s[1]),this.setupScroll(l,o,a,h,c,u)}else this.setupOverflow(r);(n=i.attributes.lineGap)&&(this._lineGap=parseInt(n)),(n=i.attributes.colGap)&&(this._columnGap=parseInt(n)),(n=i.attributes.lineItemCount)&&(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination?this._columnCount=parseInt(n):this._layout==t.ListLayoutType.FlowVertical&&(this._lineCount=parseInt(n))),(n=i.attributes.lineItemCount2)&&(this._lineCount=parseInt(n)),(n=i.attributes.selectionMode)&&(this._selectionMode=t.parseListSelectionMode(n)),(n=i.attributes.defaultItem)&&(this._defaultItem=n),n=i.attributes.autoItemSize,this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.SingleColumn?this._autoResizeItem="false"!=n:this._autoResizeItem="true"==n;var _=i.children;if(_)for(var p=_.length,d=0;d<p;d++){var g=_[d];if("item"==g.name){var f=g.attributes.url;if(f||(f=this._defaultItem),f){var y=this.getFromPool(f);null!=y&&(this.addChild(y),(n=g.attributes.title)&&(y.text=n),(n=g.attributes.icon)&&(y.icon=n),(n=g.attributes.name)&&(y.name=n))}}}},n.prototype.setup_afterAdd=function(t){e.prototype.setup_afterAdd.call(this,t);var i;(i=t.attributes.selectionController)&&(this._selectionController=this.parent.getController(i))},n.itemInfoVer=0,n.enterCounter=0,n}(t.GComponent);t.GList=e;var i=function(){return function(){this.width=0,this.height=0,this.updateFlag=0,this.selected=!1}}()}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._frame=0,i._color=0,i._contentSourceWidth=0,i._contentSourceHeight=0,i._contentWidth=0,i._contentHeight=0,i._playing=!0,i._url="",i._fill=t.LoaderFillType.None,i._align=t.AlignType.Left,i._verticalAlign=t.VertAlignType.Top,i._showErrorSign=!0,i._color=16777215,i._gearAnimation=new t.GearAnimation(i),i._gearColor=new t.GearColor(i),i}return i.prototype.createDisplayObject=function(){this._container=new t.UIContainer,this._container.$owner=this,this._container.hitArea=new egret.Rectangle,this.setDisplayObject(this._container)},i.prototype.dispose=function(){if(null==this._contentItem&&this._content instanceof egret.Bitmap){var t=this._content.texture;null!=t&&this.freeExternal(t)}e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._url},set:function(t){this.url=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill!=t&&(this._fill=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"playing",{get:function(){return this._playing},set:function(e){this._playing!=e&&(this._playing=e,this._content instanceof t.MovieClip&&(this._content.playing=e),this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame!=e&&(this._frame=e,this._content instanceof t.MovieClip&&(this._content.currentFrame=e),this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.applyColor())},enumerable:!0,configurable:!0}),i.prototype.applyColor=function(){},Object.defineProperty(i.prototype,"showErrorSign",{get:function(){return this._showErrorSign},set:function(t){this._showErrorSign=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this._content instanceof egret.Bitmap?this._content.texture:null},set:function(t){this.url=null,this.switchToMovieMode(!1),this._content.texture=t,null!=t?(this._contentSourceWidth=t.textureWidth,this._contentSourceHeight=t.textureHeight):this._contentSourceWidth=this._contentHeight=0,this.updateLayout()},enumerable:!0,configurable:!0}),i.prototype.loadContent=function(){this.clearContent(),this._url&&(t.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},i.prototype.loadFromPackage=function(e){if(this._contentItem=t.UIPackage.getItemByURL(e),null!=this._contentItem)if(this._contentItem.load(),this._autoSize&&this.setSize(this._contentItem.width,this._contentItem.height),this._contentItem.type==t.PackageItemType.Image)if(null==this._contentItem.texture)this.setErrorState();else{this.switchToMovieMode(!1);var i=this._content;i.texture=this._contentItem.texture,i.scale9Grid=this._contentItem.scale9Grid,this._contentItem.scaleByTile?i.fillMode=egret.BitmapFillMode.REPEAT:i.fillMode=egret.BitmapFillMode.SCALE,this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this.updateLayout()}else if(this._contentItem.type==t.PackageItemType.MovieClip){this.switchToMovieMode(!0),this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height;var n=this._content;n.interval=this._contentItem.interval,n.swing=this._contentItem.swing,n.repeatDelay=this._contentItem.repeatDelay,n.frames=this._contentItem.frames,this.updateLayout()}else this.setErrorState();else this.setErrorState()},i.prototype.switchToMovieMode=function(e){e?this._content instanceof t.MovieClip||(this._content=new t.MovieClip):this._content instanceof egret.Bitmap||(this._content=new egret.Bitmap),this._container.addChild(this._content)},i.prototype.loadExternal=function(){t.Resource.getResAsync(this._url,this.__getResCompleted,this)},i.prototype.freeExternal=function(t){},i.prototype.onExternalLoadSuccess=function(t){this.url&&(this._content instanceof egret.Bitmap?this._container.addChild(this._content):(this._content=new egret.Bitmap,this._container.addChild(this._content)),this._content.texture=t,this._content.scale9Grid=null,this._content.fillMode=egret.BitmapFillMode.SCALE,this._contentSourceWidth=t.textureWidth,this._contentSourceHeight=t.textureHeight,this.updateLayout())},i.prototype.onExternalLoadFailed=function(){this.setErrorState()},i.prototype.__getResCompleted=function(t,e){t instanceof egret.Texture?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()},i.prototype.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=t.UIConfig.loaderErrorSign&&(this._errorSign=i._errorSignPool.getObject(t.UIConfig.loaderErrorSign)),null!=this._errorSign&&(this._errorSign.setSize(this.width,this.height),this._container.addChild(this._errorSign.displayObject)))},i.prototype.clearErrorState=function(){null!=this._errorSign&&(this._container.removeChild(this._errorSign.displayObject),i._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},i.prototype.updateLayout=function(){if(null!=this._content){if(this._content.x=0,this._content.y=0,this._content.scaleX=1,this._content.scaleY=1,this._contentWidth=this._contentSourceWidth,this._contentHeight=this._contentSourceHeight,!this._autoSize||(this._updatingLayout=!0,0==this._contentWidth&&(this._contentWidth=50),0==this._contentHeight&&(this._contentHeight=30),this.setSize(this._contentWidth,this._contentHeight),this._updatingLayout=!1,this._contentWidth!=this._width||this._contentHeight!=this._height)){var e=1,i=1;this._fill!=t.LoaderFillType.None&&(e=this.width/this._contentSourceWidth,i=this.height/this._contentSourceHeight,1==e&&1==i||(this._fill==t.LoaderFillType.ScaleMatchHeight?e=i:this._fill==t.LoaderFillType.ScaleMatchWidth?i=e:this._fill==t.LoaderFillType.Scale&&(e>i?e=i:i=e),this._contentWidth=this._contentSourceWidth*e,this._contentHeight=this._contentSourceHeight*i)),this._content instanceof egret.Bitmap?(this._content.width=this._contentWidth,this._content.height=this._contentHeight):(this._content.scaleX=e,this._content.scaleY=i),this._align==t.AlignType.Center?this._content.x=Math.floor((this.width-this._contentWidth)/2):this._align==t.AlignType.Right&&(this._content.x=this.width-this._contentWidth),this._verticalAlign==t.VertAlignType.Middle?this._content.y=Math.floor((this.height-this._contentHeight)/2):this._verticalAlign==t.VertAlignType.Bottom&&(this._content.y=this.height-this._contentHeight)}}else this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1)},i.prototype.clearContent=function(){if(this.clearErrorState(),null!=this._content&&null!=this._content.parent&&this._container.removeChild(this._content),null==this._contentItem&&this._content instanceof egret.Bitmap){var t=this._content.texture;null!=t&&this.freeExternal(t)}this._contentItem=null},i.prototype.handleSizeChanged=function(){this._updatingLayout||this.updateLayout(),this._container.hitArea.setTo(0,0,this.width,this.height)},i.prototype.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var n;(n=i.attributes.url)&&(this._url=n),(n=i.attributes.align)&&(this._align=t.parseAlignType(n)),(n=i.attributes.vAlign)&&(this._verticalAlign=t.parseVertAlignType(n)),(n=i.attributes.fill)&&(this._fill=t.parseLoaderFillType(n)),this._autoSize="true"==i.attributes.autoSize,(n=i.attributes.errorSign)&&(this._showErrorSign="true"==n),this._playing="false"!=i.attributes.playing,(n=i.attributes.color)&&(this.color=t.ToolSet.convertFromHtmlColor(n)),this._url&&this.loadContent()},i._errorSignPool=new t.GObjectPool,i}(t.GObject);t.GLoader=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._sizeImplType=1,t}return Object.defineProperty(i.prototype,"color",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),i.prototype.createDisplayObject=function(){this._movieClip=new t.MovieClip,this._movieClip.$owner=this,this._movieClip.touchEnabled=!1,this.setDisplayObject(this._movieClip)},Object.defineProperty(i.prototype,"playing",{get:function(){return this._movieClip.playing},set:function(t){this._movieClip.playing!=t&&(this._movieClip.playing=t,this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._movieClip.currentFrame},set:function(t){this._movieClip.currentFrame!=t&&(this._movieClip.currentFrame=t,this.updateGear(5))},enumerable:!0,configurable:!0}),i.prototype.setPlaySettings=function(t,e,i,n,s,r){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===n&&(n=-1),void 0===s&&(s=null),void 0===r&&(r=null),this._movieClip.setPlaySettings(t,e,i,n,s,r)},i.prototype.constructFromResource=function(){this.sourceWidth=this.packageItem.width,this.sourceHeight=this.packageItem.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),this.packageItem.load(),this._movieClip.interval=this.packageItem.interval,this._movieClip.swing=this.packageItem.swing,this._movieClip.repeatDelay=this.packageItem.repeatDelay,this._movieClip.frames=this.packageItem.frames,this._movieClip.smoothing=this.packageItem.smoothing},i.prototype.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var n;(n=i.attributes.frame)&&(this._movieClip.currentFrame=parseInt(n)),n=i.attributes.playing,this._movieClip.playing="false"!=n,(n=i.attributes.color)&&(this.color=t.ToolSet.convertFromHtmlColor(n))},i}(t.GObject);t.GMovieClip=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){this._itemList=new Array,this._objectPool=new Array}return e.prototype.createObject=function(e,i){var n=t.UIPackage.getByName(e);if(!n)throw new Error("package not found: "+e);var s=n.getItemByName(i);if(!s)throw new Error("resource not found: "+i);this.internalCreateObject(s)},e.prototype.createObjectFromURL=function(e){var i=t.UIPackage.getItemByURL(e);if(!i)throw new Error("resource not found: "+e);this.internalCreateObject(i)},e.prototype.cancel=function(){t.GTimers.inst.remove(this.run,this),this._itemList.length=0;var e=this._objectPool.length;if(e>0){for(var i=0;i<e;i++)this._objectPool[i].dispose();this._objectPool.length=0}},e.prototype.internalCreateObject=function(e){this._itemList.length=0,this._objectPool.length=0,this.collectComponentChildren(e),this._itemList.push(new t.DisplayListItem(e,null)),this._index=0,t.GTimers.inst.add(1,0,this.run,this)},e.prototype.collectComponentChildren=function(e){e.owner.getItemAsset(e);for(var i=e.displayList.length,n=0;n<i;n++){var s=e.displayList[n];if(null!=s.packageItem&&s.packageItem.type==t.PackageItemType.Component)this.collectComponentChildren(s.packageItem);else if("list"==s.type){var r=null;s.listItemCount=0;for(var o=s.desc.children,a=o.length,h=0;h<a;h++){var l=o[h];if("item"==l.name){var c=l.attributes.url;if(c||(null==r&&(r=s.desc.attributes.defaultItem),c=r)){var u=t.UIPackage.getItemByURL(c);u&&(u.type==t.PackageItemType.Component&&this.collectComponentChildren(u),this._itemList.push(new t.DisplayListItem(u,null)),s.listItemCount++)}}}}this._itemList.push(s)}},e.prototype.run=function(){for(var e,i,n,s,r=egret.getTimer(),o=t.UIConfig.frameTimeForAsyncUIConstruction,a=this._itemList.length;this._index<a;){if(null!=(i=this._itemList[this._index]).packageItem)(e=t.UIObjectFactory.newObject(i.packageItem)).packageItem=i.packageItem,this._objectPool.push(e),t.UIPackage._constructing++,i.packageItem.type==t.PackageItemType.Component?(n=this._objectPool.length-i.packageItem.displayList.length-1,e.constructFromResource2(this._objectPool,n),this._objectPool.splice(n,i.packageItem.displayList.length)):e.constructFromResource(),t.UIPackage._constructing--;else if(e=t.UIObjectFactory.newObject2(i.type),this._objectPool.push(e),"list"==i.type&&i.listItemCount>0){for(n=this._objectPool.length-i.listItemCount-1,s=0;s<i.listItemCount;s++)e.itemPool.returnObject(this._objectPool[s+n]);this._objectPool.splice(n,i.listItemCount)}if(this._index++,this._index%5==0&&egret.getTimer()-r>=o)return}t.GTimers.inst.remove(this.run,this);var h=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,null!=this.callback&&this.callback.call(this.callbackObj,h)},e}();t.AsyncOperation=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._mode=t.ButtonMode.Common,i._title="",i._icon="",i._sound=t.UIConfig.buttonSound,i._soundVolumeScale=t.UIConfig.buttonSoundVolumeScale,i._pageOption=new t.PageOption,i._changeStateOnClick=!0,i._downEffect=0,i._downEffectValue=.8,i}return Object.defineProperty(i.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIcon",{get:function(){return this._selectedIcon},set:function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.title},set:function(t){this.title=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedTitle",{get:function(){return this._selectedTitle},set:function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{get:function(){return this._titleObject instanceof t.GTextField?this._titleObject.color:this._titleObject instanceof t.GLabel?this._titleObject.titleColor:this._titleObject instanceof i?this._titleObject.titleColor:0},set:function(e){this._titleObject instanceof t.GTextField?this._titleObject.color=e:this._titleObject instanceof t.GLabel?this._titleObject.titleColor=e:this._titleObject instanceof i&&(this._titleObject.titleColor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleFontSize",{get:function(){return this._titleObject instanceof t.GTextField?this._titleObject.fontSize:this._titleObject instanceof t.GLabel?this._titleObject.titleFontSize:this._titleObject instanceof i?this._titleObject.titleFontSize:0},set:function(e){this._titleObject instanceof t.GTextField?this._titleObject.fontSize=e:this._titleObject instanceof t.GLabel?this._titleObject.titleFontSize=e:this._titleObject instanceof i&&(this._titleObject.titleFontSize=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"soundVolumeScale",{get:function(){return this._soundVolumeScale},set:function(t){this._soundVolumeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(e){if(this._mode!=t.ButtonMode.Common&&this._selected!=e){if(this._selected=e,this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this._selected?this.setState(i.SELECTED_DISABLED):this.setState(i.DISABLED):this._selected?this.setState(this._over?i.SELECTED_OVER:i.DOWN):this.setState(this._over?i.OVER:i.UP),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon){var n=this._selected?this._selectedIcon:this._icon;null!=this._iconObject&&(this._iconObject.icon=n)}this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._pageOption.id,this._relatedController._autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):this._mode==t.ButtonMode.Check&&this._relatedController.selectedPageId==this._pageOption.id&&(this._relatedController.oppositePageId=this._pageOption.id))}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mode",{get:function(){return this._mode},set:function(e){this._mode!=e&&(e==t.ButtonMode.Common&&(this.selected=!1),this._mode=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"relatedController",{get:function(){return this._relatedController},set:function(t){t!=this._relatedController&&(this._relatedController=t,this._pageOption.controller=t,this._pageOption.clear())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageOption",{get:function(){return this._pageOption},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"changeStateOnClick",{get:function(){return this._changeStateOnClick},set:function(t){this._changeStateOnClick=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"linkedPopup",{get:function(){return this._linkedPopup},set:function(t){this._linkedPopup=t},enumerable:!0,configurable:!0}),i.prototype.addStateListener=function(e,i){this.addEventListener(t.StateChangeEvent.CHANGED,e,i)},i.prototype.removeStateListener=function(e,i){this.removeEventListener(t.StateChangeEvent.CHANGED,e,i)},i.prototype.fireClick=function(e){void 0===e&&(e=!0),e&&this._mode==t.ButtonMode.Common&&(this.setState(i.OVER),t.GTimers.inst.add(100,1,this.setState,this,i.DOWN),t.GTimers.inst.add(200,1,this.setState,this,i.UP)),this.__click(null)},i.prototype.setState=function(e){if(this._buttonController&&(this._buttonController.selectedPage=e),1==this._downEffect){var n=this.numChildren;if(e==i.DOWN||e==i.SELECTED_OVER||e==i.SELECTED_DISABLED)for(var s=255*this._downEffectValue,r=(s<<16)+(s<<8)+s,o=0;o<n;o++){void 0==(a=this.getChildAt(o)).color||a instanceof t.GTextField||(a.color=r)}else for(o=0;o<n;o++){var a;void 0==(a=this.getChildAt(o)).color||a instanceof t.GTextField||(a.color=16777215)}}else 2==this._downEffect&&(e==i.DOWN||e==i.SELECTED_OVER||e==i.SELECTED_DISABLED?this._downScaled||(this._downScaled=!0,this.setScale(this.scaleX*this._downEffectValue,this.scaleY*this._downEffectValue)):this._downScaled&&(this._downScaled=!1,this.setScale(this.scaleX/this._downEffectValue,this.scaleY/this._downEffectValue)))},i.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._relatedController==t&&(this.selected=this._pageOption.id==t.selectedPageId)},i.prototype.handleGrayedChanged=function(){this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.grayed?this._selected&&this._buttonController.hasPage(i.SELECTED_DISABLED)?this.setState(i.SELECTED_DISABLED):this.setState(i.DISABLED):this._selected?this.setState(i.DOWN):this.setState(i.UP):e.prototype.handleGrayedChanged.call(this)},i.prototype.constructFromXML=function(n){e.prototype.constructFromXML.call(this,n);var s;(s=(n=t.ToolSet.findChildNode(n,"Button")).attributes.mode)&&(this._mode=t.parseButtonMode(s)),null!=(s=n.attributes.sound)&&(this._sound=s),(s=n.attributes.volume)&&(this._soundVolumeScale=parseInt(s)/100),(s=n.attributes.downEffect)&&(this._downEffect="dark"==s?1:"scale"==s?2:0,s=n.attributes.downEffectValue,this._downEffectValue=parseFloat(s),2==this._downEffect&&this.setPivot(.5,.5)),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),null!=this._titleObject&&(this._title=this._titleObject.text),null!=this._iconObject&&(this._icon=this._iconObject.icon),this._mode==t.ButtonMode.Common&&this.setState(i.UP),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mousedown,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__click,this)},i.prototype.setup_afterAdd=function(i){if(e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"Button")){var n;(n=i.attributes.title)&&(this.title=n),(n=i.attributes.icon)&&(this.icon=n),(n=i.attributes.selectedTitle)&&(this.selectedTitle=n),(n=i.attributes.selectedIcon)&&(this.selectedIcon=n),(n=i.attributes.titleColor)&&(this.titleColor=t.ToolSet.convertFromHtmlColor(n)),(n=i.attributes.titleFontSize)&&(this.titleFontSize=parseInt(n)),null!=(n=i.attributes.sound)&&(this._sound=n),(n=i.attributes.volume)&&(this._soundVolumeScale=parseInt(n)/100),n=i.attributes.controller,this._relatedController=n?this._parent.getController(n):null,this._pageOption.id=i.attributes.page,this.selected="true"==i.attributes.checked}},i.prototype.__rollover=function(t){this._buttonController&&this._buttonController.hasPage(i.OVER)&&(this._over=!0,this._down||this.setState(this._selected?i.SELECTED_OVER:i.OVER))},i.prototype.__rollout=function(t){this._buttonController&&this._buttonController.hasPage(i.OVER)&&(this._over=!1,this._down||this.setState(this._selected?i.DOWN:i.UP))},i.prototype.__mousedown=function(e){this._down=!0,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this._mode==t.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.setState(i.SELECTED_DISABLED):this.setState(i.DOWN)),null!=this._linkedPopup&&(this._linkedPopup instanceof t.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))},i.prototype.__mouseup=function(e){this._down&&(t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this._down=!1,this._mode==t.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.setState(i.DISABLED):this._over?this.setState(i.OVER):this.setState(i.UP)))},i.prototype.__click=function(e){if(this._sound){var i=t.UIPackage.getItemByURL(this._sound);if(i){var n=i.owner.getItemAsset(i);n&&t.GRoot.inst.playOneShotSound(n,this._soundVolumeScale)}}this._mode==t.ButtonMode.Check?this._changeStateOnClick&&(this.selected=!this._selected,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))):this._mode==t.ButtonMode.Radio?this._changeStateOnClick&&!this._selected&&(this.selected=!0,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))):this._relatedController&&(this._relatedController.selectedPageId=this._pageOption.id)},i.UP="up",i.DOWN="down",i.OVER="over",i.SELECTED_OVER="selectedOver",i.DISABLED="disabled",i.SELECTED_DISABLED="selectedDisabled",i}(t.GComponent);t.GButton=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._max=0,i._value=0,i._barMaxWidth=0,i._barMaxHeight=0,i._barMaxWidthDelta=0,i._barMaxHeightDelta=0,i._barStartX=0,i._barStartY=0,i._tweenValue=0,i._titleType=t.ProgressTitleType.Percent,i._value=50,i._max=100,i}return Object.defineProperty(i.prototype,"titleType",{get:function(){return this._titleType},set:function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"max",{get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.update(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(t){null!=this._tweener&&(this._tweener.setPaused(!0),this._tweener=null),this._value!=t&&(this._value=t,this.update(this._value))},enumerable:!0,configurable:!0}),i.prototype.tweenValue=function(t,e){var n=this;return this._value!=t?(this._tweener&&this._tweener.setPaused(!0),this._tweenValue=this._value,this._value=t,this._tweener=egret.Tween.get(this,{onChange:this.onUpdateTween,onChangeObj:this}).to({_tweenValue:t},1e3*e,i.easeLinear).call(function(){n._tweener=null},this),this._tweener):null},i.prototype.onUpdateTween=function(){this.update(this._tweenValue)},i.prototype.update=function(e){var i=Math.min(e/this._max,1);if(this._titleObject)switch(this._titleType){case t.ProgressTitleType.Percent:this._titleObject.text=Math.round(100*i)+"%";break;case t.ProgressTitleType.ValueAndMax:this._titleObject.text=Math.round(e)+"/"+Math.round(this._max);break;case t.ProgressTitleType.Value:this._titleObject.text=""+Math.round(e);break;case t.ProgressTitleType.Max:this._titleObject.text=""+Math.round(this._max)}var n=this.width-this._barMaxWidthDelta,s=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=Math.round(n*i),this._barObjectH.x=this._barStartX+(n-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=Math.round(s*i),this._barObjectV.y=this._barStartY+(s-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=Math.round(n*i)),this._barObjectV&&(this._barObjectV.height=Math.round(s*i))),this._aniObject instanceof t.GMovieClip&&(this._aniObject.frame=Math.round(100*i))},i.prototype.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i);var n;(n=(i=t.ToolSet.findChildNode(i,"ProgressBar")).attributes.titleType)&&(this._titleType=t.parseProgressTitleType(n)),this._reverse="true"==i.attributes.reverse,this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},i.prototype.setup_afterAdd=function(i){e.prototype.setup_afterAdd.call(this,i),(i=t.ToolSet.findChildNode(i,"ProgressBar"))&&(this._value=parseInt(i.attributes.value),this._max=parseInt(i.attributes.max)),this.update(this._value)},i.prototype.dispose=function(){this._tweener&&this._tweener.setPaused(!0),e.prototype.dispose.call(this)},i.easeLinear=egret.Ease.getPowIn(1),i}(t.GComponent);t.GProgressBar=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._textField.touchEnabled=!0,t}return i.prototype.updateTextFieldText=function(){this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(this._text)):this._textField.textFlow=(new egret.HtmlTextParser).parser(this._text)},i}(t.GTextField);t.GRichTextField=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return null==i._inst&&(i._inst=t),t.opaque=!1,t._volumeScale=1,t._popupStack=new Array,t._justClosedPopups=new Array,t.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,t.__addedToStage,t),t}return Object.defineProperty(i,"inst",{get:function(){return null==i._inst&&new i,i._inst},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nativeStage",{get:function(){return this._nativeStage},enumerable:!0,configurable:!0}),i.prototype.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},i.prototype.hideWindow=function(t){t.hide()},i.prototype.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},i.prototype.bringToFront=function(e){var i,n=this.numChildren;for(i=null==this._modalLayer.parent||e.modal?n-1:this.getChildIndex(this._modalLayer)-1;i>=0;i--){var s=this.getChildAt(i);if(s==e)return;if(s instanceof t.Window)break}i>=0&&this.setChildIndex(e,i)},i.prototype.showModalWait=function(e){void 0===e&&(e=null),null!=t.UIConfig.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=t.UIPackage.createObjectFromURL(t.UIConfig.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,t.RelationType.Size),this.addChild(this._modalWaitPane),this._modalWaitPane.text=e)},i.prototype.closeModalWait=function(){null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},i.prototype.closeAllExceptModals=function(){for(var e=this._children.slice(),i=e.length,n=0;n<i;n++){var s=e[n];s instanceof t.Window&&!s.modal&&s.hide()}},i.prototype.closeAllWindows=function(){for(var e=this._children.slice(),i=e.length,n=0;n<i;n++){var s=e[n];s instanceof t.Window&&s.hide()}},i.prototype.getTopWindow=function(){for(var e=this.numChildren-1;e>=0;e--){var i=this.getChildAt(e);if(i instanceof t.Window)return i}return null},Object.defineProperty(i.prototype,"modalLayer",{get:function(){return this._modalLayer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasModalWindow",{get:function(){return null!=this._modalLayer.parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"modalWaiting",{get:function(){return this._modalWaitPane&&this._modalWaitPane.inContainer},enumerable:!0,configurable:!0}),i.prototype.showPopup=function(t,e,n){if(void 0===e&&(e=null),void 0===n&&(n=null),this._popupStack.length>0){var s=this._popupStack.indexOf(t);if(-1!=s)for(var r=this._popupStack.length-1;r>=s;r--)this.removeChild(this._popupStack.pop())}this._popupStack.push(t),this.addChild(t),this.adjustModalLayer();var o,a,h=0;e?(o=e.localToRoot(),a=e.width,h=e.height):o=this.globalToLocal(i.mouseX,i.mouseY);var l,c;(l=o.x)+t.width>this.width&&(l=l+a-t.width),c=o.y+h,(null==n&&c+t.height>this.height||0==n)&&(c=o.y-t.height-1)<0&&(c=0,l+=a/2),t.x=l,t.y=c},i.prototype.togglePopup=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)},i.prototype.hidePopup=function(t){if(void 0===t&&(t=null),null!=t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;i>=e;i--)this.closePopup(this._popupStack.pop())}else{for(i=this._popupStack.length-1;i>=0;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}},Object.defineProperty(i.prototype,"hasAnyPopup",{get:function(){return 0!=this._popupStack.length},enumerable:!0,configurable:!0}),i.prototype.closePopup=function(e){null!=e.parent&&(e instanceof t.Window?e.hide():this.removeChild(e))},i.prototype.showTooltips=function(e){if(null==this._defaultTooltipWin){var i=t.UIConfig.tooltipsWin;if(!i)return void console.error("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=t.UIPackage.createObjectFromURL(i)}this._defaultTooltipWin.text=e,this.showTooltipsWin(this._defaultTooltipWin)},i.prototype.showTooltipsWin=function(t,e){void 0===e&&(e=null),this.hideTooltips(),this._tooltipWin=t;var n=0,s=0;null==e?(n=i.mouseX+10,s=i.mouseY+20):(n=e.x,s=e.y);var r=this.globalToLocal(n,s);n=r.x,s=r.y,n+this._tooltipWin.width>this.width&&(n=n-this._tooltipWin.width-1)<0&&(n=10),s+this._tooltipWin.height>this.height&&(s=s-this._tooltipWin.height-1,n-this._tooltipWin.width-1>0&&(n=n-this._tooltipWin.width-1),s<0&&(s=10)),this._tooltipWin.x=n,this._tooltipWin.y=s,this.addChild(this._tooltipWin)},i.prototype.hideTooltips=function(){null!=this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},i.prototype.getObjectUnderPoint=function(e,i){var n=this._nativeStage.$hitTest(e,i);return n?t.ToolSet.displayObjectToGObject(n):null},Object.defineProperty(i.prototype,"focus",{get:function(){return this._focusedObject&&!this._focusedObject.onStage&&(this._focusedObject=null),this._focusedObject},set:function(t){if(t&&(!t.focusable||!t.onStage))throw"invalid focus target";this.setFocus(t)},enumerable:!0,configurable:!0}),i.prototype.setFocus=function(t){this._focusedObject!=t&&(this._focusedObject=t,this.dispatchEventWith(i.FOCUS_CHANGED))},Object.defineProperty(i.prototype,"volumeScale",{get:function(){return this._volumeScale},set:function(t){this._volumeScale=t},enumerable:!0,configurable:!0}),i.prototype.playOneShotSound=function(t,e){void 0===e&&(e=1);var i=this._volumeScale*e;t.play(0,1).volume=i},i.prototype.adjustModalLayer=function(){var e=this.numChildren;null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,e-1);for(var i=e-1;i>=0;i--){var n=this.getChildAt(i);if(n instanceof t.Window&&n.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,i):this.setChildIndexBefore(this._modalLayer,i))}null!=this._modalLayer.parent&&this.removeChild(this._modalLayer)},i.prototype.__addedToStage=function(e){this.displayObject.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this),this._nativeStage=this.displayObject.stage,this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__stageMouseDownCapture,this,!0),this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__stageMouseUpCapture,this,!0),this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__stageMouseMoveCapture,this,!0),this._modalLayer=new t.GGraph,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,0,0,t.UIConfig.modalLayerColor,t.UIConfig.modalLayerAlpha),this._modalLayer.addRelation(this,t.RelationType.Size),this.displayObject.stage.addEventListener(egret.Event.RESIZE,this.__winResize,this),this.__winResize(null)},i.prototype.__stageMouseDownCapture=function(t){i.mouseX=t.stageX,i.mouseY=t.stageY,i.touchDown=!0;for(var e=t.target;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var n=e.$owner;if(n.touchable&&n.focusable){this.setFocus(n);break}}e=e.parent}if(null!=this._tooltipWin&&this.hideTooltips(),this._justClosedPopups.length=0,this._popupStack.length>0){for(e=t.target;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var s=this._popupStack.indexOf(e.$owner);if(-1!=s){for(var r=this._popupStack.length-1;r>s;r--){var o=this._popupStack.pop();this.closePopup(o),this._justClosedPopups.push(o)}return}}e=e.parent}for(r=this._popupStack.length-1;r>=0;r--)o=this._popupStack[r],this.closePopup(o),this._justClosedPopups.push(o);this._popupStack.length=0}},i.prototype.__stageMouseMoveCapture=function(t){i.mouseX=t.stageX,i.mouseY=t.stageY},i.prototype.__stageMouseUpCapture=function(t){i.touchDown=!1},i.prototype.__winResize=function(t){this.setSize(this._nativeStage.stageWidth,this._nativeStage.stageHeight)},i.contentScaleFactor=1,i.FOCUS_CHANGED="FocusChanged",i}(t.GComponent);t.GRoot=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._dragOffset=new egret.Point,t._scrollPerc=0,t}return i.prototype.setScrollPane=function(t,e){this._target=t,this._vertical=e},Object.defineProperty(i.prototype,"displayPerc",{set:function(t){this._vertical?(this._fixedGripSize||(this._grip.height=t*this._bar.height),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=t*this._bar.width),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollPerc",{set:function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minSize",{get:function(){return this._vertical?(null!=this._arrowButton1?this._arrowButton1.height:0)+(null!=this._arrowButton2?this._arrowButton2.height:0):(null!=this._arrowButton1?this._arrowButton1.width:0)+(null!=this._arrowButton2?this._arrowButton2.width:0)},enumerable:!0,configurable:!0}),i.prototype.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i),null!=(i=t.ToolSet.findChildNode(i,"ScrollBar"))&&(this._fixedGripSize="true"==i.attributes.fixedGripSize),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__gripMouseDown,this),this._arrowButton1&&this._arrowButton1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__arrowButton1Click,this),this._arrowButton2&&this._arrowButton2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__arrowButton2Click,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__barMouseDown,this)):console.error("需要定义bar")):console.error("需要定义grip")},i.prototype.__gripMouseDown=function(t){this._bar&&(t.stopPropagation(),this.globalToLocal(t.stageX,t.stageY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y,this._grip.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._grip.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this))},i.prototype.__gripMouseMove=function(t){if(this.onStage){var e=this.globalToLocal(t.stageX,t.stageY,i.sScrollbarHelperPoint);if(this._vertical){var n=e.y-this._dragOffset.y;this._target.setPercY((n-this._bar.y)/(this._bar.height-this._grip.height),!1)}else{var s=e.x-this._dragOffset.x;this._target.setPercX((s-this._bar.x)/(this._bar.width-this._grip.width),!1)}}},i.prototype.__gripMouseUp=function(t){var e=t.currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},i.prototype.__arrowButton1Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},i.prototype.__arrowButton2Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},i.prototype.__barMouseDown=function(t){var e=this._grip.globalToLocal(t.stageX,t.stageY,i.sScrollbarHelperPoint);this._vertical?e.y<0?this._target.scrollUp(4):this._target.scrollDown(4):e.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},i.sScrollbarHelperPoint=new egret.Point,i}(t.GComponent);t.GScrollBar=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._max=0,i._value=0,i._reverse=!1,i._barMaxWidth=0,i._barMaxHeight=0,i._barMaxWidthDelta=0,i._barMaxHeightDelta=0,i._clickPercent=0,i._barStartX=0,i._barStartY=0,i.changeOnClick=!0,i.canDrag=!0,i._titleType=t.ProgressTitleType.Percent,i._value=50,i._max=100,i._clickPos=new egret.Point,i}return Object.defineProperty(i.prototype,"titleType",{get:function(){return this._titleType},set:function(t){this._titleType=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"max",{get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,this.update())},enumerable:!0,configurable:!0}),i.prototype.update=function(){var t=Math.min(this._value/this._max,1);this.updateWidthPercent(t)},i.prototype.updateWidthPercent=function(e){if(this._titleObject)switch(this._titleType){case t.ProgressTitleType.Percent:this._titleObject.text=Math.round(100*e)+"%";break;case t.ProgressTitleType.ValueAndMax:this._titleObject.text=this._value+"/"+this._max;break;case t.ProgressTitleType.Value:this._titleObject.text=""+this._value;break;case t.ProgressTitleType.Max:this._titleObject.text=""+this._max}var i=this.width-this._barMaxWidthDelta,n=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=Math.round(i*e),this._barObjectH.x=this._barStartX+(i-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=Math.round(n*e),this._barObjectV.y=this._barStartY+(n-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=Math.round(i*e)),this._barObjectV&&(this._barObjectV.height=Math.round(n*e)))},i.prototype.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i);var n;(n=(i=t.ToolSet.findChildNode(i,"Slider")).attributes.titleType)&&(this._titleType=t.parseProgressTitleType(n)),this._reverse="true"==i.attributes.reverse,this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y),this._gripObject&&this._gripObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__gripMouseDown,this),this.displayObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__barMouseDown,this)},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},i.prototype.setup_afterAdd=function(i){e.prototype.setup_afterAdd.call(this,i),(i=t.ToolSet.findChildNode(i,"Slider"))&&(this._value=parseInt(i.attributes.value),this._max=parseInt(i.attributes.max)),this.update()},i.prototype.__gripMouseDown=function(t){this.canDrag=!0,t.stopPropagation(),this._clickPos=this.globalToLocal(t.stageX,t.stageY),this._clickPercent=this._value/this._max,this._gripObject.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._gripObject.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},i.prototype.__gripMouseMove=function(e){if(this.canDrag){var n=this.globalToLocal(e.stageX,e.stageY,i.sSilderHelperPoint),s=n.x-this._clickPos.x,r=n.y-this._clickPos.y;this._reverse&&(s=-s,r=-r);var o;(o=this._barObjectH?this._clickPercent+s/this._barMaxWidth:this._clickPercent+r/this._barMaxHeight)>1?o=1:o<0&&(o=0);var a=Math.round(this._max*o);a!=this._value&&(this._value=a,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))),this.updateWidthPercent(o)}},i.prototype.__gripMouseUp=function(t){this._gripObject.displayObject.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._gripObject.displayObject.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},i.prototype.__barMouseDown=function(e){if(this.changeOnClick){var n,s=this._gripObject.globalToLocal(e.stageX,e.stageY,i.sSilderHelperPoint),r=this._value/this._max;this._barObjectH&&(n=(s.x-this._gripObject.width/2)/this._barMaxWidth),this._barObjectV&&(n=(s.y-this._gripObject.height/2)/this._barMaxHeight),this._reverse?r-=n:r+=n,r>1?r=1:r<0&&(r=0);var o=Math.round(this._max*r);o!=this._value&&(this._value=o,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))),this.updateWidthPercent(r)}},i.sSilderHelperPoint=new egret.Point,i}(t.GComponent);t.GSlider=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._visibleItemCount=0,i._selectedIndex=0,i._popupDownward=!0,i._visibleItemCount=t.UIConfig.defaultComboBoxVisibleItemCount,i._itemsUpdated=!0,i._selectedIndex=-1,i._items=[],i._values=[],i}return Object.defineProperty(i.prototype,"text",{get:function(){return this._titleObject?this._titleObject.text:null},set:function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._iconObject?this._iconObject.icon:null},set:function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{get:function(){return this._titleObject instanceof t.GTextField?this._titleObject.color:this._titleObject instanceof t.GLabel?this._titleObject.titleColor:this._titleObject instanceof t.GButton?this._titleObject.titleColor:0},set:function(e){this._titleObject instanceof t.GTextField?this._titleObject.color=e:this._titleObject instanceof t.GLabel?this._titleObject.titleColor=e:this._titleObject instanceof t.GButton&&(this._titleObject.titleColor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibleItemCount",{get:function(){return this._visibleItemCount},set:function(t){this._visibleItemCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"popupDownward",{get:function(){return this._popupDownward},set:function(t){this._popupDownward=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"items",{get:function(){return this._items},set:function(t){t?this._items=t.concat():this._items.length=0,this._items.length>0?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icons",{get:function(){return this._icons},set:function(t){this._icons=t,null!=this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"values",{get:function(){return this._values},set:function(t){t?this._values=t.concat():this._values.length=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.selectedIndex>=0&&this.selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null)),this.updateSelectionController())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._values[this._selectedIndex]},set:function(t){this.selectedIndex=this._values.indexOf(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionController",{get:function(){return this._selectionController},set:function(t){this._selectionController=t},enumerable:!0,configurable:!0}),i.prototype.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},i.prototype.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i),i=t.ToolSet.findChildNode(i,"ComboBox");var n;if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),n=i.attributes.dropdown){if(this.dropdown=t.UIPackage.createObjectFromURL(n),!this.dropdown)return void console.error("下拉框必须为元件");if(this.dropdown.name="this.dropdown",this._list=this.dropdown.getChild("list").asList,null==this._list)return void console.error(this.resourceURL+": 下拉框的弹出元件里必须包含名为list的列表");this._list.addEventListener(t.ItemEvent.CLICK,this.__clickItem,this),this._list.addRelation(this.dropdown,t.RelationType.Width),this._list.removeRelation(this.dropdown,t.RelationType.Height),this.dropdown.addRelation(this._list,t.RelationType.Height),this.dropdown.removeRelation(this._list,t.RelationType.Width),this.dropdown.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__popupWinClosed,this)}this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mousedown,this)},i.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)},i.prototype.updateSelectionController=function(){if(null!=this._selectionController&&!this._selectionController.changing&&this._selectedIndex<this._selectionController.pageCount){var t=this._selectionController;this._selectionController=null,t.selectedIndex=this._selectedIndex,this._selectionController=t}},i.prototype.dispose=function(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),e.prototype.dispose.call(this)},i.prototype.setup_afterAdd=function(i){if(e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"ComboBox")){var n;(n=i.attributes.titleColor)&&(this.titleColor=t.ToolSet.convertFromHtmlColor(n)),(n=i.attributes.visibleItemCount)&&(this._visibleItemCount=parseInt(n));var s=i.children;if(s)for(var r=s.length,o=0;o<r;o++){var a=s[o];"item"==a.name&&(this._items.push(a.attributes.title),this._values.push(a.attributes.value),(n=a.attributes.icon)&&(this._icons||(this._icons=new Array(r)),this._icons[o]=n))}(n=i.attributes.title)?(this.text=n,this._selectedIndex=this._items.indexOf(n)):this._items.length>0?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,(n=i.attributes.icon)&&(this.icon=n),(n=i.attributes.direction)&&("up"==n?this._popupDownward=!1:"auto"==n&&(this._popupDownward=null)),(n=i.attributes.selectionController)&&(this._selectionController=this.parent.getController(n))}},i.prototype.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var e=this._items.length,i=0;i<e;i++){var n=this._list.addItemFromPool();n.name=i<this._values.length?this._values[i]:"",n.text=this._items[i],n.icon=null!=this._icons&&i<this._icons.length?this._icons[i]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width,this.root.togglePopup(this.dropdown,this,this._popupDownward),this.dropdown.parent&&this.setState(t.GButton.DOWN)},i.prototype.__popupWinClosed=function(e){this._over?this.setState(t.GButton.OVER):this.setState(t.GButton.UP)},i.prototype.__clickItem=function(e){t.GTimers.inst.add(100,1,this.__clickItem2,this,this._list.getChildIndex(e.itemObject))},i.prototype.__clickItem2=function(e){this.dropdown.parent instanceof t.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=e,this._selectedIndex>=0?this.text=this._items[this._selectedIndex]:this.text="",this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))},i.prototype.__rollover=function(e){this._over=!0,this._down||this.dropdown&&this.dropdown.parent||this.setState(t.GButton.OVER)},i.prototype.__rollout=function(e){this._over=!1,this._down||this.dropdown&&this.dropdown.parent||this.setState(t.GButton.UP)},i.prototype.__mousedown=function(e){e.target instanceof egret.TextField&&e.target.type==egret.TextFieldType.INPUT||(this._down=!0,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this.dropdown&&this.showDropdown())},i.prototype.__mouseup=function(e){this._down&&(this._down=!1,t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this.dropdown&&!this.dropdown.parent&&(this._over?this.setState(t.GButton.OVER):this.setState(t.GButton.UP)))},i}(t.GComponent);t.GComboBox=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._widthAutoSize=!1,t._heightAutoSize=!1,t.displayObject.touchChildren=!0,t._textField.type=egret.TextFieldType.INPUT,t._textField.addEventListener(egret.Event.CHANGE,t.__textChanged,t),t._textField.addEventListener(egret.FocusEvent.FOCUS_IN,t.__focusIn,t),t._textField.addEventListener(egret.FocusEvent.FOCUS_OUT,t.__focusOut,t),t}return i.prototype.dispose=function(){e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"editable",{get:function(){return this._textField.type==egret.TextFieldType.INPUT},set:function(t){t?(this._textField.type,egret.TextFieldType.INPUT):(this._textField.type,egret.TextFieldType.DYNAMIC)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxLength",{get:function(){return this._textField.maxChars},set:function(t){this._textField.maxChars=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"promptText",{get:function(){return this._promptText},set:function(t){this._promptText=t,this.updateTextFieldText()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"restrict",{get:function(){return this._textField.restrict},set:function(t){this._textField.restrict=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"password",{get:function(){return this._password},set:function(t){this._password!=t&&(this._password=t,this._textField.displayAsPassword=this._password,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateVertAlign())},enumerable:!0,configurable:!0}),i.prototype.updateVertAlign=function(){switch(this._verticalAlign){case t.VertAlignType.Top:this._textField.verticalAlign=egret.VerticalAlign.TOP;break;case t.VertAlignType.Middle:this._textField.verticalAlign=egret.VerticalAlign.MIDDLE;break;case t.VertAlignType.Bottom:this._textField.verticalAlign=egret.VerticalAlign.BOTTOM}},i.prototype.updateTextFieldText=function(){!this._text&&this._promptText?(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(this._promptText))):(this._textField.displayAsPassword=this._password,this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._text))):this._textField.text=this._text)},i.prototype.handleSizeChanged=function(){this._updatingSize||(this._textField.width=Math.ceil(this.width),this._textField.height=Math.ceil(this.height))},i.prototype.setup_beforeAdd=function(t){e.prototype.setup_beforeAdd.call(this,t),this._promptText=t.attributes.prompt;var i=t.attributes.maxLength;null!=i&&(this._textField.maxChars=parseInt(i)),null!=(i=t.attributes.restrict)&&(this._textField.restrict=i),"true"==(i=t.attributes.password)&&(this.password=!0),this.updateVertAlign()},i.prototype.setup_afterAdd=function(i){e.prototype.setup_afterAdd.call(this,i),!this._text&&this._promptText&&(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._promptText))))},i.prototype.__textChanged=function(t){this._text=this._textField.text},i.prototype.__focusIn=function(t){!this._text&&this._promptText&&(this._textField.displayAsPassword=this._password,this._textField.text="")},i.prototype.__focusOut=function(e){this._text=this._textField.text,!this._text&&this._promptText&&(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._promptText))))},i}(t.GTextField);t.GTextInput=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var t=e.call(this)||this;return t._selectedIndex=0,t._previousIndex=0,t.changing=!1,t._pageIds=[],t._pageNames=[],t._selectedIndex=-1,t._previousIndex=-1,t}return Object.defineProperty(i.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){if(this._selectedIndex!=e){if(e>this._pageIds.length-1)throw"index out of bounds: "+e;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=e,this._parent.applyController(this),this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED)),this.changing=!1}},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndex=function(t){if(void 0===t&&(t=0),this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this._parent.applyController(this),this.changing=!1}},Object.defineProperty(i.prototype,"previsousIndex",{get:function(){return this._previousIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedPage",{get:function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},set:function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.selectedIndex=e},enumerable:!0,configurable:!0}),i.prototype.setSelectedPage=function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.setSelectedIndex(e)},Object.defineProperty(i.prototype,"previousPage",{get:function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageCount",{get:function(){return this._pageIds.length},enumerable:!0,configurable:!0}),i.prototype.getPageName=function(t){return void 0===t&&(t=0),this._pageNames[t]},i.prototype.addPage=function(t){void 0===t&&(t=""),this.addPageAt(t,this._pageIds.length)},i.prototype.addPageAt=function(t,e){void 0===e&&(e=0);var n=""+i._nextPageId++;e==this._pageIds.length?(this._pageIds.push(n),this._pageNames.push(t)):(this._pageIds.splice(e,0,n),this._pageNames.splice(e,0,t))},i.prototype.removePage=function(t){var e=this._pageNames.indexOf(t);-1!=e&&(this._pageIds.splice(e,1),this._pageNames.splice(e,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this))},i.prototype.removePageAt=function(t){void 0===t&&(t=0),this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this)},i.prototype.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this._parent.applyController(this)},i.prototype.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},i.prototype.getPageIndexById=function(t){return this._pageIds.indexOf(t)},i.prototype.getPageIdByName=function(t){var e=this._pageNames.indexOf(t);return-1!=e?this._pageIds[e]:null},i.prototype.getPageNameById=function(t){var e=this._pageIds.indexOf(t);return-1!=e?this._pageNames[e]:null},i.prototype.getPageId=function(t){return void 0===t&&(t=0),this._pageIds[t]},Object.defineProperty(i.prototype,"selectedPageId",{get:function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},set:function(t){var e=this._pageIds.indexOf(t);this.selectedIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"oppositePageId",{set:function(t){this._pageIds.indexOf(t)>0?this.selectedIndex=0:this._pageIds.length>1&&(this.selectedIndex=1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"previousPageId",{get:function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]},enumerable:!0,configurable:!0}),i.prototype.runActions=function(){if(this._actions)for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].run(this,this.previousPageId,this.selectedPageId)},i.prototype.setup=function(e){this._name=e.attributes.name,this._autoRadioGroupDepth="true"==e.attributes.autoRadioGroupDepth;var i=0,n=0,s=e.attributes.pages;if(s){var r=s.split(","),o=r.length;for(i=0;i<o;i+=2)this._pageIds.push(r[i]),this._pageNames.push(r[i+1])}var a=e.children,h=a.length;if(h>0){this._actions||(this._actions=new Array);for(var l=0;l<h;l++){var c=a[l],u=t.ControllerAction.createAction(c.attributes.type);u.setup(c),this._actions.push(u)}}if(s=e.attributes.transitions){this._actions||(this._actions=new Array),o=(r=s.split(",")).length;var _;for(i=0;i<o;i++)if(s=r[i]){var p=new t.PlayTransitionAction;n=s.indexOf("="),p.transitionName=s.substr(n+1),n=(s=s.substring(0,n)).indexOf("-"),(_=parseInt(s.substring(n+1)))<this._pageIds.length&&(p.toPage=[this._pageIds[_]]),"*"!=(s=s.substring(0,n))&&(_=parseInt(s))<this._pageIds.length&&(p.fromPage=[this._pageIds[_]]),p.stopOnExit=!0,this._actions.push(p)}}this._parent&&this._pageIds.length>0?this._selectedIndex=0:this._selectedIndex=-1},i._nextPageId=0,i}(egret.EventDispatcher);t.Controller=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){this.left=0,this.right=0,this.top=0,this.bottom=0}return t.prototype.parse=function(t){if(!t)return this.left=0,this.right=0,this.top=0,void(this.bottom=0);var e=t.split(",");if(1==e.length){var i=parseInt(e[0]);this.top=i,this.bottom=i,this.left=i,this.right=i}else this.top=parseInt(e[0]),this.bottom=parseInt(e[1]),this.left=parseInt(e[2]),this.right=parseInt(e[3])},t.prototype.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},t}();t.Margin=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){this.width=0,this.height=0,this.tileGridIndice=0,this.interval=0,this.repeatDelay=0}return t.prototype.load=function(){return this.owner.getItemAsset(this)},t.prototype.toString=function(){return this.name},t}();t.PackageItem=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"controller",{set:function(t){this._controller=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._id?this._controller.getPageIndexById(this._id):-1},set:function(t){this._id=this._controller.getPageId(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._id?this._controller.getPageNameById(this._id):null},set:function(t){this._id=this._controller.getPageIdByName(t)},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._id=null},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!0,configurable:!0}),t}();t.PageOption=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(e){if(void 0===e&&(e=null),!e&&!(e=t.UIConfig.popupMenu))throw"UIConfig.popupMenu not defined";this._contentPane=t.UIPackage.createObjectFromURL(e).asCom,this._contentPane.addEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,t.RelationType.Width),this._list.removeRelation(this._contentPane,t.RelationType.Height),this._contentPane.addRelation(this._list,t.RelationType.Height),this._list.addEventListener(t.ItemEvent.CLICK,this.__clickItem,this)}return e.prototype.dispose=function(){this._contentPane.dispose()},e.prototype.addItem=function(t,e){void 0===e&&(e=null);var i=this._list.addItemFromPool().asButton;i.title=t,i.data=e,i.grayed=!1;var n=i.getController("checked");return null!=n&&(n.selectedIndex=0),i},e.prototype.addItemAt=function(t,e,i){void 0===i&&(i=null);var n=this._list.getFromPool().asButton;this._list.addChildAt(n,e),n.title=t,n.data=i,n.grayed=!1;var s=n.getController("checked");return null!=s&&(s.selectedIndex=0),n},e.prototype.addSeperator=function(){if(null==t.UIConfig.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(t.UIConfig.popupMenu_seperator)},e.prototype.getItemName=function(t){return this._list.getChildAt(t).name},e.prototype.setItemText=function(t,e){this._list.getChild(t).asButton.title=e},e.prototype.setItemVisible=function(t,e){var i=this._list.getChild(t).asButton;i.visible!=e&&(i.visible=e,this._list.setBoundsChangedFlag())},e.prototype.setItemGrayed=function(t,e){this._list.getChild(t).asButton.grayed=e},e.prototype.setItemCheckable=function(t,e){var i=this._list.getChild(t).asButton.getController("checked");null!=i&&(e?0==i.selectedIndex&&(i.selectedIndex=1):i.selectedIndex=0)},e.prototype.setItemChecked=function(t,e){var i=this._list.getChild(t).asButton.getController("checked");null!=i&&(i.selectedIndex=e?2:1)},e.prototype.isItemChecked=function(t){var e=this._list.getChild(t).asButton.getController("checked");return null!=e&&2==e.selectedIndex},e.prototype.removeItem=function(t){var e=this._list.getChild(t);if(null!=e){var i=this._list.getChildIndex(e);return this._list.removeChildToPoolAt(i),!0}return!1},e.prototype.clearItems=function(){this._list.removeChildrenToPool()},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._list.numChildren},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentPane",{get:function(){return this._contentPane},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.show=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null);(null!=e?e.root:t.GRoot.inst).showPopup(this.contentPane,e instanceof t.GRoot?null:e,i)},e.prototype.__clickItem=function(e){t.GTimers.inst.add(100,1,this.__clickItem2,this,e)},e.prototype.__clickItem2=function(t){var e=t.itemObject.asButton;if(null!=e)if(e.grayed)this._list.selectedIndex=-1;else{var i=e.getController("checked");null!=i&&0!=i.selectedIndex&&(1==i.selectedIndex?i.selectedIndex=2:i.selectedIndex=1);this._contentPane.parent.hidePopup(this.contentPane),null!=e.data&&(1==e.data.length?e.data(t):e.data())}},e.prototype.__addedToStage=function(t){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},e}();t.PopupMenu=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(t){this._owner=t,this._defs=new Array}return Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))},enumerable:!0,configurable:!0}),e.prototype.add=function(e,i){if(e==t.RelationType.Size)return this.add(t.RelationType.Width,i),void this.add(t.RelationType.Height,i);for(var n=this._defs.length,s=0;s<n;s++){if(this._defs[s].type==e)return}this.internalAdd(e,i)},e.prototype.internalAdd=function(e,n){if(e==t.RelationType.Size)return this.internalAdd(t.RelationType.Width,n),void this.internalAdd(t.RelationType.Height,n);var s=new i;s.percent=n,s.type=e,this._defs.push(s),(n||e==t.RelationType.Left_Center||e==t.RelationType.Center_Center||e==t.RelationType.Right_Center||e==t.RelationType.Top_Middle||e==t.RelationType.Middle_Middle||e==t.RelationType.Bottom_Middle)&&(this._owner.pixelSnapping=!0)},e.prototype.remove=function(e){if(void 0===e&&(e=0),e==t.RelationType.Size)return this.remove(t.RelationType.Width),void this.remove(t.RelationType.Height);for(var i=this._defs.length,n=0;n<i;n++)if(this._defs[n].type==e){this._defs.splice(n,1);break}},e.prototype.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var e=t._defs.length,n=0;n<e;n++){var s=t._defs[n],r=new i;r.copyFrom(s),this._defs.push(r)}},e.prototype.dispose=function(){null!=this._target&&(this.releaseRefTarget(this._target),this._target=null)},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0==this._defs.length},enumerable:!0,configurable:!0}),e.prototype.applyOnSelfResized=function(e,i){for(var n=this._owner.x,s=this._owner.y,r=this._defs.length,o=0;o<r;o++){switch(this._defs[o].type){case t.RelationType.Center_Center:case t.RelationType.Right_Center:this._owner.x-=e/2;break;case t.RelationType.Right_Left:case t.RelationType.Right_Right:this._owner.x-=e;break;case t.RelationType.Middle_Middle:case t.RelationType.Bottom_Middle:this._owner.y-=i/2;break;case t.RelationType.Bottom_Top:case t.RelationType.Bottom_Bottom:this._owner.y-=i}}if((n!=this._owner.x||s!=this._owner.y)&&(n=this._owner.x-n,s=this._owner.y-s,this._owner.updateGearFromRelations(1,n,s),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(o=0;o<a;++o)this._owner.parent._transitions[o].updateFromRelations(this._owner.id,n,s)}},e.prototype.applyOnXYChanged=function(e,i,n){switch(e.type){case t.RelationType.Left_Left:case t.RelationType.Left_Center:case t.RelationType.Left_Right:case t.RelationType.Center_Center:case t.RelationType.Right_Left:case t.RelationType.Right_Center:case t.RelationType.Right_Right:this._owner.x+=i;break;case t.RelationType.Top_Top:case t.RelationType.Top_Middle:case t.RelationType.Top_Bottom:case t.RelationType.Middle_Middle:case t.RelationType.Bottom_Top:case t.RelationType.Bottom_Middle:case t.RelationType.Bottom_Bottom:this._owner.y+=n;break;case t.RelationType.Width:case t.RelationType.Height:break;case t.RelationType.LeftExt_Left:case t.RelationType.LeftExt_Right:this._owner.x+=i,this._owner.width=this._owner._rawWidth-i;break;case t.RelationType.RightExt_Left:case t.RelationType.RightExt_Right:this._owner.width=this._owner._rawWidth+i;break;case t.RelationType.TopExt_Top:case t.RelationType.TopExt_Bottom:this._owner.y+=n,this._owner.height=this._owner._rawHeight-n;break;case t.RelationType.BottomExt_Top:case t.RelationType.BottomExt_Bottom:this._owner.height=this._owner._rawHeight+n}},e.prototype.applyOnSizeChanged=function(e){var i,n;this._target!=this._owner.parent?(i=this._target.x,n=this._target.y):(i=0,n=0);var s,r;switch(e.type){case t.RelationType.Left_Left:e.percent&&this._target==this._owner.parent&&(s=this._owner.x-i,e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+s);break;case t.RelationType.Left_Center:s=this._owner.x-(i+this._targetWidth/2),e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+this._target._width/2+s;break;case t.RelationType.Left_Right:s=this._owner.x-(i+this._targetWidth),e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+this._target._width+s;break;case t.RelationType.Center_Center:s=this._owner.x+this._owner._rawWidth/2-(i+this._targetWidth/2),e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+this._target._width/2+s-this._owner._rawWidth/2;break;case t.RelationType.Right_Left:s=this._owner.x+this._owner._rawWidth-i,e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+s-this._owner._rawWidth;break;case t.RelationType.Right_Center:s=this._owner.x+this._owner._rawWidth-(i+this._targetWidth/2),e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+this._target._width/2+s-this._owner._rawWidth;break;case t.RelationType.Right_Right:s=this._owner.x+this._owner._rawWidth-(i+this._targetWidth),e.percent&&(s=s/this._targetWidth*this._target._width),this._owner.x=i+this._target._width+s-this._owner._rawWidth;break;case t.RelationType.Top_Top:e.percent&&this._target==this._owner.parent&&(s=this._owner.y-n,e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+s);break;case t.RelationType.Top_Middle:s=this._owner.y-(n+this._targetHeight/2),e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+this._target._height/2+s;break;case t.RelationType.Top_Bottom:s=this._owner.y-(n+this._targetHeight),e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+this._target._height+s;break;case t.RelationType.Middle_Middle:s=this._owner.y+this._owner._rawHeight/2-(n+this._targetHeight/2),e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+this._target._height/2+s-this._owner._rawHeight/2;break;case t.RelationType.Bottom_Top:s=this._owner.y+this._owner._rawHeight-n,e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+s-this._owner._rawHeight;break;case t.RelationType.Bottom_Middle:s=this._owner.y+this._owner._rawHeight-(n+this._targetHeight/2),e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+this._target._height/2+s-this._owner._rawHeight;break;case t.RelationType.Bottom_Bottom:s=this._owner.y+this._owner._rawHeight-(n+this._targetHeight),e.percent&&(s=s/this._targetHeight*this._target._height),this._owner.y=n+this._target._height+s-this._owner._rawHeight;break;case t.RelationType.Width:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target.initWidth:this._owner._rawWidth-this._targetWidth,e.percent&&(s=s/this._targetWidth*this._target._width),this._target==this._owner.parent?this._owner.setSize(this._target._width+s,this._owner._rawHeight,!0):this._owner.width=this._target._width+s;break;case t.RelationType.Height:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target.initHeight:this._owner._rawHeight-this._targetHeight,e.percent&&(s=s/this._targetHeight*this._target._height),this._target==this._owner.parent?this._owner.setSize(this._owner._rawWidth,this._target._height+s,!0):this._owner.height=this._target._height+s;break;case t.RelationType.LeftExt_Left:break;case t.RelationType.LeftExt_Right:s=this._owner.x-(i+this._targetWidth),e.percent&&(s=s/this._targetWidth*this._target._width),r=this._owner.x,this._owner.x=i+this._target._width+s,this._owner.width=this._owner._rawWidth-(this._owner.x-r);break;case t.RelationType.RightExt_Left:break;case t.RelationType.RightExt_Right:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-(i+this._target.initWidth):this._owner.width-(i+this._targetWidth),this._owner!=this._target.parent&&(s+=this._owner.x),e.percent&&(s=s/this._targetWidth*this._target._width),this._owner!=this._target.parent?this._owner.width=i+this._target._width+s-this._owner.x:this._owner.width=i+this._target._width+s;break;case t.RelationType.TopExt_Top:break;case t.RelationType.TopExt_Bottom:s=this._owner.y-(n+this._targetHeight),e.percent&&(s=s/this._targetHeight*this._target._height),r=this._owner.y,this._owner.y=n+this._target._height+s,this._owner.height=this._owner._rawHeight-(this._owner.y-r);break;case t.RelationType.BottomExt_Top:break;case t.RelationType.BottomExt_Bottom:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-(n+this._target.initHeight):this._owner._rawHeight-(n+this._targetHeight),this._owner!=this._target.parent&&(s+=this._owner.y),e.percent&&(s=s/this._targetHeight*this._target._height),this._owner!=this._target.parent?this._owner.height=n+this._target._height+s-this._owner.y:this._owner.height=n+this._target._height+s}},e.prototype.addRefTarget=function(e){e!=this._owner.parent&&e.addEventListener(t.GObject.XY_CHANGED,this.__targetXYChanged,this),e.addEventListener(t.GObject.SIZE_CHANGED,this.__targetSizeChanged,this),e.addEventListener(t.GObject.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._width,this._targetHeight=this._target._height},e.prototype.releaseRefTarget=function(e){e.removeEventListener(t.GObject.XY_CHANGED,this.__targetXYChanged,this),e.removeEventListener(t.GObject.SIZE_CHANGED,this.__targetSizeChanged,this),e.removeEventListener(t.GObject.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this)},e.prototype.__targetXYChanged=function(t){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,void(this._targetY=this._target.y);this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,n=this._target.x-this._targetX,s=this._target.y-this._targetY,r=this._defs.length,o=0;o<r;o++){var a=this._defs[o];this.applyOnXYChanged(a,n,s)}if(this._targetX=this._target.x,this._targetY=this._target.y,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),null!=this._owner.parent)){var h=this._owner.parent._transitions.length;if(h>0)for(o=0;o<h;++o)this._owner.parent._transitions[o].updateFromRelations(this._owner.id,e,i)}this._owner.relations.handling=null},e.prototype.__targetSizeChanged=function(t){if(null==this._owner.relations.handling){this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,n=this._owner._rawWidth,s=this._owner._rawHeight,r=this._defs.length,o=0;o<r;o++){var a=this._defs[o];this.applyOnSizeChanged(a)}if(this._targetWidth=this._target._width,this._targetHeight=this._target._height,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),null!=this._owner.parent)){var h=this._owner.parent._transitions.length;if(h>0)for(o=0;o<h;++o)this._owner.parent._transitions[o].updateFromRelations(this._owner.id,e,i)}n==this._owner._rawWidth&&s==this._owner._rawHeight||(n=this._owner._rawWidth-n,s=this._owner._rawHeight-s,this._owner.updateGearFromRelations(2,n,s)),this._owner.relations.handling=null}},e.prototype.__targetSizeWillChange=function(t){this._owner.relations.sizeDirty=!0},e}();t.RelationItem=e;var i=function(){function t(){}return t.prototype.copyFrom=function(t){this.percent=t.percent,this.type=t.type},t}();t.RelationDef=i}(fairygui||(fairygui={}));!function(t){var e=function(){function e(t){this._owner=t,this._items=new Array}return e.prototype.add=function(e,i,n){void 0===n&&(n=!1);for(var s=this._items.length,r=0;r<s;r++){var o=this._items[r];if(o.target==e)return void o.add(i,n)}var a=new t.RelationItem(this._owner);a.target=e,a.add(i,n),this._items.push(a)},e.prototype.addItems=function(t,i){var n,s,r,o=i.split(",");for(r=0;r<2;r++)if(n=o[r]){"%"==n.charAt(n.length-1)?(n=n.substr(0,n.length-1),s=!0):s=!1;-1==n.indexOf("-")&&(n=n+"-"+n);var a=e.RELATION_NAMES.indexOf(n);if(-1==a)throw"invalid relation type";this.add(t,a,s)}},e.prototype.remove=function(t,e){void 0===e&&(e=0);for(var i=this._items.length,n=0;n<i;){var s=this._items[n];s.target==t?(s.remove(e),s.isEmpty?(s.dispose(),this._items.splice(n,1),i--):n++):n++}},e.prototype.contains=function(t){for(var e=this._items.length,i=0;i<e;i++){if(this._items[i].target==t)return!0}return!1},e.prototype.clearFor=function(t){for(var e=this._items.length,i=0;i<e;){var n=this._items[i];n.target==t?(n.dispose(),this._items.splice(i,1),e--):i++}},e.prototype.clearAll=function(){for(var t=this._items.length,e=0;e<t;e++){this._items[e].dispose()}this._items.length=0},e.prototype.copyFrom=function(e){this.clearAll();for(var i=e._items,n=i.length,s=0;s<n;s++){var r=i[s],o=new t.RelationItem(this._owner);o.copyFrom(r),this._items.push(o)}},e.prototype.dispose=function(){this.clearAll()},e.prototype.onOwnerSizeChanged=function(t,e){if(0!=this._items.length)for(var i=this._items.length,n=0;n<i;n++){this._items[n].applyOnSelfResized(t,e)}},e.prototype.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;e<t;e++){this._items[e].target.ensureSizeCorrect()}}},Object.defineProperty(e.prototype,"empty",{get:function(){return 0==this._items.length},enumerable:!0,configurable:!0}),e.prototype.setup=function(t){var e=t.children;if(e)for(var i,n,s=e.length,r=0;r<s;r++){var o=e[r];"relation"==o.name&&(i=o.attributes.target,(n=this._owner.parent?i?this._owner.parent.getChildById(i):this._owner.parent:this._owner.getChildById(i))&&this.addItems(n,o.attributes.sidePair))}},e.RELATION_NAMES=["left-left","left-center","left-right","center-center","right-left","right-center","right-right","top-top","top-middle","top-bottom","middle-middle","bottom-top","bottom-middle","bottom-bottom","width-width","height-height","leftext-left","leftext-right","rightext-left","rightext-right","topext-top","topext-bottom","bottomext-top","bottomext-bottom"],e}();t.Relations=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){}return t.setCache=function(e){t.assets=e},t.getRes=function(e){return t.assets.getRes(e)},t.getResAsync=function(e,i,n){t.assets.getResAsync(e,i,n)},t}();t.Resource=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(n,e);function n(s,r,o,a,h,l,c){var u=e.call(this)||this;if(u._viewWidth=0,u._viewHeight=0,u._contentWidth=0,u._contentHeight=0,u._scrollType=0,u._scrollSpeed=0,u._mouseWheelSpeed=0,null==n._easeTypeFunc&&(n._easeTypeFunc=egret.Ease.cubicOut),u._throwTween=new i,u._owner=s,u._maskContainer=new egret.DisplayObjectContainer,u._owner._rootContainer.addChild(u._maskContainer),u._container=u._owner._container,u._container.x=0,u._container.y=0,u._maskContainer.addChild(u._container),u._scrollType=r,u._scrollBarMargin=o,u._bouncebackEffect=t.UIConfig.defaultScrollBounceEffect,u._touchEffect=t.UIConfig.defaultScrollTouchEffect,u._scrollSpeed=t.UIConfig.defaultScrollSpeed,u._mouseWheelSpeed=2*u._scrollSpeed,u._displayOnLeft=0!=(1&h),u._snapToItem=0!=(2&h),u._displayInDemand=0!=(4&h),u._pageMode=0!=(8&h),u._touchEffect=!!(16&h)||!(32&h)&&t.UIConfig.defaultScrollTouchEffect,u._bouncebackEffect=!!(64&h)||!(128&h)&&t.UIConfig.defaultScrollBounceEffect,u._inertiaDisabled=0!=(256&h),0==(512&h)&&(u._maskContainer.scrollRect=new egret.Rectangle),u._xPerc=0,u._yPerc=0,u._xPos=0,u._yPos=0,u._xOverlap=0,u._yOverlap=0,u._aniFlag=0,u._scrollBarVisible=!0,u._mouseWheelEnabled=!1,u._holdAreaPoint=new egret.Point,a==t.ScrollBarDisplayType.Default&&(a=t.UIConfig.defaultScrollBarDisplay),a!=t.ScrollBarDisplayType.Hidden){if(u._scrollType==t.ScrollType.Both||u._scrollType==t.ScrollType.Vertical){if(_=l||t.UIConfig.verticalScrollBar){if(u._vtScrollBar=t.UIPackage.createObjectFromURL(_),!u._vtScrollBar)throw"cannot create scrollbar from "+_;u._vtScrollBar.setScrollPane(u,!0),u._owner._rootContainer.addChild(u._vtScrollBar.displayObject)}}if(u._scrollType==t.ScrollType.Both||u._scrollType==t.ScrollType.Horizontal){var _;if(_=c||t.UIConfig.horizontalScrollBar){if(u._hzScrollBar=t.UIPackage.createObjectFromURL(_),!u._hzScrollBar)throw"cannot create scrollbar from "+_;u._hzScrollBar.setScrollPane(u,!1),u._owner._rootContainer.addChild(u._hzScrollBar.displayObject)}}u._scrollBarDisplayAuto=a==t.ScrollBarDisplayType.Auto,u._scrollBarDisplayAuto&&(u._scrollBarVisible=!1,u._vtScrollBar&&(u._vtScrollBar.displayObject.visible=!1),u._hzScrollBar&&(u._hzScrollBar.displayObject.visible=!1))}return u._contentWidth=0,u._contentHeight=0,u.setSize(s.width,s.height),u._owner.addEventListener(egret.TouchEvent.TOUCH_BEGIN,u.__mouseDown,u),u}return Object.defineProperty(n.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bouncebackEffect",{get:function(){return this._bouncebackEffect},set:function(t){this._bouncebackEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"touchEffect",{get:function(){return this._touchEffect},set:function(t){this._touchEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollSpeed",{get:function(){return this._scrollSpeed},set:function(e){this._scrollSpeed=this.scrollSpeed,0==this._scrollSpeed&&(this._scrollSpeed=t.UIConfig.defaultScrollSpeed),this._mouseWheelSpeed=2*this._scrollSpeed},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"snapToItem",{get:function(){return this._snapToItem},set:function(t){this._snapToItem=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"percX",{get:function(){return this._xPerc},set:function(t){this.setPercX(t,!1)},enumerable:!0,configurable:!0}),n.prototype.setPercX=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),(e=t.ToolSet.clamp01(e))!=this._xPerc&&(this._xPerc=e,this._xPos=this._xPerc*this._xOverlap,this.posChanged(i))},Object.defineProperty(n.prototype,"percY",{get:function(){return this._yPerc},set:function(t){this.setPercY(t,!1)},enumerable:!0,configurable:!0}),n.prototype.setPercY=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),(e=t.ToolSet.clamp01(e))!=this._yPerc&&(this._yPerc=e,this._yPos=this._yPerc*this._yOverlap,this.posChanged(i))},Object.defineProperty(n.prototype,"posX",{get:function(){return this._xPos},set:function(t){this.setPosX(t,!1)},enumerable:!0,configurable:!0}),n.prototype.setPosX=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),(e=t.ToolSet.clamp(e,0,this._xOverlap))!=this._xPos&&(this._xPos=e,this._xPerc=0==this._xOverlap?0:this._xPos/this._xOverlap,this.posChanged(i))},Object.defineProperty(n.prototype,"posY",{get:function(){return this._yPos},set:function(t){this.setPosY(t,!1)},enumerable:!0,configurable:!0}),n.prototype.setPosY=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),(e=t.ToolSet.clamp(e,0,this._yOverlap))!=this._yPos&&(this._yPos=e,this._yPerc=0==this._yOverlap?0:this._yPos/this._yOverlap,this.posChanged(i))},Object.defineProperty(n.prototype,"isBottomMost",{get:function(){return 1==this._yPerc||0==this._yOverlap},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isRightMost",{get:function(){return 1==this._xPerc||0==this._xOverlap},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPageX",{get:function(){if(!this._pageMode)return 0;var t=Math.floor(this._xPos/this._pageSizeH);return this._xPos-t*this._pageSizeH>.5*this._pageSizeH&&t++,t},set:function(t){this._pageMode&&this._xOverlap>0&&this.setPosX(t*this._pageSizeH,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPageY",{get:function(){if(!this._pageMode)return 0;var t=Math.floor(this._yPos/this._pageSizeV);return this._yPos-t*this._pageSizeV>.5*this._pageSizeV&&t++,t},set:function(t){this._pageMode&&this._yOverlap>0&&this.setPosY(t*this._pageSizeV,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageController",{get:function(){return this._pageController},set:function(t){this._pageController=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollingPosX",{get:function(){return t.ToolSet.clamp(-this._container.x,0,this._xOverlap)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollingPosY",{get:function(){return t.ToolSet.clamp(-this._container.y,0,this._yOverlap)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"contentWidth",{get:function(){return this._contentWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"contentHeight",{get:function(){return this._contentHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewWidth",{get:function(){return this._viewWidth},set:function(t){t=t+this._owner.margin.left+this._owner.margin.right,null!=this._vtScrollBar&&(t+=this._vtScrollBar.width),this._owner.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewHeight",{get:function(){return this._viewHeight},set:function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,null!=this._hzScrollBar&&(t+=this._hzScrollBar.height),this._owner.height=t},enumerable:!0,configurable:!0}),n.prototype.getDeltaX=function(t){return t/(this._contentWidth-this._viewWidth)},n.prototype.getDeltaY=function(t){return t/(this._contentHeight-this._viewHeight)},n.prototype.scrollTop=function(t){void 0===t&&(t=!1),this.setPercY(0,t)},n.prototype.scrollBottom=function(t){void 0===t&&(t=!1),this.setPercY(1,t)},n.prototype.scrollUp=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercY(this._yPerc-this.getDeltaY(this._scrollSpeed*t),e)},n.prototype.scrollDown=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercY(this._yPerc+this.getDeltaY(this._scrollSpeed*t),e)},n.prototype.scrollLeft=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercX(this._xPerc-this.getDeltaX(this._scrollSpeed*t),e)},n.prototype.scrollRight=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercX(this._xPerc+this.getDeltaX(this._scrollSpeed*t),e)},n.prototype.scrollToView=function(e,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1),this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh();var r;if(e instanceof t.GObject?e.parent!=this._owner?(e.parent.localToGlobalRect(e.x,e.y,e.width,e.height,n.sHelperRect),r=this._owner.globalToLocalRect(n.sHelperRect.x,n.sHelperRect.y,n.sHelperRect.width,n.sHelperRect.height,n.sHelperRect)):(r=n.sHelperRect).setTo(e.x,e.y,e.width,e.height):r=e,this._yOverlap>0){var o=this.posY,a=o+this._viewHeight;s||r.y<o||r.height>=this._viewHeight?this._pageMode?this.setPosY(Math.floor(r.y/this._pageSizeV)*this._pageSizeV,i):this.setPosY(r.y,i):r.y+r.height>a&&(this._pageMode?this.setPosY(Math.floor(r.y/this._pageSizeV)*this._pageSizeV,i):r.height<=this._viewHeight/2?this.setPosY(r.y+2*r.height-this._viewHeight,i):this.setPosY(r.y+r.height-this._viewHeight,i))}if(this._xOverlap>0){var h=this.posX,l=h+this._viewWidth;s||r.x<h||r.width>=this._viewWidth?this._pageMode?this.setPosX(Math.floor(r.x/this._pageSizeH)*this._pageSizeH,i):this.setPosX(r.x,i):r.x+r.width>l&&(this._pageMode?this.setPosX(Math.floor(r.x/this._pageSizeH)*this._pageSizeH,i):r.width<=this._viewWidth/2?this.setPosX(r.x+2*r.width-this._viewWidth,i):this.setPosX(r.x+r.width-this._viewWidth,i))}!i&&this._needRefresh&&this.refresh()},n.prototype.isChildInView=function(t){var e;return!(this._yOverlap>0&&((e=t.y+this._container.y)<-t.height-20||e>this._viewHeight+20))&&!(this._xOverlap>0&&((e=t.x+this._container.x)<-t.width-20||e>this._viewWidth+20))},n.prototype.cancelDragging=function(){this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this),n.draggingPane==this&&(n.draggingPane=null),n._gestureFlag=0,this.isDragged=!1,this._maskContainer.touchChildren=!0},n.prototype.onOwnerSizeChanged=function(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)},n.prototype.handleControllerChanged=function(e){this._pageController==e&&(this._scrollType==t.ScrollType.Horizontal?this.currentPageX=e.selectedIndex:this.currentPageY=e.selectedIndex)},n.prototype.updatePageController=function(){if(null!=this._pageController&&!this._pageController.changing){var e;if((e=this._scrollType==t.ScrollType.Horizontal?this.currentPageX:this.currentPageY)<this._pageController.pageCount){var i=this._pageController;this._pageController=null,i.selectedIndex=e,this._pageController=i}}},n.prototype.adjustMaskContainer=function(){var t,e;t=this._displayOnLeft&&null!=this._vtScrollBar?Math.floor(this._owner.margin.left+this._vtScrollBar.width):Math.floor(this._owner.margin.left),e=Math.floor(this._owner.margin.top),this._maskContainer.x=t,this._maskContainer.y=e,0!=this._owner._alignOffset.x||0!=this._owner._alignOffset.y?(null==this._alignContainer&&(this._alignContainer=new egret.DisplayObjectContainer,this._maskContainer.addChild(this._alignContainer),this._alignContainer.addChild(this._container)),this._alignContainer.x=this._owner._alignOffset.x,this._alignContainer.y=this._owner._alignOffset.y):this._alignContainer&&(this._alignContainer.x=this._alignContainer.y=0)},n.prototype.setSize=function(t,e){this.adjustMaskContainer(),this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar&&!this._vScrollNone?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewWidth=t,this._viewHeight=e,this._hzScrollBar&&!this._hScrollNone&&(this._viewHeight-=this._hzScrollBar.height),this._vtScrollBar&&!this._vScrollNone&&(this._viewWidth-=this._vtScrollBar.width),this._viewWidth-=this._owner.margin.left+this._owner.margin.right,this._viewHeight-=this._owner.margin.top+this._owner.margin.bottom,this._viewWidth=Math.max(1,this._viewWidth),this._viewHeight=Math.max(1,this._viewHeight),this._pageSizeH=this._viewWidth,this._pageSizeV=this._viewHeight,this.handleSizeChanged()},n.prototype.setContentSize=function(t,e){this._contentWidth==t&&this._contentHeight==e||(this._contentWidth=t,this._contentHeight=e,this.handleSizeChanged())},n.prototype.changeContentSizeOnScrolling=function(t,e,i,n){if(this._contentWidth+=t,this._contentHeight+=e,this.isDragged){0!=i&&(this._container.x-=i),0!=n&&(this._container.y-=n),this.validateHolderPos(),this._xOffset+=i,this._yOffset+=n;var s=this._y2-this._y1;this._y1=this._container.y,this._y2=this._y1+s,s=this._x2-this._x1,this._x1=this._container.x,this._x2=this._x1+s,this._yPos=-this._container.y,this._xPos=-this._container.x}else 2==this._tweening&&(0!=i&&(this._container.x-=i,this._throwTween.start.x-=i),0!=n&&(this._container.y-=n,this._throwTween.start.y-=n));this.handleSizeChanged(!0)},n.prototype.handleSizeChanged=function(e){void 0===e&&(e=!1),this._displayInDemand&&(this._vtScrollBar&&(this._contentHeight<=this._viewHeight?this._vScrollNone||(this._vScrollNone=!0,this._viewWidth+=this._vtScrollBar.width):this._vScrollNone&&(this._vScrollNone=!1,this._viewWidth-=this._vtScrollBar.width)),this._hzScrollBar&&(this._contentWidth<=this._viewWidth?this._hScrollNone||(this._hScrollNone=!0,this._viewHeight+=this._hzScrollBar.height):this._hScrollNone&&(this._hScrollNone=!1,this._viewHeight-=this._hzScrollBar.height))),this._vtScrollBar&&(this._viewHeight<this._vtScrollBar.minSize?this._vtScrollBar.displayObject.visible=!1:(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone,0==this._contentHeight?this._vtScrollBar.displayPerc=0:this._vtScrollBar.displayPerc=Math.min(1,this._viewHeight/this._contentHeight))),this._hzScrollBar&&(this._viewWidth<this._hzScrollBar.minSize?this._hzScrollBar.displayObject.visible=!1:(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone,0==this._contentWidth?this._hzScrollBar.displayPerc=0:this._hzScrollBar.displayPerc=Math.min(1,this._viewWidth/this._contentWidth)));var i=this._maskContainer.scrollRect;null!=i&&(i.setTo(0,0,this._viewWidth,this._viewHeight),this._maskContainer.scrollRect=i),this._scrollType==t.ScrollType.Horizontal||this._scrollType==t.ScrollType.Both?this._xOverlap=Math.ceil(Math.max(0,this._contentWidth-this._viewWidth)):this._xOverlap=0,this._scrollType==t.ScrollType.Vertical||this._scrollType==t.ScrollType.Both?this._yOverlap=Math.ceil(Math.max(0,this._contentHeight-this._viewHeight)):this._yOverlap=0,0==this._tweening&&e?(0!=this._xPerc&&1!=this._xPerc||(this._xPos=this._xPerc*this._xOverlap,this._container.x=-this._xPos),0!=this._yPerc&&1!=this._yPerc||(this._yPos=this._yPerc*this._yOverlap,this._container.y=-this._yPos)):(this._xPos=t.ToolSet.clamp(this._xPos,0,this._xOverlap),this._xPerc=this._xOverlap>0?this._xPos/this._xOverlap:0,this._yPos=t.ToolSet.clamp(this._yPos,0,this._yOverlap),this._yPerc=this._yOverlap>0?this._yPos/this._yOverlap:0),this.validateHolderPos(),null!=this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),null!=this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc),this._pageMode&&this.updatePageController()},n.prototype.validateHolderPos=function(){this._container.x=t.ToolSet.clamp(this._container.x,-this._xOverlap,0),this._container.y=t.ToolSet.clamp(this._container.y,-this._yOverlap,0)},n.prototype.posChanged=function(e){0==this._aniFlag?this._aniFlag=e?1:-1:1!=this._aniFlag||e||(this._aniFlag=-1),this._needRefresh=!0,t.GTimers.inst.callLater(this.refresh,this),2==this._tweening&&this.killTween()},n.prototype.killTween=function(){1==this._tweening?(this._tweener.setPaused(!0),this._tweening=0,this._tweener=null,this.syncScrollBar(!0)):2==this._tweening&&(this._tweener.setPaused(!0),this._tweener=null,this._tweening=0,this.validateHolderPos(),this.syncScrollBar(!0),this.dispatchEventWith(n.SCROLL_END,!1))},n.prototype.refresh=function(){if(this._needRefresh=!1,t.GTimers.inst.remove(this.refresh,this),this._pageMode){var e;this._yOverlap>0&&1!=this._yPerc&&0!=this._yPerc&&(e=Math.floor(this._yPos/this._pageSizeV),this._yPos-e*this._pageSizeV>this._pageSizeV/2&&e++,this._yPos=e*this._pageSizeV,this._yPos>this._yOverlap?(this._yPos=this._yOverlap,this._yPerc=1):this._yPerc=this._yPos/this._yOverlap),this._xOverlap>0&&1!=this._xPerc&&0!=this._xPerc&&(e=Math.floor(this._xPos/this._pageSizeH),this._xPos-e*this._pageSizeH>this._pageSizeH/2&&e++,this._xPos=e*this._pageSizeH,this._xPos>this._xOverlap?(this._xPos=this._xOverlap,this._xPerc=1):this._xPerc=this._xPos/this._xOverlap)}else if(this._snapToItem){var i=this._owner.getSnappingPosition(1==this._xPerc?0:this._xPos,1==this._yPerc?0:this._yPos,n.sHelperPoint);1!=this._xPerc&&i.x!=this._xPos&&(this._xPos=i.x,this._xPerc=this._xPos/this._xOverlap,this._xPerc>1&&(this._xPerc=1,this._xPos=this._xOverlap)),1!=this._yPerc&&i.y!=this._yPos&&(this._yPos=i.y,this._yPerc=this._yPos/this._yOverlap,this._yPerc>1&&(this._yPerc=1,this._yPos=this._yOverlap))}this.refresh2(),this.dispatchEventWith(n.SCROLL,!1),this._needRefresh&&(this._needRefresh=!1,t.GTimers.inst.remove(this.refresh,this),this.refresh2()),this._aniFlag=0},n.prototype.refresh2=function(){var t=Math.floor(this._xPos),e=Math.floor(this._yPos);if(1!=this._aniFlag||this.isDragged)null!=this._tweener&&this.killTween(),this.isDragged&&(this._xOffset+=this._container.x- -t,this._yOffset+=this._container.y- -e),this._container.y=-e,this._container.x=-t,this.isDragged&&(this._y1=this._y2=this._container.y,this._x1=this._x2=this._container.x),this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc);else{var i=this._container.x,s=this._container.y;this._yOverlap>0?s=-e:0!=this._container.y&&(this._container.y=0),this._xOverlap>0?i=-t:0!=this._container.x&&(this._container.x=0),i==this._container.x&&s==this._container.y||(null!=this._tweener&&this.killTween(),this._tweening=1,this._maskContainer.touchChildren=!1,this._tweener=egret.Tween.get(this._container,{onChange:this.__tweenUpdate,onChangeObj:this}).to({x:i,y:s},500,n._easeTypeFunc).call(this.__tweenComplete,this))}this._pageMode&&this.updatePageController()},n.prototype.syncPos=function(){this._xOverlap>0&&(this._xPos=t.ToolSet.clamp(-this._container.x,0,this._xOverlap),this._xPerc=this._xPos/this._xOverlap),this._yOverlap>0&&(this._yPos=t.ToolSet.clamp(-this._container.y,0,this._yOverlap),this._yPerc=this._yPos/this._yOverlap),this._pageMode&&this.updatePageController()},n.prototype.syncScrollBar=function(e){void 0===e&&(e=!1),e?(this._vtScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._hzScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._maskContainer.touchChildren=!0):(this._vtScrollBar&&(this._vtScrollBar.scrollPerc=0==this._yOverlap?0:t.ToolSet.clamp(-this._container.y,0,this._yOverlap)/this._yOverlap,this._scrollBarDisplayAuto&&this.showScrollBar(!0)),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=0==this._xOverlap?0:t.ToolSet.clamp(-this._container.x,0,this._xOverlap)/this._xOverlap,this._scrollBarDisplayAuto&&this.showScrollBar(!0)))},n.prototype.__mouseDown=function(t){this._touchEffect&&(null!=this._tweener?(this.killTween(),this.isDragged=!0):this.isDragged=!1,this._maskContainer.globalToLocal(t.stageX,t.stageY,n.sHelperPoint),this._x1=this._x2=this._container.x,this._y1=this._y2=this._container.y,this._xOffset=n.sHelperPoint.x-this._container.x,this._yOffset=n.sHelperPoint.y-this._container.y,this._time1=this._time2=egret.getTimer(),this._holdAreaPoint.x=n.sHelperPoint.x,this._holdAreaPoint.y=n.sHelperPoint.y,this._isHoldAreaDone=!1,this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this))},n.prototype.__touchMove=function(e){if(null!=this._owner.displayObject.stage&&this._touchEffect&&(null==n.draggingPane||n.draggingPane==this)&&null==t.GObject.draggingObject){var i,s,r,o,a=t.UIConfig.touchScrollSensitivity,h=this._maskContainer.globalToLocal(e.stageX,e.stageY,n.sHelperPoint);if(this._scrollType==t.ScrollType.Vertical){if(!this._isHoldAreaDone){if(n._gestureFlag|=1,(i=Math.abs(this._holdAreaPoint.y-h.y))<a)return;if(0!=(2&n._gestureFlag)&&i<Math.abs(this._holdAreaPoint.x-h.x))return}s=!0}else if(this._scrollType==t.ScrollType.Horizontal){if(!this._isHoldAreaDone){if(n._gestureFlag|=2,(i=Math.abs(this._holdAreaPoint.x-h.x))<a)return;if(0!=(1&n._gestureFlag)&&i<Math.abs(this._holdAreaPoint.y-h.y))return}r=!0}else{if(n._gestureFlag=3,!this._isHoldAreaDone&&(i=Math.abs(this._holdAreaPoint.y-h.y))<a&&(i=Math.abs(this._holdAreaPoint.x-h.x))<a)return;s=r=!0}var l=egret.getTimer();if(l-this._time2>50&&(this._time2=this._time1,this._time1=l,o=!0),s){var c=Math.floor(n.sHelperPoint.y-this._yOffset);c>0?!this._bouncebackEffect||this._inertiaDisabled?this._container.y=0:this._container.y=Math.floor(.5*c):c<-this._yOverlap||this._inertiaDisabled?this._bouncebackEffect?this._container.y=Math.floor(.5*(c-this._yOverlap)):this._container.y=-Math.floor(this._yOverlap):this._container.y=c,o&&(this._y2=this._y1,this._y1=this._container.y)}if(r){var u=Math.floor(n.sHelperPoint.x-this._xOffset);u>0?!this._bouncebackEffect||this._inertiaDisabled?this._container.x=0:this._container.x=Math.floor(.5*u):u<0-this._xOverlap||this._inertiaDisabled?this._bouncebackEffect?this._container.x=Math.floor(.5*(u-this._xOverlap)):this._container.x=-Math.floor(this._xOverlap):this._container.x=u,o&&(this._x2=this._x1,this._x1=this._container.x)}n.draggingPane=this,this._maskContainer.touchChildren=!1,this._isHoldAreaDone=!0,this.isDragged=!0,this.syncPos(),this.syncScrollBar(),this.dispatchEventWith(n.SCROLL,!1)}},n.prototype.__touchEnd=function(e){if(e.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),e.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),e.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this),n.draggingPane==this&&(n.draggingPane=null),n._gestureFlag=0,this.isDragged&&this._touchEffect&&!this._inertiaDisabled&&null!=this._owner.displayObject.stage){this.isDragged=!1;var s=(egret.getTimer()-this._time2)/1e3;0==s&&(s=.001);var r=(this._container.y-this._y2)/s*2*t.UIConfig.defaultTouchScrollSpeedRatio,o=(this._container.x-this._x2)/s*2*t.UIConfig.defaultTouchScrollSpeedRatio;this._throwTween.start.x=this._container.x,this._throwTween.start.y=this._container.y;var a,h=this._throwTween.change1,l=this._throwTween.change2,c=0,u=0,_=0,p=0,d=0;if(this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Horizontal?(this._container.x>t.UIConfig.touchDragSensitivity?d=1:this._container.x<-this._xOverlap-t.UIConfig.touchDragSensitivity&&(d=2),h.x=i.calculateChange(o,.3),l.x=0,c=this._container.x+h.x,this._pageMode&&c<0&&c>-this._xOverlap&&(_=Math.floor(-c/this._pageSizeH),a=Math.min(this._pageSizeH,this._contentWidth-(_+1)*this._pageSizeH),p=-c-_*this._pageSizeH,Math.abs(h.x)>this._pageSizeH?p>.5*a&&_++:p>a*(h.x<0?.3:.7)&&_++,(c=-_*this._pageSizeH)<-this._xOverlap&&(c=-this._xOverlap),h.x=c-this._container.x)):h.x=l.x=0,this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Vertical?(this._container.y>t.UIConfig.touchDragSensitivity?d=1:this._container.y<-this._yOverlap-t.UIConfig.touchDragSensitivity&&(d=2),h.y=i.calculateChange(r,.3),l.y=0,u=this._container.y+h.y,this._pageMode&&u<0&&u>-this._yOverlap&&(_=Math.floor(-u/this._pageSizeV),a=Math.min(this._pageSizeV,this._contentHeight-(_+1)*this._pageSizeV),p=-u-_*this._pageSizeV,Math.abs(h.y)>this._pageSizeV?p>.5*a&&_++:p>a*(h.y<0?.3:.7)&&_++,(u=-_*this._pageSizeV)<-this._yOverlap&&(u=-this._yOverlap),h.y=u-this._container.y)):h.y=l.y=0,this._snapToItem&&!this._pageMode){c=-c,u=-u;var g=this._owner.getSnappingPosition(c,u,n.sHelperPoint);c=-g.x,u=-g.y,h.x=c-this._container.x,h.y=u-this._container.y}this._bouncebackEffect?(c>0?l.x=0-this._container.x-h.x:c<-this._xOverlap&&(l.x=-this._xOverlap-this._container.x-h.x),u>0?l.y=0-this._container.y-h.y:u<-this._yOverlap&&(l.y=-this._yOverlap-this._container.y-h.y)):(c>0?h.x=0-this._container.x:c<-this._xOverlap&&(h.x=-this._xOverlap-this._container.x),u>0?h.y=0-this._container.y:u<-this._yOverlap&&(h.y=-this._yOverlap-this._container.y)),this._throwTween.value=0,this._throwTween.change1=h,this._throwTween.change2=l,null!=this._tweener&&this.killTween(),this._tweening=2,this._tweener=egret.Tween.get(this._throwTween,{onChange:this.__tweenUpdate2,onChangeObj:this}).to({value:1},300,n._easeTypeFunc).call(this.__tweenComplete2,this),1==d?this.dispatchEventWith(n.PULL_DOWN_RELEASE):2==d&&this.dispatchEventWith(n.PULL_UP_RELEASE)}},n.prototype.__touchTap=function(t){this.isDragged=!1},n.prototype.__rollOver=function(t){this.showScrollBar(!0)},n.prototype.__rollOut=function(t){this.showScrollBar(!1)},n.prototype.showScrollBar=function(e){e?(this.__showScrollBar(!0),t.GTimers.inst.remove(this.__showScrollBar,this)):t.GTimers.inst.add(500,1,this.__showScrollBar,this,e)},n.prototype.__showScrollBar=function(t){this._scrollBarVisible=t&&this._viewWidth>0&&this._viewHeight>0,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone)},n.prototype.__tweenUpdate=function(){0!=this._tweening&&(this.syncScrollBar(),this.dispatchEventWith(n.SCROLL,!1))},n.prototype.__tweenComplete=function(){this._tweening=0,this._tweener=null,this.validateHolderPos(),this.syncScrollBar(!0),this.dispatchEventWith(n.SCROLL,!1)},n.prototype.__tweenUpdate2=function(){0!=this._tweening&&(this._throwTween.update(this._container),this.syncPos(),this.syncScrollBar(),this.dispatchEventWith(n.SCROLL,!1))},n.prototype.__tweenComplete2=function(){this._tweening=0,this._tweener=null,this.validateHolderPos(),this.syncPos(),this.syncScrollBar(!0),this.dispatchEventWith(n.SCROLL,!1),this.dispatchEventWith(n.SCROLL_END,!1)},n._gestureFlag=0,n.SCROLL="__scroll",n.SCROLL_END="__scrollEnd",n.PULL_DOWN_RELEASE="pullDownRelease",n.PULL_UP_RELEASE="pullUpRelease",n.sHelperRect=new egret.Rectangle,n.sHelperPoint=new egret.Point,n}(egret.EventDispatcher);t.ScrollPane=e;var i=function(){function t(){this.start=new egret.Point,this.change1=new egret.Point,this.change2=new egret.Point}return t.prototype.update=function(t){t.x=Math.floor(this.start.x+this.change1.x*this.value+this.change2.x*this.value*this.value),t.y=Math.floor(this.start.y+this.change1.y*this.value+this.change2.y*this.value*this.value)},t.calculateChange=function(e,i){return i*t.checkpoint*e/t.easeOutCubic(t.checkpoint,0,1,1)},t.easeOutCubic=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},t.checkpoint=.05,t}()}(fairygui||(fairygui={}));!function(t){var e=function(){function e(t){this.autoPlayRepeat=1,this.autoPlayDelay=0,this._ownerBaseX=0,this._ownerBaseY=0,this._totalTimes=0,this._totalTasks=0,this._playing=!1,this._options=0,this._maxTime=0,this._owner=t,this._items=new Array}return Object.defineProperty(e.prototype,"autoPlay",{get:function(){return this._autoPlay},set:function(t){this._autoPlay!=t&&(this._autoPlay=t,this._autoPlay?this._owner.onStage&&this.play(null,null,this.autoPlayRepeat,this.autoPlayDelay):this._owner.onStage||this.stop(!1,!0))},enumerable:!0,configurable:!0}),e.prototype.play=function(t,e,i,n,s){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=1),void 0===s&&(s=0),this._play(t,e,i,n,s,!1)},e.prototype.playReverse=function(t,e,i,n,s){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=1),void 0===s&&(s=0),this._play(t,e,i,n,s,!0)},e.prototype.changeRepeat=function(t){this._totalTimes=t},e.prototype._play=function(t,i,n,s,r,o){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=1),void 0===r&&(r=0),void 0===o&&(o=!1),this.stop(),this._totalTimes=s,this._reversed=o,this.internalPlay(r),this._playing=this._totalTasks>0,this._playing){if(this._onComplete=t,this._onCompleteParam=n,this._onCompleteObj=i,0!=(this._options&e.OPTION_IGNORE_DISPLAY_CONTROLLER))for(var a=this._items.length,h=0;h<a;h++){var l=this._items[h];null!=l.target&&l.target!=this._owner&&(l.displayLockToken=l.target.addDisplayLock())}}else null!=t&&(t.length>0?t.call(i,n):t(i))},e.prototype.stop=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var i=this._onComplete,n=this._onCompleteParam,s=this._onCompleteObj;this._onComplete=null,this._onCompleteParam=null,this._onCompleteObj=null;var r,o,a=this._items.length;if(this._reversed)for(r=a-1;r>=0;r--)null!=(o=this._items[r]).target&&this.stopItem(o,t);else for(r=0;r<a;r++)null!=(o=this._items[r]).target&&this.stopItem(o,t);e&&null!=i&&(i.length>0?i.call(s,n):i.call(s))}},e.prototype.stopItem=function(e,n){if(0!=e.displayLockToken&&(e.target.releaseDisplayLock(e.displayLockToken),e.displayLockToken=0),e.type==i.ColorFilter&&e.filterCreated&&(e.target.filters=null),!e.completed)if(null!=e.tweener&&(e.tweener.setPaused(!0),e.tweener=null),e.type==i.Transition){var s=e.target.getTransition(e.value.s);null!=s&&s.stop(n,!1)}else e.type==i.Shake?t.GTimers.inst.exists(this.__shake,e)&&(t.GTimers.inst.remove(this.__shake,e),e.target._gearLocked=!0,e.target.setXY(e.target.x-e.startValue.f1,e.target.y-e.startValue.f2),e.target._gearLocked=!1):n&&(e.tween?e.yoyo&&e.repeat%2!=0?this.applyValue(e,this._reversed?e.endValue:e.startValue):this.applyValue(e,this._reversed?e.startValue:e.endValue):e.type!=i.Sound&&this.applyValue(e,e.value))},e.prototype.dispose=function(){if(this._playing){this._playing=!1;for(var e=this._items.length,n=0;n<e;n++){var s=this._items[n];if(null!=s.target&&!s.completed)if(null!=s.tweener&&(s.tweener.setPaused(!0),s.tweener=null),s.type==i.Transition){var r=s.target.getTransition(s.value.s);null!=r&&r.dispose()}else s.type==i.Shake&&t.GTimers.inst.remove(this.__shake,s)}}},Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var s,r=this._items.length,o=0;o<r;o++){var a=this._items[o];if(null!=a.label||null!=a.label2){if(a.label==t)s=a.tween?a.startValue:a.value;else{if(a.label2!=t)continue;s=a.endValue}switch(a.type){case i.XY:case i.Size:case i.Pivot:case i.Scale:case i.Skew:s.b1=!0,s.b2=!0,s.f1=parseFloat(e[0]),s.f2=parseFloat(e[1]);break;case i.Alpha:s.f1=parseFloat(e[0]);break;case i.Rotation:s.i=parseInt(e[0]);break;case i.Color:s.c=parseFloat(e[0]);break;case i.Animation:s.i=parseInt(e[0]),e.length>1&&(s.b=e[1]);break;case i.Visible:s.b=e[0];break;case i.Sound:s.s=e[0],e.length>1&&(s.f1=parseFloat(e[1]));break;case i.Transition:s.s=e[0],e.length>1&&(s.i=parseInt(e[1]));break;case i.Shake:s.f1=parseFloat(e[0]),e.length>1&&(s.f2=parseFloat(e[1]));break;case i.ColorFilter:s.f1=parseFloat(e[0]),s.f2=parseFloat(e[1]),s.f3=parseFloat(e[2]),s.f4=parseFloat(e[3])}}}},e.prototype.setHook=function(t,e,i){for(var n=this._items.length,s=0;s<n;s++){var r=this._items[s];if(r.label==t){r.hook=e,r.hookObj=i;break}if(r.label2==t){r.hook2=e,r.hook2Obj=i;break}}},e.prototype.clearHooks=function(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.hook=null,i.hookObj=null,i.hook2=null,i.hook2Obj=null}},e.prototype.setTarget=function(t,e){for(var i=this._items.length,n=0;n<i;n++){var s=this._items[n];null==s.label&&null==s.label2||(s.targetId=e.id)}},e.prototype.setDuration=function(t,e){for(var i=this._items.length,n=0;n<i;n++){var s=this._items[n];s.tween&&s.label==t&&(s.duration=e)}},e.prototype.updateFromRelations=function(t,e,n){var s=this._items.length;if(0!=s)for(var r=0;r<s;r++){var o=this._items[r];o.type==i.XY&&o.targetId==t&&(o.tween?(o.startValue.f1+=e,o.startValue.f2+=n,o.endValue.f1+=e,o.endValue.f2+=n):(o.value.f1+=e,o.value.f2+=n))}},e.prototype.OnOwnerRemovedFromStage=function(){0==(this._options&e.OPTION_AUTO_STOP_DISABLED)&&this.stop(0!=(this._options&e.OPTION_AUTO_STOP_AT_END),!1)},e.prototype.internalPlay=function(t){void 0===t&&(t=0),this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=0;for(var e,n,s=this._items.length,r=0;r<s;r++)(n=this._items[r]).targetId?n.target=this._owner.getChildById(n.targetId):n.target=this._owner,null!=n.target&&(n.tween?(e=this._reversed?t+this._maxTime-n.time-n.duration:t+n.time)>0&&(n.type==i.XY||n.type==i.Size)?(this._totalTasks++,n.completed=!1,n.tweener=egret.Tween.get(n.value).wait(1e3*e).call(this.__delayCall,this,[n])):this.startTween(n,e):0==(e=this._reversed?t+this._maxTime-n.time:t+n.time)?this.applyValue(n,n.value):(this._totalTasks++,n.completed=!1,n.tweener=egret.Tween.get(n.value).wait(1e3*e).call(this.__delayCall2,this,[n])))},e.prototype.prepareValue=function(t,e,n){void 0===n&&(n=!1);var s,r;switch(n?(s=t.endValue,r=t.startValue):(s=t.startValue,r=t.endValue),t.type){case i.XY:case i.Size:t.type==i.XY?t.target==this._owner?(s.b1||(s.f1=0),s.b2||(s.f2=0)):(s.b1||(s.f1=t.target.x),s.b2||(s.f2=t.target.y)):(s.b1||(s.f1=t.target.width),s.b2||(s.f2=t.target.height)),t.value.f1=s.f1,t.value.f2=s.f2,r.b1||(r.f1=t.value.f1),r.b2||(r.f2=t.value.f2),t.value.b1=s.b1||r.b1,t.value.b2=s.b2||r.b2,e.f1=r.f1,e.f2=r.f2;break;case i.Scale:case i.Skew:t.value.f1=s.f1,t.value.f2=s.f2,e.f1=r.f1,e.f2=r.f2;break;case i.Alpha:t.value.f1=s.f1,e.f1=r.f1;break;case i.Rotation:t.value.i=s.i,e.i=r.i;break;case i.ColorFilter:t.value.f1=s.f1,t.value.f2=s.f2,t.value.f3=s.f3,t.value.f4=s.f4,e.f1=r.f1,e.f2=r.f2,e.f3=r.f3,e.f4=r.f4}},e.prototype.startTween=function(t,e){var i,n;i={},n={},this._totalTasks++,t.completed=!1,this.prepareValue(t,n,this._reversed),t.tweener=egret.Tween.get(t.value,i),0!=e?t.tweener.wait(1e3*e):this.applyValue(t,t.value),t.tweener.call(this.__tweenStart,this,[t]),t.tweener.to(n,1e3*t.duration,t.easeType),0!=t.repeat?(t.tweenTimes=0,t.tweener.call(this.__tweenRepeatComplete,this,[t])):t.tweener.call(this.__tweenComplete,this,[t])},e.prototype.__delayCall=function(t){t.tweener=null,this._totalTasks--,this.startTween(t,0)},e.prototype.__delayCall2=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,this.applyValue(t,t.value),null!=t.hook&&t.hook.call(t.hookObj),this.checkAllComplete()},e.prototype.__tweenStart=function(t){null!=t.tweener&&(null!=t.hook&&t.hook.call(t.hookObj),t.tweener.addEventListener("change",this.__tweenUpdate,[this,t]))},e.prototype.__tweenUpdate=function(){var t=this[0],e=this[1];t.applyValue(e,e.value)},e.prototype.__tweenComplete=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,null!=t.hook2&&t.hook2.call(t.hook2Obj),this.checkAllComplete()},e.prototype.__tweenRepeatComplete=function(t){if(t.tweenTimes++,-1==t.repeat||t.tweenTimes<t.repeat+1){var e,i;i={},(e={}).onChange=this.__tweenUpdate,e.onChangeObj=[this,t];var n;n=t.yoyo?this._reversed?t.tweenTimes%2==0:t.tweenTimes%2==1:this._reversed,this.prepareValue(t,i,n),t.tweener=egret.Tween.get(t.value,e),t.tweener.to(i,1e3*t.duration,t.easeType).call(this.__tweenRepeatComplete,this,[t])}else this.__tweenComplete(t)},e.prototype.__playTransComplete=function(t){this._totalTasks--,t.completed=!0,this.checkAllComplete()},e.prototype.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)egret.callLater(this.internalPlay,this,0);else if(this._totalTimes--,this._totalTimes>0)egret.callLater(this.internalPlay,this,0);else{this._playing=!1;for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];null!=i.target&&(0!=i.displayLockToken&&(i.target.releaseDisplayLock(i.displayLockToken),i.displayLockToken=0),i.filterCreated&&(i.filterCreated=!1,i.target.filters=null))}if(null!=this._onComplete){var n=this._onComplete,s=this._onCompleteParam,r=this._onCompleteObj;this._onComplete=null,this._onCompleteParam=null,this._onCompleteObj=null,n.length>0?n.call(r,s):n.call(r)}}},e.prototype.applyValue=function(e,n){switch(e.target._gearLocked=!0,e.type){case i.XY:if(e.target==this._owner){var s=0,r=0;s=n.b1?n.f1+this._ownerBaseX:e.target.x,r=n.b2?n.f2+this._ownerBaseY:e.target.y,e.target.setXY(s,r)}else n.b1||(n.f1=e.target.x),n.b2||(n.f2=e.target.y),e.target.setXY(n.f1,n.f2);break;case i.Size:n.b1||(n.f1=e.target.width),n.b2||(n.f2=e.target.height),e.target.setSize(n.f1,n.f2);break;case i.Pivot:e.target.setPivot(n.f1,n.f2);break;case i.Alpha:e.target.alpha=n.f1;break;case i.Rotation:e.target.rotation=n.i;break;case i.Scale:e.target.setScale(n.f1,n.f2);break;case i.Skew:e.target.setSkew(n.f1,n.f2);break;case i.Color:e.target.color=n.c;break;case i.Animation:n.b1||(n.i=e.target.frame),e.target.frame=n.i,e.target.playing=n.b;break;case i.Visible:e.target.visible=n.b;break;case i.Transition:var o=e.target.getTransition(n.s);null!=o&&(0==n.i?o.stop(!1,!0):o.playing?o._totalTimes=n.i:(e.completed=!1,this._totalTasks++,this._reversed?o.playReverse(this.__playTransComplete,this,e,e.value.i):o.play(this.__playTransComplete,this,e,e.value.i)));break;case i.Sound:var a=t.UIPackage.getItemByURL(n.s);if(a){var h=a.owner.getItemAsset(a);h&&t.GRoot.inst.playOneShotSound(h,n.f1)}break;case i.Shake:e.startValue.f1=0,e.startValue.f2=0,e.startValue.f3=e.value.f2,e.startValue.i=egret.getTimer(),t.GTimers.inst.add(1,0,this.__shake,e,this),this._totalTasks++,e.completed=!1;break;case i.ColorFilter:var l,c=e.target.filters;c&&c[0]instanceof egret.ColorMatrixFilter?l=c[0]:(c=[l=new egret.ColorMatrixFilter],e.filterCreated=!0);var u=new t.ColorMatrix;u.adjustBrightness(n.f1),u.adjustContrast(n.f2),u.adjustSaturation(n.f3),u.adjustHue(n.f4),l.matrix=u.matrix,e.target.filters=c}e.target._gearLocked=!1},e.prototype.__shake=function(t){t.__shakeItem(this)},e.prototype.__shakeItem=function(e){var i=Math.ceil(e.value.f1*e.startValue.f3/e.value.f2),n=(2*Math.random()-1)*i,s=(2*Math.random()-1)*i;n=n>0?Math.ceil(n):Math.floor(n),s=s>0?Math.ceil(s):Math.floor(s),e.target._gearLocked=!0,e.target.setXY(e.target.x-e.startValue.f1+n,e.target.y-e.startValue.f2+s),e.target._gearLocked=!1,e.startValue.f1=n,e.startValue.f2=s;var r=egret.getTimer();e.startValue.f3-=(r-e.startValue.i)/1e3,e.startValue.i=r,e.startValue.f3<=0&&(e.target._gearLocked=!0,e.target.setXY(e.target.x-e.startValue.f1,e.target.y-e.startValue.f2),e.target._gearLocked=!1,e.completed=!0,this._totalTasks--,t.GTimers.inst.remove(this.__shake,e),this.checkAllComplete())},e.prototype.setup=function(s){this.name=s.attributes.name;var r=s.attributes.options;r&&(this._options=parseInt(r)),this._autoPlay="true"==s.attributes.autoPlay,this._autoPlay&&((r=s.attributes.autoPlayRepeat)&&(this.autoPlayRepeat=parseInt(r)),(r=s.attributes.autoPlayDelay)&&(this.autoPlayDelay=parseFloat(r)));for(var o=s.children,a=o.length,h=0;h<a;h++){var l=o[h];if("item"==l.name){var c=new n;switch(this._items.push(c),c.time=parseInt(l.attributes.time)/e.FRAME_RATE,c.targetId=l.attributes.target,r=l.attributes.type){case"XY":c.type=i.XY;break;case"Size":c.type=i.Size;break;case"Scale":c.type=i.Scale;break;case"Pivot":c.type=i.Pivot;break;case"Alpha":c.type=i.Alpha;break;case"Rotation":c.type=i.Rotation;break;case"Color":c.type=i.Color;break;case"Animation":c.type=i.Animation;break;case"Visible":c.type=i.Visible;break;case"Sound":c.type=i.Sound;break;case"Transition":c.type=i.Transition;break;case"Shake":c.type=i.Shake;break;case"ColorFilter":c.type=i.ColorFilter;break;case"Skew":c.type=i.Skew;break;default:c.type=i.Unknown}if(c.tween="true"==l.attributes.tween,c.label=l.attributes.label,c.tween){c.duration=parseInt(l.attributes.duration)/e.FRAME_RATE,c.time+c.duration>this._maxTime&&(this._maxTime=c.time+c.duration),(r=l.attributes.ease)&&(c.easeType=t.parseEaseType(r)),(r=l.attributes.repeat)&&(c.repeat=parseInt(r)),c.yoyo="true"==l.attributes.yoyo,c.label2=l.attributes.label2;var u=l.attributes.endValue;u?(this.decodeValue(c.type,l.attributes.startValue,c.startValue),this.decodeValue(c.type,u,c.endValue)):(c.tween=!1,this.decodeValue(c.type,l.attributes.startValue,c.value))}else c.time>this._maxTime&&(this._maxTime=c.time),this.decodeValue(c.type,l.attributes.value,c.value)}}},e.prototype.decodeValue=function(e,n,s){var r;switch(e){case i.XY:case i.Size:case i.Pivot:case i.Skew:"-"==(r=n.split(","))[0]?s.b1=!1:(s.f1=parseFloat(r[0]),s.b1=!0),"-"==r[1]?s.b2=!1:(s.f2=parseFloat(r[1]),s.b2=!0);break;case i.Alpha:s.f1=parseFloat(n);break;case i.Rotation:s.i=parseInt(n);break;case i.Scale:r=n.split(","),s.f1=parseFloat(r[0]),s.f2=parseFloat(r[1]);break;case i.Color:s.c=t.ToolSet.convertFromHtmlColor(n);break;case i.Animation:"-"==(r=n.split(","))[0]?s.b1=!1:(s.i=parseInt(r[0]),s.b1=!0),s.b="p"==r[1];break;case i.Visible:s.b="true"==n;break;case i.Sound:if(r=n.split(","),s.s=r[0],r.length>1){var o=parseInt(r[1]);s.f1=0==o||100==o?1:o/100}else s.f1=1;break;case i.Transition:r=n.split(","),s.s=r[0],r.length>1?s.i=parseInt(r[1]):s.i=1;break;case i.Shake:r=n.split(","),s.f1=parseFloat(r[0]),s.f2=parseFloat(r[1]);break;case i.ColorFilter:r=n.split(","),s.f1=parseFloat(r[0]),s.f2=parseFloat(r[1]),s.f3=parseFloat(r[2]),s.f4=parseFloat(r[3])}},e.OPTION_IGNORE_DISPLAY_CONTROLLER=1,e.OPTION_AUTO_STOP_DISABLED=2,e.OPTION_AUTO_STOP_AT_END=4,e.FRAME_RATE=24,e}();t.Transition=e;var i=function(){function t(){}return t.XY=0,t.Size=1,t.Scale=2,t.Pivot=3,t.Alpha=4,t.Rotation=5,t.Color=6,t.Animation=7,t.Visible=8,t.Sound=9,t.Transition=10,t.Shake=11,t.ColorFilter=12,t.Skew=13,t.Unknown=14,t}(),n=function(){return function(){this.time=0,this.type=0,this.duration=0,this.repeat=0,this.yoyo=!1,this.tween=!1,this.tweenTimes=0,this.completed=!1,this.displayLockToken=0,this.easeType=egret.Ease.quadOut,this.value=new s,this.startValue=new s,this.endValue=new s}}(),s=function(){return function(){this.f1=0,this.f2=0,this.f3=0,this.f4=0,this.i=0,this.c=0,this.b=!1,this.b1=!0,this.b2=!0}}()}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){}return e.defaultFont="宋体",e.modalLayerColor=3355443,e.modalLayerAlpha=.2,e.buttonSoundVolumeScale=1,e.defaultScrollSpeed=25,e.defaultTouchScrollSpeedRatio=1,e.defaultScrollBarDisplay=t.ScrollBarDisplayType.Visible,e.defaultScrollTouchEffect=!0,e.defaultScrollBounceEffect=!0,e.defaultComboBoxVisibleItemCount=10,e.touchScrollSensitivity=20,e.touchDragSensitivity=10,e.clickDragSensitivity=2,e.bringWindowToFrontOnClick=!0,e.frameTimeForAsyncUIConstruction=2,e}();t.UIConfig=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){}return e.setPackageItemExtension=function(i,n){if(null==i)throw"Invaild url: "+i;var s=t.UIPackage.getItemByURL(i);null!=s&&(s.extensionType=n),e.packageItemExtensions[i]=n},e.setLoaderExtension=function(t){e.loaderType=t},e.$resolvePackageItemExtension=function(t){t.extensionType=e.packageItemExtensions["ui://"+t.owner.id+t.id],t.extensionType||(t.extensionType=e.packageItemExtensions["ui://"+t.owner.name+"/"+t.name])},e.newObject=function(e){switch(e.type){case t.PackageItemType.Image:return new t.GImage;case t.PackageItemType.MovieClip:return new t.GMovieClip;case t.PackageItemType.Component:var i=e.extensionType;if(i)return new i;var n=e.owner.getItemAsset(e).attributes.extention;if(null==n)return new t.GComponent;switch(n){case"Button":return new t.GButton;case"Label":return new t.GLabel;case"ProgressBar":return new t.GProgressBar;case"Slider":return new t.GSlider;case"ScrollBar":return new t.GScrollBar;case"ComboBox":return new t.GComboBox;default:return new t.GComponent}}return null},e.newObject2=function(i){switch(i){case"image":return new t.GImage;case"movieclip":return new t.GMovieClip;case"component":return new t.GComponent;case"text":return new t.GTextField;case"richtext":return new t.GRichTextField;case"inputtext":return new t.GTextInput;case"group":return new t.GGroup;case"list":return new t.GList;case"graph":return new t.GGraph;case"loader":return null!=e.loaderType?new e.loaderType:new t.GLoader}return null},e.packageItemExtensions={},e}();t.UIObjectFactory=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){this._items=new Array,this._sprites={}}return e.getById=function(t){return e._packageInstById[t]},e.getByName=function(t){return e._packageInstByName[t]},e.addPackage=function(t){var i=new e;return i.create(t),e._packageInstById[i.id]=i,e._packageInstByName[i.name]=i,i.customId=t,i},e.removePackage=function(t){var i=e._packageInstById[t];i.dispose(),delete e._packageInstById[i.id],null!=i._customId&&delete e._packageInstById[i._customId],delete e._packageInstByName[i.name]},e.createObject=function(t,i,n){void 0===n&&(n=null);var s=e.getByName(t);return s?s.createObject(i,n):null},e.createObjectFromURL=function(t,i){void 0===i&&(i=null);var n=e.getItemByURL(t);return n?n.owner.internalCreateObject(n,i):null},e.getItemURL=function(t,i){var n=e.getByName(t);if(!n)return null;var s=n._itemsByName[i];return s?"ui://"+n.id+s.id:null},e.getItemByURL=function(t){var i=t.indexOf("//");if(-1==i)return null;var n=t.indexOf("/",i+2);if(-1==n){if(t.length>13){var s=t.substr(5,8),r=e.getById(s);if(null!=r){var o=t.substr(13);return r.getItemById(o)}}}else{var a=t.substr(i+2,n-i-2);if(null!=(r=e.getByName(a))){var h=t.substr(n+1);return r.getItemByName(h)}}return null},e.normalizeURL=function(t){if(null==t)return null;var i=t.indexOf("//");if(-1==i)return null;var n=t.indexOf("/",i+2);if(-1==n)return t;var s=t.substr(i+2,n-i-2),r=t.substr(n+1);return e.getItemURL(s,r)},e.getBitmapFontByURL=function(t){return e._bitmapFonts[t]},e.setStringsSource=function(t){e._stringsSource={};for(var i=egret.XML.parse(t).children,n=i.length,s=0;s<n;s++){var r=i[s];if("string"==r.name){var o=r.attributes.name,a=r.children.length>0?r.children[0].text:"",h=o.indexOf("-");if(-1==h)continue;var l=o.substr(0,h),c=o.substr(h+1),u=e._stringsSource[l];u||(u={},e._stringsSource[l]=u),u[c]=a}}},e.prototype.create=function(t){this._resKey=t,this.loadPackage()},e.prototype.loadPackage=function(){var n,s,r=t.Resource.getRes(this._resKey);if(r||(r=t.Resource.getRes(this._resKey+".fui")),!r)throw"Resource '"+this._resKey+"' not found, please check default.res.json!";this.decompressPackage(r);for(var o=(s=(n=this.getDesc("sprites.bytes")).split(e.sep1)).length,a=1;a<o;a++)if(n=s[a]){var h=n.split(e.sep2),l=new i,c=h[0],u=parseInt(h[1]);if(u>=0)l.atlas="atlas"+u;else{var _=c.indexOf("_");l.atlas=-1==_?"atlas_"+c:"atlas_"+c.substr(0,_)}l.rect.x=parseInt(h[2]),l.rect.y=parseInt(h[3]),l.rect.width=parseInt(h[4]),l.rect.height=parseInt(h[5]),l.rotated="1"==h[6],this._sprites[c]=l}n=this.getDesc("package.xml");var p=egret.XML.parse(n);this._id=p.attributes.id,this._name=p.attributes.name;var d=p.children[0].children;this._itemsById={},this._itemsByName={};for(var g,f,y=d.length,b=0;b<y;b++){switch(f=d[b],(g=new t.PackageItem).owner=this,g.type=t.parsePackageItemType(f.name),g.id=f.attributes.id,g.name=f.attributes.name,g.file=f.attributes.file,(n=f.attributes.size)&&(s=n.split(e.sep0),g.width=parseInt(s[0]),g.height=parseInt(s[1])),g.type){case t.PackageItemType.Image:"9grid"==(n=f.attributes.scale)?(g.scale9Grid=new egret.Rectangle,(n=f.attributes.scale9grid)&&(s=n.split(e.sep0),g.scale9Grid.x=parseInt(s[0]),g.scale9Grid.y=parseInt(s[1]),g.scale9Grid.width=parseInt(s[2]),g.scale9Grid.height=parseInt(s[3]),(n=f.attributes.gridTile)&&(g.tileGridIndice=parseInt(n)))):"tile"==n&&(g.scaleByTile=!0),n=f.attributes.smoothing,g.smoothing="false"!=n;break;case t.PackageItemType.MovieClip:n=f.attributes.smoothing,g.smoothing="false"!=n;break;case t.PackageItemType.Component:t.UIObjectFactory.$resolvePackageItemExtension(g)}this._items.push(g),this._itemsById[g.id]=g,null!=g.name&&(this._itemsByName[g.name]=g)}for(o=this._items.length,a=0;a<o;a++)(g=this._items[a]).type==t.PackageItemType.Font&&(this.loadFont(g),e._bitmapFonts[g.bitmapFont.id]=g.bitmapFont)},e.prototype.decompressPackage=function(t){this._resData={};for(var e,i,n=new Zlib.RawInflate(t).decompress(),s=(new egret.ByteArray).decodeUTF8(n),r=0;;){var o=s.indexOf("|",r);if(-1==o)break;e=s.substring(r,o),r=o+1,o=s.indexOf("|",r),i=parseInt(s.substring(r,o)),r=o+1,this._resData[e]=s.substr(r,i),r+=i}},e.prototype.dispose=function(){for(var t=this._items.length,i=0;i<t;i++){var n=this._items[i],s=n.texture;if(null!=s)s.dispose();else if(null!=n.frames)for(var r=n.frames.length,o=0;o<r;o++)null!=(s=n.frames[o].texture)&&s.dispose();else null!=n.bitmapFont&&delete e._bitmapFonts[n.bitmapFont.id]}},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customId",{get:function(){return this._customId},set:function(t){null!=this._customId&&delete e._packageInstById[this._customId],this._customId=t,null!=this._customId&&(e._packageInstById[this._customId]=this)},enumerable:!0,configurable:!0}),e.prototype.createObject=function(t,e){void 0===e&&(e=null);var i=this._itemsByName[t];return i?this.internalCreateObject(i,e):null},e.prototype.internalCreateObject=function(i,n){void 0===n&&(n=null);var s;return null==(s=i.type==t.PackageItemType.Component&&null!=n?new n:t.UIObjectFactory.newObject(i))?null:(e._constructing++,s.packageItem=i,s.constructFromResource(),e._constructing--,s)},e.prototype.getItemById=function(t){return this._itemsById[t]},e.prototype.getItemByName=function(t){return this._itemsByName[t]},e.prototype.getItemAssetByName=function(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)},e.prototype.getItemAsset=function(e){switch(e.type){case t.PackageItemType.Image:if(!e.decoded){e.decoded=!0;var i=this._sprites[e.id];null!=i&&(e.texture=this.createSpriteTexture(i))}return e.texture;case t.PackageItemType.Atlas:if(!e.decoded){e.decoded=!0;var n=null!=e.file&&e.file.length>0?e.file:e.id+".png",s=this._resKey;/^.+\.fui$/.test(s)&&(s=s.substring(0,s.lastIndexOf(".fui"))),e.texture=t.Resource.getRes(s+"@"+n),e.texture||(e.texture=t.Resource.getRes(s+"@"+n.replace(".","_")))}return e.texture;case t.PackageItemType.Sound:if(!e.decoded){e.decoded=!0;n=null!=e.file&&e.file.length>0?e.file:e.id+".mp3";e.sound=t.Resource.getRes(this._resKey+"@"+n),e.sound||(e.sound=t.Resource.getRes(this._resKey+"@"+n.replace(".","_")))}return e.sound;case t.PackageItemType.Font:return e.decoded||(e.decoded=!0,this.loadFont(e)),e.bitmapFont;case t.PackageItemType.MovieClip:return e.decoded||(e.decoded=!0,this.loadMovieClip(e)),e.frames;case t.PackageItemType.Component:if(!e.decoded){e.decoded=!0;var r=this.getDesc(e.id+".xml"),o=egret.XML.parse(r);e.componentData=o,this.loadComponentChildren(e),this.translateComponent(e)}return e.componentData;default:return t.Resource.getRes(this._resKey+"@"+e.id)}},e.prototype.loadComponentChildren=function(i){var n=t.ToolSet.findChildNode(i.componentData,"displayList");if(null!=n){var s=n.children,r=s.length;i.displayList=new Array(r);for(var o,a=0;a<r;a++){var h=s[a],l=h.name,c=h.attributes.src;if(c){var u,_=h.attributes.pkg,p=null!=(u=_&&_!=i.owner.id?e.getById(_):i.owner)?u.getItemById(c):null;o=null!=p?new t.DisplayListItem(p,null):new t.DisplayListItem(null,l)}else o="text"==l&&"true"==h.attributes.input?new t.DisplayListItem(null,"inputtext"):new t.DisplayListItem(null,l);o.desc=h,i.displayList[a]=o}}else i.displayList=new Array},e.prototype.getDesc=function(t){return this._resData[t]},e.prototype.translateComponent=function(i){if(null!=e._stringsSource){var n=e._stringsSource[this.id+i.id];if(null!=n){var s,r,o,a,h,l,c,u,_,p,d,g=i.displayList.length;for(_=0;_<g;_++)if(l=(o=i.displayList[_].desc).name,c=o.attributes.id,o.attributes.tooltips&&void 0!=(r=n[c+"-tips"])&&(o.attributes.tooltips=r),(a=t.ToolSet.findChildNode(o,"gearText"))&&(void 0!=(r=n[c+"-texts"])&&(a.attributes.values=r),void 0!=(r=n[c+"-texts_def"])&&(a.attributes.default=r)),"text"==l||"richtext"==l)void 0!=(r=n[c])&&(o.attributes.text=r),void 0!=(r=n[c+"-prompt"])&&(o.attributes.prompt=r);else if("list"==l)for(s=(u=o.children).length,d=0,p=0;p<s;p++)"item"==(h=u[p]).name&&(void 0!=(r=n[c+"-"+d])&&(h.attributes.title=r),d++);else if("component"==l){if(a=t.ToolSet.findChildNode(o,"Button")){void 0!=(r=n[c])&&(a.attributes.title=r),void 0!=(r=n[c+"-0"])&&(a.attributes.selectedTitle=r);continue}if(a=t.ToolSet.findChildNode(o,"Label")){void 0!=(r=n[c])&&(a.attributes.title=r),void 0!=(r=n[c+"-prompt"])&&(a.attributes.prompt=r);continue}if(a=t.ToolSet.findChildNode(o,"ComboBox")){for(void 0!=(r=n[c])&&(a.attributes.title=r),s=(u=a.children).length,d=0,p=0;p<s;p++)"item"==(h=u[p]).name&&(void 0!=(r=n[c+"-"+d])&&(h.attributes.title=r),d++);continue}}}}},e.prototype.createSpriteTexture=function(t){var e=this._itemsById[t.atlas];if(null!=e){var i=this.getItemAsset(e);return null==i?null:this.createSubTexture(i,t.rect)}return null},e.prototype.createSubTexture=function(t,e){var i=new egret.Texture;return i._bitmapData=t._bitmapData,i.$initData(t._bitmapX+e.x,t._bitmapY+e.y,e.width,e.height,0,0,e.width,e.height,t._sourceWidth,t._sourceHeight),i},e.prototype.loadMovieClip=function(i){var n,s,r=egret.XML.parse(this.getDesc(i.id+".xml"));null!=(n=r.attributes.interval)&&(i.interval=parseInt(n)),null!=(n=r.attributes.swing)&&(i.swing="true"==n),null!=(n=r.attributes.repeatDelay)&&(i.repeatDelay=parseInt(n));var o=parseInt(r.attributes.frameCount);i.frames=new Array(o);for(var a=r.children[0].children,h=0;h<o;h++){var l=new t.Frame,c=a[h];if(s=(n=c.attributes.rect).split(e.sep0),l.rect=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3])),(n=c.attributes.addDelay)&&(l.addDelay=parseInt(n)),i.frames[h]=l,0!=l.rect.width){n=(n=c.attributes.sprite)?i.id+"_"+n:i.id+"_"+h;var u=this._sprites[n];null!=u&&(l.texture=this.createSpriteTexture(u))}}},e.prototype.loadFont=function(i){var n=new t.BitmapFont;n.id="ui://"+this.id+i.id;var s,r,o=this.getDesc(i.id+".fnt"),a=o.split(e.sep1),h=a.length,l=0,c={},u=!1,_=0,p=0,d=!1,g=0,f=0,y=0;for(l=0;l<h;l++)if(0!=(o=a[l]).length){for(var b=(o=t.ToolSet.trim(o)).split(e.sep2),m=1;m<b.length;m++){var v=b[m].split(e.sep3);c[v[0]]=v[1]}if("char"==(o=b[0])){var w=new t.BMGlyph;w.x=isNaN(c.x)?0:parseInt(c.x),w.y=isNaN(c.y)?0:parseInt(c.y),w.offsetX=isNaN(c.xoffset)?0:parseInt(c.xoffset),w.offsetY=isNaN(c.yoffset)?0:parseInt(c.yoffset),w.width=isNaN(c.width)?0:parseInt(c.width),w.height=isNaN(c.height)?0:parseInt(c.height),w.advance=isNaN(c.xadvance)?0:parseInt(c.xadvance),void 0!=c.chnl&&(w.channel=parseInt(c.chnl),15==w.channel?w.channel=4:1==w.channel?w.channel=3:2==w.channel?w.channel=2:w.channel=1),u?null!=r&&(w.texture=this.createSubTexture(r,new egret.Rectangle(w.x+g,w.y+f,w.width,w.height))):c.img&&null!=(s=this._itemsById[c.img])&&(s.load(),w.width=s.width,w.height=s.height,w.texture=s.texture),u?w.lineHeight=y:(0==w.advance&&(w.advance=0==p?w.offsetX+w.width:p),w.lineHeight=w.offsetY<0?w.height:w.offsetY+w.height,_>0&&w.lineHeight<_&&(w.lineHeight=_)),n.glyphs[String.fromCharCode(c.id)]=w}else if("info"==o){if(u=null!=c.face,isNaN(c.size)||(_=parseInt(c.size)),d="true"==c.resizable,u){var C=this._sprites[i.id];if(null!=C){g=C.rect.x,f=C.rect.y;var x=this._itemsById[C.atlas];null!=x&&(r=this.getItemAsset(x))}}}else"common"==o&&(isNaN(c.lineHeight)||(y=parseInt(c.lineHeight)),0==_?_=y:0==y&&(y=_),isNaN(c.xadvance)||(p=parseInt(c.xadvance)))}0==_&&w&&(_=w.height),n.ttf=u,n.size=_,n.resizable=d,i.bitmapFont=n},e._constructing=0,e._packageInstById={},e._packageInstByName={},e._bitmapFonts={},e._stringsSource=null,e.sep0=",",e.sep1="\n",e.sep2=" ",e.sep3="=",e}();t.UIPackage=e;var i=function(){return function(){this.rect=new egret.Rectangle}}()}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i._requestingCmd=0,i.focusable=!0,i._uiSources=new Array,i.bringToFontOnClick=t.UIConfig.bringWindowToFrontOnClick,i.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,i.__onShown,i),i.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.__onHidden,i),i.displayObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,i.__mouseDown,i,!0),i}return i.prototype.addUISource=function(t){this._uiSources.push(t)},Object.defineProperty(i.prototype,"contentPane",{get:function(){return this._contentPane},set:function(e){this._contentPane!=e&&(null!=this._contentPane&&this.removeChild(this._contentPane),this._contentPane=e,null!=this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,t.RelationType.Size),this._frame=this._contentPane.getChild("frame"),null!=this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"closeButton",{get:function(){return this._closeButton},set:function(t){null!=this._closeButton&&this._closeButton.removeClickListener(this.closeEventHandler,this),this._closeButton=t,null!=this._closeButton&&this._closeButton.addClickListener(this.closeEventHandler,this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dragArea",{get:function(){return this._dragArea},set:function(e){this._dragArea!=e&&(null!=this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.removeEventListener(t.DragEvent.DRAG_START,this.__dragStart,this)),this._dragArea=e,null!=this._dragArea&&(this._dragArea instanceof t.GGraph&&null==this._dragArea.displayObject&&this._dragArea.asGraph.drawRect(0,0,0,0,0),this._dragArea.draggable=!0,this._dragArea.addEventListener(t.DragEvent.DRAG_START,this.__dragStart,this)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentArea",{get:function(){return this._contentArea},set:function(t){this._contentArea=t},enumerable:!0,configurable:!0}),i.prototype.show=function(){t.GRoot.inst.showWindow(this)},i.prototype.showOn=function(t){t.showWindow(this)},i.prototype.hide=function(){this.isShowing&&this.doHideAnimation()},i.prototype.hideImmediately=function(){var e=this.parent instanceof t.GRoot?this.parent:null;e||(e=t.GRoot.inst),e.hideWindowImmediately(this)},i.prototype.centerOn=function(e,i){void 0===i&&(i=!1),this.setXY(Math.round((e.width-this.width)/2),Math.round((e.height-this.height)/2)),i&&(this.addRelation(e,t.RelationType.Center_Center),this.addRelation(e,t.RelationType.Middle_Middle))},i.prototype.toggleStatus=function(){this.isTop?this.hide():this.show()},Object.defineProperty(i.prototype,"isShowing",{get:function(){return null!=this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isTop",{get:function(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"modal",{get:function(){return this._modal},set:function(t){this._modal=t},enumerable:!0,configurable:!0}),i.prototype.bringToFront=function(){this.root.bringToFront(this)},i.prototype.showModalWait=function(e){void 0===e&&(e=0),0!=e&&(this._requestingCmd=e),t.UIConfig.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=t.UIPackage.createObjectFromURL(t.UIConfig.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},i.prototype.layoutModalWaitPane=function(){if(null!=this._contentArea){var t=this._frame.localToGlobal();t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)}else this._modalWaitPane.setSize(this.width,this.height)},i.prototype.closeModalWait=function(t){return void 0===t&&(t=0),(0==t||this._requestingCmd==t)&&(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},Object.defineProperty(i.prototype,"modalWaiting",{get:function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent},enumerable:!0,configurable:!0}),i.prototype.init=function(){if(!this._inited&&!this._loading)if(this._uiSources.length>0){this._loading=!1;for(var t=this._uiSources.length,e=0;e<t;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},i.prototype.onInit=function(){},i.prototype.onShown=function(){},i.prototype.onHide=function(){},i.prototype.doShowAnimation=function(){this.onShown()},i.prototype.doHideAnimation=function(){this.hideImmediately()},i.prototype.__uiLoadComplete=function(){for(var t=this._uiSources.length,e=0;e<t;e++){if(!this._uiSources[e].loaded)return}this._loading=!1,this._init()},i.prototype._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},i.prototype.dispose=function(){this.displayObject.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__onShown,this),this.displayObject.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__onHidden,this),null!=this.parent&&this.hideImmediately(),e.prototype.dispose.call(this)},i.prototype.closeEventHandler=function(t){this.hide()},i.prototype.__onShown=function(t){this._inited?this.doShowAnimation():this.init()},i.prototype.__onHidden=function(t){this.closeModalWait(),this.onHide()},i.prototype.__mouseDown=function(t){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},i.prototype.__dragStart=function(t){t.preventDefault(),this.startDrag(t.touchPointID)},i}(t.GComponent);t.Window=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){return e.call(this)||this}return i.prototype.enter=function(e){if(this.controllerName){var i;if(this.objectId){var n=e.parent.getChildById(this.objectId);if(!(n instanceof t.GComponent))return;i=n}else i=e.parent;if(i){var s=i.getController(this.controllerName);s&&s!=e&&!s.changing&&(s.selectedPageId=this.targetPage)}}},i.prototype.setup=function(t){e.prototype.setup.call(this,t),this.objectId=t.attributes.objectId,this.controllerName=t.attributes.controller,this.targetPage=t.attributes.targetPage},i}(t.ControllerAction);t.ChangePageAction=e}(fairygui||(fairygui={}));!function(t){var e=function(){return function(t,e){this.packageItem=t,this.type=e}}();t.DisplayListItem=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(){var e=t.call(this)||this;return e.repeat=1,e.delay=0,e.stopOnExit=!1,e}return e.prototype.enter=function(t){var e=t.parent.getTransition(this.transitionName);e&&(this._currentTransition&&this._currentTransition.playing?e.changeRepeat(this.repeat):e.play(null,null,null,this.repeat,this.delay),this._currentTransition=e)},e.prototype.leave=function(t){this.stopOnExit&&this._currentTransition&&(this._currentTransition.stop(),this._currentTransition=null)},e.prototype.setup=function(e){t.prototype.setup.call(this,e),this.transitionName=e.attributes.transition;var i;(i=e.attributes.repeat)&&(this.repeat=parseInt(i)),(i=e.attributes.delay)&&(this.delay=parseFloat(i)),i=e.attributes.stopOnExit,this.stopOnExit="true"==i},e}(t.ControllerAction);t.PlayTransitionAction=e}(fairygui||(fairygui={}));!function(t){var e=function(){return function(){this.size=0,this.glyphs={}}}();t.BitmapFont=e}(fairygui||(fairygui={}));!function(t){var e=function(){return function(){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.width=0,this.height=0,this.advance=0,this.lineHeight=0,this.channel=0}}();t.BMGlyph=e}(fairygui||(fairygui={}));!function(t){var e=function(){return function(){this.addDelay=0,this.rect=new egret.Rectangle}}();t.Frame=e}(fairygui||(fairygui={}));!function(t){var e=function(e){__extends(i,e);function i(){var i=e.call(this)||this;return i.interval=0,i.repeatDelay=0,i._frameCount=0,i._currentFrame=0,i._start=0,i._end=0,i._times=0,i._endAt=0,i._status=0,i._smoothing=!0,i.$renderNode=new egret.sys.BitmapNode,i.playState=new t.PlayState,i._playing=!0,i.touchEnabled=!1,i.setPlaySettings(),i}return Object.defineProperty(i.prototype,"frames",{get:function(){return this._frames},set:function(t){this._frames=t,null!=this._frames?this._frameCount=this._frames.length:this._frameCount=0,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._currentFrame<0||this._currentFrame>this._frameCount-1)&&(this._currentFrame=this._frameCount-1),this._frameCount>0?this.setFrame(this._frames[this._currentFrame]):this.setFrame(null),this.playState.rewind()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameCount",{get:function(){return this._frameCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrame",{get:function(){return this._currentFrame},set:function(t){this._currentFrame!=t&&(this._currentFrame=t,this.playState.currentFrame=t,this.setFrame(this._currentFrame<this._frameCount?this._frames[this._currentFrame]:null))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"playing",{get:function(){return this._playing},set:function(e){this._playing=e,e&&null!=this.stage?t.GTimers.inst.add(0,0,this.update,this):t.GTimers.inst.remove(this.update,this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"smoothing",{get:function(){return this._smoothing},set:function(t){this._smoothing=t},enumerable:!0,configurable:!0}),i.prototype.setPlaySettings=function(t,e,i,n,s,r){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===n&&(n=-1),void 0===s&&(s=null),void 0===r&&(r=null),this._start=t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=n,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._callback=s,this._callbackObj=r,this.currentFrame=t},i.prototype.update=function(){this._playing&&0!=this._frameCount&&3!=this._status&&(this.playState.update(this),this._currentFrame!=this.playState.currentFrame&&(1==this._status?(this._currentFrame=this._start,this.playState.currentFrame=this._currentFrame,this._status=0):2==this._status?(this._currentFrame=this._endAt,this.playState.currentFrame=this._currentFrame,this._status=3,null!=this._callback&&t.GTimers.inst.callLater(this.__playEnd,this)):(this._currentFrame=this.playState.currentFrame,this._currentFrame==this._end&&(this._times>0?(this._times--,0==this._times?this._status=2:this._status=1):0!=this._start&&(this._status=1))),this.setFrame(this._frames[this._currentFrame])))},i.prototype.__playEnd=function(){if(null!=this._callback){var t=this._callback,e=this._callbackObj;this._callback=null,this._callbackObj=null,1==t.length?t.call(e,this):t.call(e)}},i.prototype.setFrame=function(t){null==t?this._texture=null:(this._texture=t.texture,this._frameRect=t.rect),this.$invalidateContentBounds()},i.prototype.$render=function(){var t=this._texture;if(t){var e=Math.round(t._offsetX)+this._frameRect.x,i=Math.round(t._offsetY)+this._frameRect.y,n=t._bitmapWidth,s=t._bitmapHeight,r=t.$getTextureWidth(),o=t.$getTextureHeight(),a=Math.round(t.$getScaleBitmapWidth()),h=Math.round(t.$getScaleBitmapHeight()),l=t._sourceWidth,c=t._sourceHeight;egret.sys.BitmapNode.$updateTextureData(this.$renderNode,t._bitmapData,t._bitmapX,t._bitmapY,n,s,e,i,r,o,a,h,l,c,null,egret.BitmapFillMode.SCALE,this._smoothing)}},i.prototype.$measureContentBounds=function(t){if(this._texture){var e=Math.round(this._texture._offsetX)+this._frameRect.x,i=Math.round(this._texture._offsetY)+this._frameRect.y,n=this._texture.$getTextureWidth(),s=this._texture.$getTextureHeight();t.setTo(e,i,n,s)}else t.setEmpty()},i.prototype.$onAddToStage=function(i,n){e.prototype.$onAddToStage.call(this,i,n),this._playing&&t.GTimers.inst.add(0,0,this.update,this)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this._playing&&t.GTimers.inst.remove(this.update,this)},i}(egret.DisplayObject);t.MovieClip=e}(fairygui||(fairygui={}));!function(t){var e=function(){function e(){this.repeatedCount=0,this._curFrame=0,this._curFrameDelay=0,this._lastUpdateSeq=0}return e.prototype.update=function(e){var i,n=t.GTimers.workCount;i=n-this._lastUpdateSeq!=1?0:t.GTimers.deltaTime,this._lastUpdateSeq=n;var s=this._curFrame;s>=e.frameCount&&(s=e.frameCount-1),this.reachEnding=!1,this._curFrameDelay+=i;var r=e.interval+e.frames[s].addDelay+(0==s&&this.repeatedCount>0?e.repeatDelay:0);this._curFrameDelay<r||(this._curFrameDelay-=r,this._curFrameDelay>e.interval&&(this._curFrameDelay=e.interval),e.swing?this.reversed?(this._curFrame--,this._curFrame<=0&&(this._curFrame=0,this.repeatedCount++,this.reversed=!this.reversed)):(this._curFrame++,this._curFrame>e.frameCount-1&&(this._curFrame=Math.max(0,e.frameCount-2),this.repeatedCount++,this.reachEnding=!0,this.reversed=!this.reversed)):(this._curFrame++,this._curFrame>e.frameCount-1&&(this._curFrame=0,this.repeatedCount++,this.reachEnding=!0)))},Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._curFrame},set:function(t){this._curFrame=t,this._curFrameDelay=0},enumerable:!0,configurable:!0}),e.prototype.rewind=function(){this._curFrame=0,this._curFrameDelay=0,this.reversed=!1,this.reachEnding=!1},e.prototype.reset=function(){this._curFrame=0,this._curFrameDelay=0,this.repeatedCount=0,this.reachEnding=!1,this.reversed=!1},e.prototype.copy=function(t){this._curFrame=t._curFrame,this._curFrameDelay=t._curFrameDelay,this.repeatedCount=t.repeatedCount,this.reachEnding=t.reachEnding,this.reversed=t.reversed},e}();t.PlayState=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!0,e}return Object.defineProperty(e.prototype,"hitArea",{get:function(){return this._hitArea},set:function(t){this._hitArea&&t?(this._hitArea.x=t.x,this._hitArea.y=t.y,this._hitArea.width=t.width,this._hitArea.height=t.height):this._hitArea=t?t.clone():null},enumerable:!0,configurable:!0}),e.prototype.$hitTest=function(e,i){var n=t.prototype.$hitTest.call(this,e,i);if(n==this){if(!this.touchEnabled||null==this._hitArea)return null}else if(null==n&&this.touchEnabled&&null!=this._hitArea){var s=this.$getInvertedConcatenatedMatrix(),r=s.a*e+s.c*i+s.tx,o=s.b*e+s.d*i+s.ty;this._hitArea.contains(r,o)&&(n=this)}return n},e}(egret.DisplayObjectContainer);t.UIContainer=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!0,e}return Object.defineProperty(e.prototype,"hitArea",{get:function(){return this._hitArea},set:function(t){this._hitArea&&t?(this._hitArea.x=t.x,this._hitArea.y=t.y,this._hitArea.width=t.width,this._hitArea.height=t.height):this._hitArea=t?t.clone():null},enumerable:!0,configurable:!0}),e.prototype.$hitTest=function(e,i){var n=t.prototype.$hitTest.call(this,e,i);if(n==this){if(!this.touchEnabled||null==this._hitArea)return null}else if(null==n&&this.touchEnabled&&null!=this._hitArea){var s=this.$getInvertedConcatenatedMatrix(),r=s.a*e+s.c*i+s.tx,o=s.b*e+s.d*i+s.ty;this._hitArea.contains(r,o)&&(n=this)}return n},e}(egret.Sprite);t.UISprite=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=-1);var r=t.call(this,e,!1)||this;return r.touchPointID=0,r.stageX=i,r.stageY=n,r.touchPointID=s,r}return e.prototype.preventDefault=function(){this._prevented=!0},e.prototype.isDefaultPrevented=function(){return this._prevented},e.DRAG_START="__dragStart",e.DRAG_END="__dragEnd",e.DRAG_MOVING="__dragMoving",e}(egret.Event);t.DragEvent=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e,i){void 0===i&&(i=null);var n=t.call(this,e,!1)||this;return n.source=i,n}return e.DROP="__drop",e}(egret.Event);t.DropEvent=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e,i,n,s){void 0===i&&(i=null),void 0===n&&(n=0),void 0===s&&(s=0);var r=t.call(this,e,!1)||this;return r.itemObject=i,r.stageX=n,r.stageY=s,r}return e.CLICK="___itemClick",e}(egret.Event);t.ItemEvent=e}(fairygui||(fairygui={}));!function(t){var e=function(t){__extends(e,t);function e(e){return t.call(this,e,!1)||this}return e.CHANGED="___stateChanged",e}(egret.Event);t.StateChangeEvent=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){this.matrix=new Array(t.LENGTH),this.reset()}return t.create=function(e,i,n,s){var r=new t;return r.adjustColor(e,i,n,s),r},t.prototype.reset=function(){for(var e=0;e<t.LENGTH;e++)this.matrix[e]=t.IDENTITY_MATRIX[e]},t.prototype.invert=function(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},t.prototype.adjustColor=function(t,e,i,n){this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},t.prototype.adjustBrightness=function(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])},t.prototype.adjustContrast=function(t){var e=(t=this.cleanValue(t,1))+1,i=128*(1-e);this.multiplyMatrix([e,0,0,0,i,0,e,0,0,i,0,0,e,0,i,0,0,0,1,0])},t.prototype.adjustSaturation=function(e){e=this.cleanValue(e,1);var i=1-(e+=1),n=i*t.LUMA_R,s=i*t.LUMA_G,r=i*t.LUMA_B;this.multiplyMatrix([n+e,s,r,0,0,n,s+e,r,0,0,n,s,r+e,0,0,0,0,0,1,0])},t.prototype.adjustHue=function(e){e=this.cleanValue(e,1),e*=Math.PI;var i=Math.cos(e),n=Math.sin(e);this.multiplyMatrix([t.LUMA_R+i*(1-t.LUMA_R)+n*-t.LUMA_R,t.LUMA_G+i*-t.LUMA_G+n*-t.LUMA_G,t.LUMA_B+i*-t.LUMA_B+n*(1-t.LUMA_B),0,0,t.LUMA_R+i*-t.LUMA_R+.143*n,t.LUMA_G+i*(1-t.LUMA_G)+.14*n,t.LUMA_B+i*-t.LUMA_B+-.283*n,0,0,t.LUMA_R+i*-t.LUMA_R+n*-(1-t.LUMA_R),t.LUMA_G+i*-t.LUMA_G+n*t.LUMA_G,t.LUMA_B+i*(1-t.LUMA_B)+n*t.LUMA_B,0,0,0,0,0,1,0])},t.prototype.concat=function(e){e.length==t.LENGTH&&this.multiplyMatrix(e)},t.prototype.clone=function(){var e=new t;return e.copyMatrix(this.matrix),e},t.prototype.copyMatrix=function(e){for(var i=t.LENGTH,n=0;n<i;n++)this.matrix[n]=e[n]},t.prototype.multiplyMatrix=function(t){for(var e=[],i=0,n=0;n<4;++n){for(var s=0;s<5;++s)e[i+s]=t[i]*this.matrix[s]+t[i+1]*this.matrix[s+5]+t[i+2]*this.matrix[s+10]+t[i+3]*this.matrix[s+15]+(4==s?t[i+4]:0);i+=5}this.copyMatrix(e)},t.prototype.cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},t.LENGTH=(t.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]).length,t.LUMA_R=.299,t.LUMA_G=.587,t.LUMA_B=.114,t}();t.ColorMatrix=e}(fairygui||(fairygui={}));!function(t){var e=function(){function t(){this._enumI=0,this._enumCount=0,this._lastTime=0,this._items=new Array,this._itemPool=new Array,this._lastTime=egret.getTimer(),t.time=this._lastTime,egret.startTick(this.__timer,this)}return t.prototype.getItem=function(){return this._itemPool.length?this._itemPool.pop():new i},t.prototype.findItem=function(t,e){for(var i=this._items.length,n=0;n<i;n++){var s=this._items[n];if(s.callback==t&&s.thisObj==e)return s}return null},t.prototype.add=function(t,e,i,n,s){void 0===s&&(s=null);var r=this.findItem(i,n);r||((r=this.getItem()).callback=i,r.hasParam=1==i.length,r.thisObj=n,this._items.push(r)),r.delay=t,r.counter=0,r.repeat=e,r.param=s,r.end=!1},t.prototype.callLater=function(t,e,i){void 0===i&&(i=null),this.add(1,1,t,e,i)},t.prototype.callDelay=function(t,e,i,n){void 0===n&&(n=null),this.add(t,1,e,i,n)},t.prototype.callBy24Fps=function(e,i,n){void 0===n&&(n=null),this.add(t.FPS24,0,e,i,n)},t.prototype.exists=function(t,e){return null!=this.findItem(t,e)},t.prototype.remove=function(t,e){var i=this.findItem(t,e);if(i){var n=this._items.indexOf(i);this._items.splice(n,1),n<this._enumI&&this._enumI--,this._enumCount--,i.reset(),this._itemPool.push(i)}},t.prototype.__timer=function(e){for(t.time=e,t.workCount++,t.deltaTime=e-this._lastTime,this._lastTime=e,this._enumI=0,this._enumCount=this._items.length;this._enumI<this._enumCount;){var i=this._items[this._enumI];this._enumI++,i.advance(t.deltaTime)&&(i.end&&(this._enumI--,this._enumCount--,this._items.splice(this._enumI,1)),i.hasParam?i.callback.call(i.thisObj,i.param):i.callback.call(i.thisObj),i.end&&(i.reset(),this._itemPool.push(i)))}return!1},t.deltaTime=0,t.time=0,t.workCount=0,t.inst=new t,t.FPS24=1e3/24,t}();t.GTimers=e;var i=function(){function t(){this.delay=0,this.counter=0,this.repeat=0}return t.prototype.advance=function(t){return void 0===t&&(t=0),this.counter+=t,this.counter>=this.delay&&(this.counter-=this.delay,this.counter>this.delay&&(this.counter=this.delay),this.repeat>0&&(this.repeat--,0==this.repeat&&(this.end=!0)),!0)},t.prototype.reset=function(){this.callback=null,this.thisObj=null,this.param=null},t}()}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){}return e.getFileName=function(t){var e=t.lastIndexOf("/");return-1!=e&&(t=t.substr(e+1)),-1!=(e=t.lastIndexOf("\\"))&&(t=t.substr(e+1)),-1!=(e=t.lastIndexOf("."))?t.substring(0,e):t},e.startsWith=function(t,e,i){return void 0===i&&(i=!1),!!t&&(!(t.length<e.length)&&(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e))},e.endsWith=function(t,e,i){return void 0===i&&(i=!1),!!t&&(!(t.length<e.length)&&(t=t.substring(t.length-e.length),i?t.toLowerCase()==e.toLowerCase():t==e))},e.trim=function(t){return e.trimLeft(e.trimRight(t))},e.trimLeft=function(t){for(var e="",i=0;i<t.length&&(" "==(e=t.charAt(i))||"\n"==e||"\r"==e);i++);return t.substr(i)},e.trimRight=function(t){for(var e="",i=t.length-1;i>=0&&(" "==(e=t.charAt(i))||"\n"==e||"\r"==e);i--);return t.substring(0,i+1)},e.convertToHtmlColor=function(t,e){void 0===e&&(e=!1);var i;i=e?(t>>24&255).toString(16):"";var n=(t>>16&255).toString(16),s=(t>>8&255).toString(16),r=(255&t).toString(16);return 1==i.length&&(i="0"+i),1==n.length&&(n="0"+n),1==s.length&&(s="0"+s),1==r.length&&(r="0"+r),"#"+i+n+s+r},e.convertFromHtmlColor=function(t,e){return void 0===e&&(e=!1),t.length<1?0:("#"==t.charAt(0)&&(t=t.substr(1)),8==t.length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16))},e.displayObjectToGObject=function(t){for(;null!=t&&!(t instanceof egret.Stage);){if(t.$owner)return t.$owner;t=t.parent}return null},e.findChildNode=function(t,e){var i=t.children;if(i)for(var n=i.length,s=0;s<n;s++){var r=i[s];if(r.name==e)return r}return null},e.encodeHTML=function(t){return t?t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&apos;"):""},e.parseUBB=function(t){return e.defaultUBBParser.parse(t)},e.clamp=function(t,e,i){return t<e?t=e:t>i&&(t=i),t},e.clamp01=function(t){return t>1?t=1:t<0&&(t=0),t},e.defaultUBBParser=new t.UBBParser,e}();t.ToolSet=e}(fairygui||(fairygui={}));